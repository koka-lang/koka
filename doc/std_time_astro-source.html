<!DOCTYPE html>
<html>
<!-- NO_CLICK_TRACKING -->

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<style type="text/css">.koka .plaincode, .koka a.pp .pc { display: none; } .koka a.pp { color: inherit; text-decoration: none; }</style>
<link rel="stylesheet" type="text/css" href="styles/madoko.css" />
<link rel="stylesheet" type="text/css" href="styles/koka.css" />

<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic,700,700italic" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic" />

<title>astro.kk documentation</title>
</head>

<body class="koka doc body"><div class="madoko">
<pre class="koka source"><span class="comment">/&#42;----------------------------------------------------------------------------
   Copyright (C) 2012-2016 Microsoft Corporation
    
   Licensed under the Apache License, Version 2.0 ("The Licence"). You may not
   use this file except in compliance with the License. A copy of the License
   can be found in the file "license.txt" at the root of this distribution.
----------------------------------------------------------------------------&#42;/</span>

<span class="comment">/&#42; Time scales for astronomy (TT, TCG, TDB, and TCB).

Internally all computations use &#96;:fixed&#96; numbers with 15 digits precision
after the dot (and infinite range and precision before the dot). The
different time scales relate as follows:

&#42; &#42;&#42;TAI&#42;&#42;, &#96;ts-tai&#96;: International Atomic Time. The atomic time standard
  measuring SI seconds on the Earth's geoid.
  
&#42; &#42;&#42;GPS&#42;&#42;, &#96;ts-gps&#96;: Global Positioning System. Runs at the same rate as
  TAI but with a 19 second offset: GPS = TAI - 19.
  
&#42; &#42;&#42;UT1&#42;&#42;, [&#96;ts-ut1&#96;](std&#95;time&#95;ut1.html): Universal Time: A time scale based
  on the rotation of the earth where one rotation is 86400 seconds. 
  Defined to be a linear function of the rotation angle of the Earth. 
  See the [&#96;std/time/ut1&#96;](std&#95;time&#95;ut1.html) module for more information.
  
&#42; &#42;&#42;UTC&#42;&#42;, [&#96;ts-utc&#96;](std&#95;time&#95;utc.html): Coordinated Universal Time: A hybrid of UT1 and TAI: uses
  SI seconds as its unit, but inserts (or deletes) periodically leap
  seconds in order to stay within 0.9s of UT1. See the [&#96;std/time/utc&#96;](std&#95;time&#95;utc.html)
  module for more information.
  
&#42; &#42;&#42;TT&#42;&#42;, &#96;ts-tt&#96;: Terrestrial time. This is an ideal time scale defined to
  run slower at a constant rate from TCG such that TT runs at the same rate as a
  time scale based on SI seconds on the Earth's geoid. Since TCG
  is a theoretical time scale, TT can be considered an idealized form
  of TAI and is currently realized by defining:\
  TT = TAI + 32.184s.\
  Terrestrial time replaces (and preserves continuity with) the older Terrestrial
  Dynamic Time (TDT) and Ephemeris Time (ET).
  
&#42; &#42;&#42;TCG&#42;&#42;, &#96;ts-tcg&#96;: Geocentric Coordinate Time. Theoretical clock using
  SI seconds in a coordinate reference frame at the center of the Earth.
  It is in a linear relationship with TT where TCG runs faster
  than TT at a constant rate. By definition, TCG and TT were equal on 1977-01-01Z.
  Computed from TT using IAU 1991 recommendation [IV][IAU-IV]
   (and updated to currently known [precision][IERS-2010])):\
  TCG = TT + L~g~&amp;times;(JD~TCG~ - 2443144.5003725)&amp;times;86400, with L~g~ = 6.969290134&amp;times;10^-10^.

&#42; &#42;&#42;TCB&#42;&#42;, &#96;ts-tcb&#96;: Barycentric Coordinate Time. Theoretical clock using SI
   seconds in a coordinate reference frame at the gravitational center of the solar
   system. TCB and TCG are related by a coordinate transformation taking
   into account relativistic effects (see IAU 2000 resolution
   [B1.5](http://syrte.obspm.fr/IAU&#95;resolutions/Resol-UAIEng.ps)). In the
   library, instead of transforming TCG, we compute TCB from (the
   approximated) TDB (&#96;ts-tdb&#96;) using the IAU 2006 resolution [B3][IAU-B3]:\
   TDB = TCB - L~b~ &amp;times; (JD~TCB~ - T~0~) &amp;times; 86400 + TDB~0~,
   with T~0~ = 2443144.5003725, L~b~ = 1.55051976772&amp;times;10^-8^, TDB~0~
   = -6.55&amp;times;10^-5^.

&#42; &#42;&#42;TDB&#42;&#42;, &#96;ts-tdb&#96;: Barycentric Dynamical Time. Defined to run slower at a
   constant rate from TCB in order to be approximately equal to TT These
   relativistic corrections ensure a difference to TT of less then 2
   milli-seconds and are periodic with an average of zero. In the
   library, TDB is approximated from TT using an initial set of
   coefficients by Fairhead &amp;amp; Bretagnon [@Fairhead:tt] assuming the geo
   center (longitude and latitude of 0 degrees), and corrected for JPL
   planetary masses. See also USNO circular 179 [@Kaplan:circ],
   equation 2.6). The approximation is within 10&amp;mu;s precision in the
   time span 1600 to 2200 (and probably a bit less).

Note that theoretically the definition of TT is based on TCG which is
based on TCB, but in practice we define TT on the basis of an actual clock (TAI) 
and derive TCG from TT. Moreover, TDB is approximated from TT, and TCB 
is derived from the approximated TDB. 

Since TDB (and in turn TCB) are approximated, it is possible to create
your own time scale which uses a potentially more precise approximation using
&#96;ts-tdb-create&#96; and &#96;ts-tcb-create&#96;.

~ Figure { #fig-timescales; caption:"Relation between different time scales relative to TAI between 1950 and 2000. \
    The periodic terms of TCB and TDB are magnified by 100 to make them visible. \
    Figure from Seidelmann and Fukushima [@Seidelmann:why]." }
![timescales]
~

[timescales]: timescales.png { width:70%; }


## References {-}

~ Bibliography

~~ BibItem { #Fairhead:tt }
L.\ Fairhead and P.\ Bretagnon.
&#95;An analytical formula for the time transformation TB-TT&#95;.
Astronomy and Astrophysics, vol. 229, no. 1, March 1990, p. 240--247.
[ADS](http://articles.adsabs.harvard.edu/cgi-bin/nph-iarticle&#95;query?1990A%26A...229..240F)
~~

~~ BibItem { #Kaplan:circ }
George H.\ Kaplan.
&#95;The IAU Resolutions on Astronomical Reference Systems,
Time Scales, and Earth Rotation Models -- Explanation and Implementation&#95;.
USNO Circular [179](http://aa.usno.navy.mil/publications/docs/Circular&#95;179.pdf)
~~

~~ BibItem { #Seidelmann:why }
P.K.\ Seidelmann and T.\ Fukushima.
&#95;Why new time scales?&#95; 
Astronomy and Astrophysics, vol. 265, no. 2, p. 833--838.
[ADS](http://adsabs.harvard.edu/full/1992A%26A...265..833S)
~~

~

[IAU-B3]: http://www.iau.org/static/resolutions/IAU2006&#95;Resol3.pdf
[IAU-IV]: https://www.iers.org/IERS/EN/Science/Recommendations/recommendation4.html?nn=12932
[IERS-2010]: https://www.iers.org/SharedDocs/Publikationen/EN/IERS/Publications/tn/TechnNote36/tn36.pdf?&#95;&#95;blob=publicationFile&amp;v=1

&#42;/</span>
<span class="kw">module</span> astro

<span class="kw">import</span> fixed
<span class="kw">import</span> timestamp
<span class="kw">import</span> duration
<span class="kw">import</span> instant
<span class="kw">import</span> calendar

<span class="kw">extern</span> include {
  <span class="comment">// cs file "time-inline.cs"
</span>  js file <span class="st">"instant-inline.js"</span>
}



<span class="comment">// The Terrestrial (or Ephemeris) time calendar, i.e. an ISO calendar but using the &#96;ts-tt&#96; time scale.
// TT is always &#96;TAI + 32.184&#96;
</span><span class="decl-val" id="cal_tt"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="std_time_astro.html#cal_tt">cal-tt<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>cal<span class="dash">-</span>tt: <span class="tp">calendar</span></span></a>  <span class="kw">=</span> <a class="pp" href="std_time_calendar-source.html#iso_calendar">iso-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp" href="#ts_tt">ts-tt<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tt: <span class="tp">timescale</span></span></a> </span>)<span class="comment">//, fixed(32184,3) )
</span>
<span class="comment">// The TCG (Geometric coordinate time) calendar, i.e. an ISO calendar but using the &#96;ts-tcg&#96; time scale.
</span><span class="decl-val" id="cal_tcg"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="std_time_astro.html#cal_tcg">cal-tcg<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>cal<span class="dash">-</span>tcg: <span class="tp">calendar</span></span></a>  <span class="kw">=</span> <a class="pp" href="std_time_calendar-source.html#iso_calendar">iso-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp" href="#ts_tcg">ts-tcg<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tcg: <span class="tp">timescale</span></span></a> </span>)<span class="comment">//, fixed(32184,3) )
</span>
<span class="comment">// The TDB (Barycentric dynamical time) calendar, i.e. an ISO calendar but using the &#96;ts-tdb&#96; time scale. Always within 2ms of TT (&#96;cal-tt&#96;).
</span><span class="decl-val" id="cal_tdb"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="std_time_astro.html#cal_tdb">cal-tdb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>cal<span class="dash">-</span>tdb: <span class="tp">calendar</span></span></a>  <span class="kw">=</span> <a class="pp" href="std_time_calendar-source.html#iso_calendar">iso-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp" href="#ts_tdb">ts-tdb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tdb: <span class="tp">timescale</span></span></a> </span>)<span class="comment">//, fixed(32184,3) )
</span>
<span class="comment">// The TCB (Barycentric coordinate time) calendar, i.e. an ISO calendar but using the &#96;ts-tcb&#96; time scale.
</span><span class="decl-val" id="cal_tcb"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="std_time_astro.html#cal_tcb">cal-tcb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>cal<span class="dash">-</span>tcb: <span class="tp">calendar</span></span></a>  <span class="kw">=</span> <a class="pp" href="std_time_calendar-source.html#iso_calendar">iso-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp" href="#ts_tcb">ts-tcb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tcb: <span class="tp">timescale</span></span></a> </span>)<span class="comment">//, fixed(32184,3) )
</span>

<span class="comment">// The [TT](https://en.wikipedia.org/wiki/Terrestrial&#95;Time) (Terrestrial time)
// time scale is based on SI seconds with a 2000-01-01 TAI &#96;epoch&#96;. It is the
// continuation of TDT (Terrestrial dynamic time) and ET (Ephemeris time). TT
// is defined as: TT = TAI + 32.184s.
</span><span class="decl-val" id="ts_tt"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="std_time_astro.html#ts_tt">ts-tt<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tt: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="std_time_instant-source.html#tai_timescale">tai-timescale<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>tai<span class="dash">-</span>timescale: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">offset</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">y2k<span class="dash">-</span>epoch</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>( <span class="st">"TT"</span>, <a class="pp" href="std_time_duration-source.html#duration_2">duration<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">secs</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<span class="number">32.184</span>)</span>)


<span class="comment">/&#42;----------------------------------------------------------------------------
  TCG: Geocentric coordinate time
----------------------------------------------------------------------------&#42;/</span>

<span class="decl-val" id="lg"><span class="kw">val</span> <a class="pp" href="std_time_astro.html#lg">lg<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>lg: <span class="tp">fixed</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_num_fixed-source.html#type_space_fixed"><span class="tp">fixed</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>fixed: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="std_num_fixed-source.html#fixed">fixed<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>fixed: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">fixed</span></span></a>(<span class="number">6.969290134e-10</span></span>) <span class="comment">// 6.969290134e-10  // 1991: 6.969291e-10  // now: 6.969290134
</span><span class="decl-val" id="tcg_epoch_delta"><span class="kw">val</span> <a class="pp" href="std_time_astro.html#tcg_epoch_delta">tcg-epoch-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tcg<span class="dash">-</span>epoch<span class="dash">-</span>delta: <span class="tp">fixed</span></span></a> <span class="kw">=</span> (<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">7.25759967816e8</span>)<span class="kw op">.</span><a class="pp" href="std_num_fixed-source.html#fixed">fixed<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>fixed: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">fixed</span></span></a></span> <span class="comment">// 1977-01-01T00:00:32.184 TT, 2443144.5003725 JD~TT~
</span>
<span class="comment">// IAU 1991 recommendation IV :\
// TCG - TT = L~g~&amp;times;(JD~TT~ - TCG~epoch~)
// =&gt;
// TCG = TT + Lg&#42;(TT - TCG~epoch~)
</span><span class="decl-fun" id="tcg_from_tai"><span class="kw">fun</span> <a class="pp" href="std_time_astro.html#tcg_from_tai">tcg-from-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tcg<span class="dash">-</span>from<span class="dash">-</span>tai: <span class="tp sp">(</span><span class="tp tpp">tai</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>( <a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">tt<span class="pc">tt: <span class="tp">timestamp</span></span></a> <span class="kw">=</span> <a class="pp" href="#ts_tt">ts-tt<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tt: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#from_tai_1">from-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>from<span class="dash">-</span>tai<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>(<a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a>)
  <a class="pp">tt<span class="pc">tt: <span class="tp">timestamp</span></span></a> <a class="pp" href="std_time_timestamp-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> (<a class="pp" href="#lg">lg<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>lg: <span class="tp">fixed</span></span></a><a class="pp" href="std_num_fixed-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp tpp">q1</span> <span class="tp kw op">:</span> <span class="tp">fixed</span><span class="tp sp">,</span> <span class="tp tpp">q2</span> <span class="tp kw op">:</span> <span class="tp">fixed</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">fixed</span></span></a>(<a class="pp">tt<span class="pc">tt: <span class="tp">timestamp</span></span></a> <a class="pp" href="std_time_timestamp-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp" href="#tcg_epoch_delta">tcg-epoch-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tcg<span class="dash">-</span>epoch<span class="dash">-</span>delta: <span class="tp">fixed</span></span></a>)<span class="kw op">.</span><a class="pp" href="std_time_timestamp-source.html#timespan">timespan<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timespan: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>)
</span>}

<span class="comment">// IAU 1991 recommendation [IV](https://www.iers.org/IERS/EN/Science/Recommendations/recommendation4.html?nn=12932):\
// TCG - TT = L~g~&amp;times;(JD~TT~ - TCG~epoch~)
// =&gt;
// TT = TCG - Lg&#42;(TCG - TCG~epoch~)
</span><span class="decl-fun" id="tcg_to_tai"><span class="kw">fun</span> <a class="pp" href="std_time_astro.html#tcg_to_tai">tcg-to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tcg<span class="dash">-</span>to<span class="dash">-</span>tai: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>( <a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">tt<span class="pc">tt: <span class="tp">timestamp</span></span></a> <span class="kw">=</span> <a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a> <a class="pp" href="std_time_timestamp-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> (<a class="pp" href="#lg">lg<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>lg: <span class="tp">fixed</span></span></a><a class="pp" href="std_num_fixed-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp tpp">q1</span> <span class="tp kw op">:</span> <span class="tp">fixed</span><span class="tp sp">,</span> <span class="tp tpp">q2</span> <span class="tp kw op">:</span> <span class="tp">fixed</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">fixed</span></span></a>(<a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a> <a class="pp" href="std_time_timestamp-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp" href="#tcg_epoch_delta">tcg-epoch-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tcg<span class="dash">-</span>epoch<span class="dash">-</span>delta: <span class="tp">fixed</span></span></a>)<span class="kw op">.</span><a class="pp" href="std_time_timestamp-source.html#timespan">timespan<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timespan: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>)
  <a class="pp" href="#ts_tt">ts-tt<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tt: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#to_tai_1">to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>to<span class="dash">-</span>tai<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">tt<span class="pc">tt: <span class="tp">timestamp</span></span></a>)
</span>}

<span class="comment">// The [TCG](https://en.wikipedia.org/wiki/Geocentric&#95;Coordinate&#95;Time) (Geocentric coordinate time) time scale.
// The unit of TCG is the SI second in a coordinate reference frame at the center of the Earth. 
</span><span class="decl-val" id="ts_tcg"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="std_time_astro.html#ts_tcg">ts-tcg<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tcg: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="std_time_instant-source.html#timescale_1">timescale<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">from<span class="dash">-</span>tai</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">to<span class="dash">-</span>tai</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">y2k<span class="dash">-</span>epoch</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">unit</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">secs<span class="dash">-</span>in<span class="dash">-</span>day</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>( <span class="st">"TCG"</span>, <a class="pp" href="#tcg_from_tai">tcg-from-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tcg<span class="dash">-</span>from<span class="dash">-</span>tai: <span class="tp sp">(</span><span class="tp tpp">tai</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>, <a class="pp" href="#tcg_to_tai">tcg-to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tcg<span class="dash">-</span>to<span class="dash">-</span>tai: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a> </span>)


<span class="comment">/&#42;----------------------------------------------------------------------------
  TDB: Barycentric dynamical time
----------------------------------------------------------------------------&#42;/</span>
<span class="decl-val" id="j2k_epoch"><span class="kw">val</span> <a class="pp" href="std_time_astro.html#j2k_epoch">j2k-epoch<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>j2k<span class="dash">-</span>epoch: <span class="tp">fixed</span></span></a> <span class="kw">=</span> <a class="pp" href="std_num_fixed-source.html#fixed_1">fixed<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>fixed<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">fixed</span></span></a>(<span class="number">43200</span></span>)       <span class="comment">// 2000-01-01T12:00:00 TT
</span><span class="decl-val" id="secs_per_julian_year"><span class="kw">val</span> <a class="pp" href="std_time_astro.html#secs_per_julian_year">secs-per-julian-year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>secs<span class="dash">-</span>per<span class="dash">-</span>julian<span class="dash">-</span>year: <span class="tp">double</span></span></a> <span class="kw">=</span> <span class="number">3.15576e7</span></span>  <span class="comment">// 365.25 &#42; 86400.0
</span>
<span class="comment">// Compute tdb-delta(TT) = TDB - TT. This is the default function used for &#96;ts-tdb&#96;.
// Fairhead &amp; Bretagnon (1990) initial coefficents.
// See also USNO circular 179 ([@Kaplan:circ], section 2.6).
// The error in this approximation is a maximum of 10 micro-seconds in the time period 1600 to 2200.
// (and probably less as we expanded to more terms and do JPL planetary mass adjustment)
</span><span class="decl-fun" id="tdb_delta"><span class="kw">fun</span> <a class="pp" href="std_time_astro.html#tdb_delta">tdb-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tdb<span class="dash">-</span>delta: <span class="tp sp">(</span><span class="tp tpp">tt</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>( <a class="pp">tt<span class="pc">tt: <span class="tp">timestamp</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timespan"><span class="tp">timespan</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timespan: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <span class="kw">=</span> (<a class="pp">tt<span class="pc">tt: <span class="tp">timestamp</span></span></a> <a class="pp" href="std_time_timestamp-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp" href="#j2k_epoch">j2k-epoch<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>j2k<span class="dash">-</span>epoch: <span class="tp">fixed</span></span></a>)<span class="kw op">.</span><a class="pp" href="std_time_timestamp-source.html#seconds">seconds<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>seconds: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">fixed</span></span></a><span class="kw op">.</span><a class="pp" href="std_num_fixed-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">fixed</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> (<a class="pp" href="#secs_per_julian_year">secs-per-julian-year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>secs<span class="dash">-</span>per<span class="dash">-</span>julian<span class="dash">-</span>year: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1000.0</span>) <span class="comment">// fraction of Julian millenia since J2000
</span>
  <span class="comment">// First terms of Fairhead et al. model 
</span>  <span class="kw">val</span> <a class="pp">wf<span class="pc">wf: <span class="tp">double</span></span></a> <span class="kw">=</span>  <span class="number">1.6566746e-3</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <span class="number">6283.0758</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">6.2401</span>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>   <span class="number">2.24175e-5</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <span class="number">5753.3859</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">4.297</span>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>   <span class="number">1.38398e-5</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">12566.1527</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">6.1969</span>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>    <span class="number">4.7701e-6</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(  <span class="number">529.691</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">0.4444</span>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>    <span class="number">4.6767e-6</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <span class="number">6069.7768</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">4.0212</span>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>    <span class="number">2.2567e-6</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(  <span class="number">213.2991</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">5.5431</span>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>    <span class="number">1.6942e-6</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(   <a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">3.5232</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">5.0251</span>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>    <span class="number">1.5549e-6</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">77713.7715</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">5.1985</span>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>    <span class="number">1.2768e-6</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <span class="number">7860.4194</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">5.9888</span>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>    <span class="number">1.1934e-6</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <span class="number">5223.6939</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">3.6498</span>)            
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">1.021567e-4</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <span class="number">6283.0758</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">4.249</span>))
           
  <span class="comment">// Adjustments to use JPL planetary masses instead of IAU.
</span>  <span class="kw">val</span> <a class="pp">wj<span class="pc">wj: <span class="tp">double</span></span></a> <span class="kw">=</span>  <span class="number">6.5e-10</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">6069.776754</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">4.021194</span>) <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>
            <span class="number">3.3e-10</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <span class="number">213.299095</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">5.543132</span>) <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>
          (<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">1.96e-9</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">6208.294251</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">5.696701</span>)) <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>
          (<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">1.73e-9</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(  <span class="number">74.781599</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">2.4359</span>)) <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>
            <span class="number">3.638e-8</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a>;

  <span class="comment">// Topo centric adjustments
</span>  <span class="kw">val</span> <a class="pp">wt<span class="pc">wt: <span class="tp">double</span></span></a> <span class="kw">=</span> <span class="number">0.0</span> <span class="comment">// tdb-topocentric(t,0.5,~155.933222,10000.0,5000.0)
</span>  
  <a class="pp" href="std_num_fixed-source.html#fixed">fixed<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>fixed: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">fixed</span></span></a>( <a class="pp">wf<span class="pc">wf: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">wj<span class="pc">wj: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">wt<span class="pc">wt: <span class="tp">double</span></span></a> )
</span>}

<span class="decl-val" id="pi2"><span class="kw">val</span> <a class="pp" href="std_time_astro.html#pi2">pi2<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>pi2: <span class="tp">double</span></span></a>   <span class="kw">=</span> <span class="number">6.283185307179586</span></span>      <span class="comment">// 2pi
</span><span class="decl-val" id="dd2r"><span class="kw">val</span> <a class="pp" href="std_time_astro.html#dd2r">dd2r<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>dd2r: <span class="tp">double</span></span></a>  <span class="kw">=</span> <span class="number">1.7453292519943295e-2</span></span>   <span class="comment">// degree to radians
</span>
<span class="comment">// From the ERFA routines
</span><span class="decl-fun" id="tdb_topocentric"><span class="kw">fun</span> <a class="pp" href="std_time_astro.html#tdb_topocentric">tdb-topocentric<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tdb<span class="dash">-</span>topocentric: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">ut</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">elong</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">u</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(  <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a>,        <span class="comment">// fractional julian millennia
</span>                      <a class="pp">ut<span class="pc">ut: <span class="tp op">?</span><span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0.0</span>, <span class="comment">// UT1 (fraction of one day)
</span>                      <a class="pp">elong<span class="pc">elong: <span class="tp op">?</span><span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0.0</span>, <span class="comment">// east positive degrees 
</span>                      <a class="pp">u<span class="pc">u: <span class="tp op">?</span><span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0.0</span>, <span class="comment">// distance earth spin axis in km
</span>                      <a class="pp">v<span class="pc">v: <span class="tp op">?</span><span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0.0</span>  <span class="comment">// distance north of eq. plane in km 
</span>                      ) {
  <span class="comment">// Convert UT to local solar time in radians. 
</span>  <span class="kw">val</span> <a class="pp">tsol<span class="pc">tsol: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">ut<span class="pc">ut: <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#fraction">fraction<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>fraction: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="#pi2">pi2<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>pi2: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">elong<span class="pc">elong: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="#dd2r">dd2r<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>dd2r: <span class="tp">double</span></span></a>

  <span class="comment">// Combine time argument (millennia) with deg/arcsec factor. 
</span>  <span class="kw">val</span> <a class="pp">w<span class="pc">w: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">3600.0</span>

  <span class="comment">// Sun Mean Longitude. 
</span>  <span class="kw">val</span> <a class="pp">elsun<span class="pc">elsun: <span class="tp">double</span></span></a> <span class="kw">=</span> ((<span class="number">280.46645683</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1.29602771103429e9</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">w<span class="pc">w: <span class="tp">double</span></span></a>) <a class="pp" href="std_core-source.html#_perc__1">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(%)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">360.0</span>) <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="#dd2r">dd2r<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>dd2r: <span class="tp">double</span></span></a>

  <span class="comment">// Sun Mean Anomaly. 
</span>  <span class="kw">val</span> <a class="pp">emsun<span class="pc">emsun: <span class="tp">double</span></span></a> <span class="kw">=</span> ((<span class="number">357.52910918</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1.295965810481e9</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">w<span class="pc">w: <span class="tp">double</span></span></a>) <a class="pp" href="std_core-source.html#_perc__1">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(%)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">360.0</span>) <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="#dd2r">dd2r<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>dd2r: <span class="tp">double</span></span></a>

  <span class="comment">// Mean Elongation of Moon from Sun. 
</span>  <span class="kw">val</span> <a class="pp">d<span class="pc">d: <span class="tp">double</span></span></a> <span class="kw">=</span> ((<span class="number">297.85019547</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1.602961601209e10</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">w<span class="pc">w: <span class="tp">double</span></span></a>) <a class="pp" href="std_core-source.html#_perc__1">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(%)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">360.0</span>) <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="#dd2r">dd2r<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>dd2r: <span class="tp">double</span></span></a>

  <span class="comment">// Mean Longitude of Jupiter. 
</span>  <span class="kw">val</span> <a class="pp">elj<span class="pc">elj: <span class="tp">double</span></span></a> <span class="kw">=</span> ((<span class="number">34.35151874</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1.0930689989453e8</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">w<span class="pc">w: <span class="tp">double</span></span></a>) <a class="pp" href="std_core-source.html#_perc__1">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(%)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">360.0</span>) <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="#dd2r">dd2r<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>dd2r: <span class="tp">double</span></span></a>

  <span class="comment">// Mean Longitude of Saturn.
</span>  <span class="kw">val</span> <a class="pp">els<span class="pc">els: <span class="tp">double</span></span></a> <span class="kw">=</span> ((<span class="number">50.0774443</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">4.404639847038e7</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">w<span class="pc">w: <span class="tp">double</span></span></a>) <a class="pp" href="std_core-source.html#_perc__1">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(%)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">360.0</span>) <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="#dd2r">dd2r<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>dd2r: <span class="tp">double</span></span></a>

  <span class="comment">// Moyer 1981 and Murray 1983. 
</span>  <span class="kw">val</span> <a class="pp">wt<span class="pc">wt: <span class="tp">double</span></span></a> <span class="kw">=</span>   <span class="number">2.9e-14</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">tsol<span class="pc">tsol: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">elsun<span class="pc">elsun: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">els<span class="pc">els: <span class="tp">double</span></span></a>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>  <span class="number">1.0e-13</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">tsol<span class="pc">tsol: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">2.0</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">emsun<span class="pc">emsun: <span class="tp">double</span></span></a>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>  <span class="number">1.33e-13</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">tsol<span class="pc">tsol: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">d<span class="pc">d: <span class="tp">double</span></span></a>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>  <span class="number">1.33e-13</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">tsol<span class="pc">tsol: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> (<a class="pp">elsun<span class="pc">elsun: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">elj<span class="pc">elj: <span class="tp">double</span></span></a>))
          <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>  <span class="number">2.29e-13</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">tsol<span class="pc">tsol: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> (<span class="number">2.0</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">elsun<span class="pc">elsun: <span class="tp">double</span></span></a>) <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">emsun<span class="pc">emsun: <span class="tp">double</span></span></a>)
          <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>  <span class="number">2.2e-12</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">v<span class="pc">v: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#cos">cos<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>cos: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">elsun<span class="pc">elsun: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">emsun<span class="pc">emsun: <span class="tp">double</span></span></a>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>  <span class="number">5.312e-12</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">tsol<span class="pc">tsol: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">emsun<span class="pc">emsun: <span class="tp">double</span></span></a>)
          <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>  <span class="number">1.3677e-11</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">tsol<span class="pc">tsol: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">2.0</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">elsun<span class="pc">elsun: <span class="tp">double</span></span></a>)
          <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>  <span class="number">1.3184e-10</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">v<span class="pc">v: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#cos">cos<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>cos: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">elsun<span class="pc">elsun: <span class="tp">double</span></span></a>)
          <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>  <span class="number">3.17679e-10</span> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">tsol<span class="pc">tsol: <span class="tp">double</span></span></a>);
  <a class="pp">wt<span class="pc">wt: <span class="tp">double</span></span></a>          
</span>}

<span class="decl-fun" id="tai_to_tdb"><span class="kw">fun</span> <a class="pp" href="std_time_astro.html#tai_to_tdb">tai-to-tdb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tai<span class="dash">-</span>to<span class="dash">-</span>tdb: <span class="tp sp">(</span><span class="tp tpp">tai</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">delta</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>( <a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <a class="pp">delta<span class="pc">delta: <span class="tp op">?</span><span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="tp kw op">-></span> <a class="pp" href="std_time_timestamp-source.html#type_space_timespan"><span class="tp">timespan</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timespan: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#tdb_delta">tdb-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tdb<span class="dash">-</span>delta: <span class="tp sp">(</span><span class="tp tpp">tt</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">tt<span class="pc">tt: <span class="tp">timestamp</span></span></a> <span class="kw">=</span> <a class="pp" href="#ts_tt">ts-tt<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tt: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#from_tai_1">from-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>from<span class="dash">-</span>tai<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>(<a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a>)
  <a class="pp">tt<span class="pc">tt: <span class="tp">timestamp</span></span></a> <a class="pp" href="std_time_timestamp-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp">delta<span class="pc">delta: <span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>(<a class="pp">tt<span class="pc">tt: <span class="tp">timestamp</span></span></a>)
</span>}

<span class="decl-fun" id="tdb_to_tai"><span class="kw">fun</span> <a class="pp" href="std_time_astro.html#tdb_to_tai">tdb-to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tdb<span class="dash">-</span>to<span class="dash">-</span>tai: <span class="tp sp">(</span><span class="tp tpp">tdb</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">delta</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>( <a class="pp">tdb<span class="pc">tdb: <span class="tp">timestamp</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a>, <a class="pp">delta<span class="pc">delta: <span class="tp op">?</span><span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="tp kw op">-></span> <a class="pp" href="std_time_timestamp-source.html#type_space_timespan"><span class="tp">timespan</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timespan: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#tdb_delta">tdb-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tdb<span class="dash">-</span>delta: <span class="tp sp">(</span><span class="tp tpp">tt</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a> {
  <a class="pp" href="#ts_tt">ts-tt<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tt: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#to_tai_1">to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>to<span class="dash">-</span>tai<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>( <a class="pp">tdb<span class="pc">tdb: <span class="tp">timestamp</span></span></a> <a class="pp" href="std_time_timestamp-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp">delta<span class="pc">delta: <span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>(<a class="pp">tdb<span class="pc">tdb: <span class="tp">timestamp</span></span></a>) )
</span>}

<span class="comment">// The [TDB](https://en.wikipedia.org/wiki/Barycentric&#95;Coordinate&#95;Time) (Barycentric dynamical time) time scale
// (which can be considered equivalent T~eph~).
//
// TDB is approximated from TT using an initial set of coefficients by
// Fairhead &amp;amp; Bretagnon [@Fairhead:tt] assuming the geo center (longitude and latitude of 0 degrees).
// See also USNO circular 179 ([@Kaplan:circ], equation 2.6).
// The approximation is within 10&amp;mu;s precision in the time span 1600 to 2200 (and probably a bit less).
</span><span class="decl-val" id="ts_tdb"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="std_time_astro.html#ts_tdb">ts-tdb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tdb: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#ts_tdb_create">ts-tdb-create<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tdb<span class="dash">-</span>create: <span class="tp sp">(</span><span class="tp tpp">tdb<span class="dash">-</span>minus<span class="dash">-</span>tt</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>(<a class="pp" href="#tdb_delta">tdb-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tdb<span class="dash">-</span>delta: <span class="tp sp">(</span><span class="tp tpp">tt</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a></span>)

<span class="comment">// Creates a new TDB timescale given a user provided function to calculate TDB-TT.
// The default function used for &#96;ts-tdb&#96; uses the Fairhead &amp;amp; Bretagnon approximation
// corrected for JPL planetary masses but assumes the geo center. Use this function 
// to create a new TDB timescale if you need more precision.
</span><span class="decl-fun" id="ts_tdb_create"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_time_astro.html#ts_tdb_create">ts-tdb-create<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tdb<span class="dash">-</span>create: <span class="tp sp">(</span><span class="tp tpp">tdb<span class="dash">-</span>minus<span class="dash">-</span>tt</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>( <a class="pp">tdb-minus-tt<span class="pc">tdb<span class="dash">-</span>minus<span class="dash">-</span>tt: <span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a> <span class="tp kw op">-></span> <a class="pp" href="std_time_timestamp-source.html#type_space_timespan"><span class="tp">timespan</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timespan: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a> {
  <a class="pp" href="std_time_instant-source.html#timescale_1">timescale<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">from<span class="dash">-</span>tai</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">to<span class="dash">-</span>tai</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">y2k<span class="dash">-</span>epoch</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">unit</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">secs<span class="dash">-</span>in<span class="dash">-</span>day</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>(<span class="st">"TDB"</span>, 
    <span class="kw">fun</span>(<a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a><span class="tp kw op">:</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>)  { <a class="pp" href="#tai_to_tdb">tai-to-tdb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tai<span class="dash">-</span>to<span class="dash">-</span>tdb: <span class="tp sp">(</span><span class="tp tpp">tai</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">delta</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>(<a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a>,<a class="pp">tdb-minus-tt<span class="pc">tdb<span class="dash">-</span>minus<span class="dash">-</span>tt: <span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>) },
    <span class="kw">fun</span>(<a class="pp">tdb<span class="pc">tdb: <span class="tp">timestamp</span></span></a><span class="tp kw op">:</span><a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a>) { <a class="pp" href="#tdb_to_tai">tdb-to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tdb<span class="dash">-</span>to<span class="dash">-</span>tai: <span class="tp sp">(</span><span class="tp tpp">tdb</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">delta</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">tdb<span class="pc">tdb: <span class="tp">timestamp</span></span></a>,<a class="pp">tdb-minus-tt<span class="pc">tdb<span class="dash">-</span>minus<span class="dash">-</span>tt: <span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>) }
  )
</span>}


<span class="comment">/&#42;----------------------------------------------------------------------------
  TCB: Barycentric coordinate time
----------------------------------------------------------------------------&#42;/</span>

<span class="decl-val" id="lb"><span class="kw">val</span> <a class="pp" href="std_time_astro.html#lb">lb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>lb: <span class="tp">fixed</span></span></a>   <span class="tp kw op">:</span> <a class="pp" href="std_num_fixed-source.html#type_space_fixed"><span class="tp">fixed</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>fixed: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="std_num_fixed-source.html#fixed">fixed<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>fixed: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">fixed</span></span></a>(<span class="number">1.55051976772e-8</span></span>) <span class="comment">// 1.55051976772e-8
</span><span class="decl-val" id="tdb0"><span class="kw">val</span> <a class="pp" href="std_time_astro.html#tdb0">tdb0<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tdb0: <span class="tp">fixed</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_num_fixed-source.html#type_space_fixed"><span class="tp">fixed</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>fixed: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="std_num_fixed-source.html#fixed">fixed<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>fixed: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">fixed</span></span></a>(<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">6.55e-5</span></span>) <span class="comment">// ~6.55e-5
</span>
<span class="decl-fun" id="tai_to_tcb"><span class="kw">fun</span> <a class="pp" href="std_time_astro.html#tai_to_tcb">tai-to-tcb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tai<span class="dash">-</span>to<span class="dash">-</span>tcb: <span class="tp sp">(</span><span class="tp tpp">tai</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">tstdb</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>( <a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <a class="pp">tstdb<span class="pc">tstdb: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">tdb<span class="pc">tdb: <span class="tp">timestamp</span></span></a> <span class="kw">=</span> <a class="pp">tstdb<span class="pc">tstdb: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#from_tai_1">from-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>from<span class="dash">-</span>tai<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>(<a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a>)
  <span class="kw">val</span> <a class="pp">adj<span class="pc">adj: <span class="tp">fixed</span></span></a> <span class="kw">=</span> <a class="pp" href="#lb">lb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>lb: <span class="tp">fixed</span></span></a><a class="pp" href="std_num_fixed-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp tpp">q1</span> <span class="tp kw op">:</span> <span class="tp">fixed</span><span class="tp sp">,</span> <span class="tp tpp">q2</span> <span class="tp kw op">:</span> <span class="tp">fixed</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">fixed</span></span></a>(<a class="pp">tdb<span class="pc">tdb: <span class="tp">timestamp</span></span></a> <a class="pp" href="std_time_timestamp-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp" href="#tcg_epoch_delta">tcg-epoch-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tcg<span class="dash">-</span>epoch<span class="dash">-</span>delta: <span class="tp">fixed</span></span></a>)<span class="kw op">.</span><a class="pp" href="std_time_timestamp-source.html#timespan">timespan<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timespan: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>
  <a class="pp">tdb<span class="pc">tdb: <span class="tp">timestamp</span></span></a> <a class="pp" href="std_time_timestamp-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> (<a class="pp">adj<span class="pc">adj: <span class="tp">fixed</span></span></a> <a class="pp" href="std_num_fixed-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">q1</span> <span class="tp kw op">:</span> <span class="tp">fixed</span><span class="tp sp">,</span> <span class="tp tpp">q2</span> <span class="tp kw op">:</span> <span class="tp">fixed</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">fixed</span></span></a> <a class="pp" href="#tdb0">tdb0<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tdb0: <span class="tp">fixed</span></span></a>)
</span>}

<span class="decl-fun" id="tcb_to_tai"><span class="kw">fun</span> <a class="pp" href="std_time_astro.html#tcb_to_tai">tcb-to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tcb<span class="dash">-</span>to<span class="dash">-</span>tai: <span class="tp sp">(</span><span class="tp tpp">tcb</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">tstdb</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>( <a class="pp">tcb<span class="pc">tcb: <span class="tp">timestamp</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a>, <a class="pp">tstdb<span class="pc">tstdb: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">adj<span class="pc">adj: <span class="tp">fixed</span></span></a> <span class="kw">=</span> <a class="pp" href="#lb">lb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>lb: <span class="tp">fixed</span></span></a><a class="pp" href="std_num_fixed-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp tpp">q1</span> <span class="tp kw op">:</span> <span class="tp">fixed</span><span class="tp sp">,</span> <span class="tp tpp">q2</span> <span class="tp kw op">:</span> <span class="tp">fixed</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">fixed</span></span></a>(<a class="pp">tcb<span class="pc">tcb: <span class="tp">timestamp</span></span></a> <a class="pp" href="std_time_timestamp-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp" href="#tcg_epoch_delta">tcg-epoch-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tcg<span class="dash">-</span>epoch<span class="dash">-</span>delta: <span class="tp">fixed</span></span></a>)<span class="kw op">.</span><a class="pp" href="std_time_timestamp-source.html#timespan">timespan<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timespan: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>
  <span class="kw">val</span> <a class="pp">tdb<span class="pc">tdb: <span class="tp">timestamp</span></span></a> <span class="kw">=</span> <a class="pp">tcb<span class="pc">tcb: <span class="tp">timestamp</span></span></a> <a class="pp" href="std_time_timestamp-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> (<a class="pp">adj<span class="pc">adj: <span class="tp">fixed</span></span></a> <a class="pp" href="std_num_fixed-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>fixed<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">q1</span> <span class="tp kw op">:</span> <span class="tp">fixed</span><span class="tp sp">,</span> <span class="tp tpp">q2</span> <span class="tp kw op">:</span> <span class="tp">fixed</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">fixed</span></span></a> <a class="pp" href="#tdb0">tdb0<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tdb0: <span class="tp">fixed</span></span></a>)
  <a class="pp">tstdb<span class="pc">tstdb: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#to_tai_1">to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>to<span class="dash">-</span>tai<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">tdb<span class="pc">tdb: <span class="tp">timestamp</span></span></a>)
</span>}

<span class="comment">// The [TCB](https://en.wikipedia.org/wiki/Geocentric&#95;Coordinate&#95;Time)
// (Barycentric coordinate time) time scale.\ The unit of TCB is the SI
// second, but in a coordinate reference frame at the barycenter of the solar
// system. 
</span><span class="decl-val" id="ts_tcb"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="std_time_astro.html#ts_tcb">ts-tcb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tcb: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#ts_tcb_create">ts-tcb-create<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tcb<span class="dash">-</span>create: <span class="tp sp">(</span><span class="tp tpp">tstdb</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>(<a class="pp" href="#ts_tdb">ts-tdb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tdb: <span class="tp">timescale</span></span></a></span>)

<span class="comment">// Create a new TCB timescale given a TDB timescale (&#96;tstdb&#96;). The default
// &#96;ts-tcb&#96; uses the default &#96;ts-tdb&#96; timescale, but if you created
// a different TCB time scale (using &#96;ts-tdb-create&#96;) you can use
// this function to create a TCB time scale from it. It computes
// TCB from the provided TDB using the IAU 2006 resolution 
// [B3](http://www.iau.org/static/resolutions/IAU2006&#95;Resol3.pdf):\ TDB = TCB -
// L~b~ &amp;times; (JD~TCB~ - T~0~) &amp;times; 86400 + TDB~0~, with T~0~ =
// 2443144.5003725, L~b~ = 1.55051976772&amp;times;10^-8^, TDB~0~ =
// -6.55&amp;times;10^-5^.
</span><span class="decl-fun" id="ts_tcb_create"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_time_astro.html#ts_tcb_create">ts-tcb-create<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>ts<span class="dash">-</span>tcb<span class="dash">-</span>create: <span class="tp sp">(</span><span class="tp tpp">tstdb</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>( <a class="pp">tstdb<span class="pc">tstdb: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a> {
  <a class="pp" href="std_time_instant-source.html#timescale_1">timescale<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">from<span class="dash">-</span>tai</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">to<span class="dash">-</span>tai</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">y2k<span class="dash">-</span>epoch</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">unit</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">secs<span class="dash">-</span>in<span class="dash">-</span>day</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>( <span class="st">"TCB"</span>, 
    <span class="kw">fun</span>(<a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a><span class="tp kw op">:</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>)  { <a class="pp" href="#tai_to_tcb">tai-to-tcb<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tai<span class="dash">-</span>to<span class="dash">-</span>tcb: <span class="tp sp">(</span><span class="tp tpp">tai</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">tstdb</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>(<a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a>, <a class="pp">tstdb<span class="pc">tstdb: <span class="tp">timescale</span></span></a>) },
    <span class="kw">fun</span>(<a class="pp">tcb<span class="pc">tcb: <span class="tp">timestamp</span></span></a><span class="tp kw op">:</span><a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a>) { <a class="pp" href="#tcb_to_tai">tcb-to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro<span class="fslash last">/</span></span>tcb<span class="dash">-</span>to<span class="dash">-</span>tai: <span class="tp sp">(</span><span class="tp tpp">tcb</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">tstdb</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">tcb<span class="pc">tcb: <span class="tp">timestamp</span></span></a>, <a class="pp">tstdb<span class="pc">tstdb: <span class="tp">timescale</span></span></a>) }
  )
</span>}

</pre>

</div></body>
</html>
