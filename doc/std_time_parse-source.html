<!DOCTYPE html>
<html>
<!-- NO_CLICK_TRACKING -->

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<style type="text/css">.koka .plaincode, .koka a.pp .pc { display: none; } .koka a.pp { color: inherit; text-decoration: none; }</style>
<link rel="stylesheet" type="text/css" href="styles/madoko.css" />
<link rel="stylesheet" type="text/css" href="styles/koka.css" />

<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic,700,700italic" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic" />

<title>parse.kk documentation</title>
</head>

<body class="koka doc body"><div class="madoko">
<pre class="koka source"><span class="comment">/&#42;----------------------------------------------------------------------------
   Copyright (C) 2012-2016 Microsoft Corporation
    
   Licensed under the Apache License, Version 2.0 ("The Licence"). You may not
   use this file except in compliance with the License. A copy of the License
   can be found in the file "license.txt" at the root of this distribution.
----------------------------------------------------------------------------&#42;/</span>

<span class="comment">// Parsing of time strings.
</span><span class="kw">module</span> parse

<span class="kw">import</span> regex
<span class="kw">import</span> ddouble
<span class="kw">import</span> duration
<span class="kw">import</span> date
<span class="kw">import</span> calendar
<span class="kw">import</span> calendars  <span class="comment">// iso-week, iso-month
</span><span class="kw">import</span> time
<span class="kw">import</span> locale


<span class="comment">// -----------------------------------------------------------
// Parsing 
// -----------------------------------------------------------
</span>
<span class="comment">/&#42; Parse an [ISO 8601](https://en.wikipedia.org/wiki/ISO&#95;8601) time string.
The optional &#96;calendar&#96; (=&#96;cal-iso&#96;) argument can be given to interpret
the date in a different calendar. If a time zone offset is given, the 

&#96;&#96;&#96;&#96;plain
2008-12-31               // just date
2009-W01-3               // week number and day
2008-366                 // day of the year

20081231, 2009W013, 2008366  // without dashes

2008-12-31T09            // with time part, use T or space
2008-12-31 09
2008-12-31T09:20:16
2008-12-31T09:20:16.345  // with milliseconds (can be any fraction)
2008-12-30T24:00:00      // next day at midnight
20081231T092016.345      // without separators

2008-12-31T09Z           // UTC time zone (Z)
2008-12-31 09-07:00      // UTC-07:00 time zone
2008-12-31T09:20:16+0830 // UTC+08:30 time zone (without colon)
&#96;&#96;&#96;&#96;

And also parses the ISO month dates (see &#96;cal-iso-month&#96;):

&#96;&#96;&#96;&#96;plain
2009-M01-03              // just month date
2009-M003                // month date with day of the year
&#96;&#96;&#96;&#96;
. 
&#42;/</span>
<span class="decl-fun" id="parse_iso"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_parse.html#parse_iso">parse-iso<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>parse<span class="dash">-</span>iso: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">time</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">calendar<span class="pc">calendar: <span class="tp op">?</span><span class="tp">calendar</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_optional"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar-source.html#cal_iso">cal-iso<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>cal<span class="dash">-</span>iso: <span class="tp">calendar</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_time-source.html#type_space_time"><span class="tp">time</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>time<span class="fslash last">/</span></span>time: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <span class="kw">match</span>(<a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#find">find<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>find: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">regex</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="#rx_iso_date">rx-iso-date<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>rx<span class="dash">-</span>iso<span class="dash">-</span>date: <span class="tp">regex</span></span></a>)) {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a>) <span class="kw op">-></span> {
      <span class="kw">val</span> <a class="pp">xyear<span class="pc">xyear: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">1</span>)
      <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">date<span class="pc">date: <span class="tp">date</span></span></a>,<a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span>
        <span class="kw">if</span> (<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="number">4</span>] <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_excl__eq__3">!=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(!=)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="st">""</span>) <span class="kw">then</span> <span class="comment">// ISO week date
</span>          <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#con_space_Date"><span class="co">Date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>Date: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">day</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>(<a class="pp">xyear<span class="pc">xyear: <span class="tp">int</span></span></a>,<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">4</span>),<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">5</span>,<span class="number">1</span>)),<a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendars-source.html#cal_iso_week">cal-iso-week<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendars<span class="fslash last">/</span></span>cal<span class="dash">-</span>iso<span class="dash">-</span>week: <span class="tp">calendar</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>        
        <span class="kw">elif</span> (<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="number">6</span>] <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_excl__eq__3">!=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(!=)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="st">""</span>) <span class="kw">then</span> <span class="comment">// ISO day of the year
</span>          <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#con_space_Date"><span class="co">Date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>Date: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">day</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>(<a class="pp">xyear<span class="pc">xyear: <span class="tp">int</span></span></a>,<span class="number">1</span>,<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">6</span>)), <a class="pp">calendar<span class="pc">calendar: <span class="tp">calendar</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
        <span class="kw">elif</span> (<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="number">7</span>] <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_excl__eq__3">!=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(!=)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="st">""</span>) <span class="kw">then</span> <span class="comment">// ISO month date
</span>          <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#con_space_Date"><span class="co">Date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>Date: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">day</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>(<a class="pp">xyear<span class="pc">xyear: <span class="tp">int</span></span></a>,<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">7</span>),<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">8</span>)), <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendars-source.html#cal_iso_month">cal-iso-month<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendars<span class="fslash last">/</span></span>cal<span class="dash">-</span>iso<span class="dash">-</span>month: <span class="tp">calendar</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
        <span class="kw">elif</span> (<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="number">9</span>] <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_excl__eq__3">!=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(!=)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="st">""</span>) <span class="kw">then</span> <span class="comment">// ISO month date, day of the year
</span>          <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#con_space_Date"><span class="co">Date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>Date: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">day</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>(<a class="pp">xyear<span class="pc">xyear: <span class="tp">int</span></span></a>,<span class="number">1</span>,<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">9</span>)), <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendars-source.html#cal_iso_month">cal-iso-month<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendars<span class="fslash last">/</span></span>cal<span class="dash">-</span>iso<span class="dash">-</span>month: <span class="tp">calendar</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
        <span class="kw">else</span> <span class="comment">// (capd.groups[2] != "")  // regular ISO date
</span>          <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#con_space_Date"><span class="co">Date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>Date: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">day</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>(<a class="pp">xyear<span class="pc">xyear: <span class="tp">int</span></span></a>,<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">2</span>),<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">3</span>)),<a class="pp">calendar<span class="pc">calendar: <span class="tp">calendar</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
      <span class="kw">match</span>(<a class="pp">capd<span class="pc">capd: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#slice">slice<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>slice: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">sslice</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#after">after<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>after: <span class="tp sp">(</span><span class="tp tpp">slice</span> <span class="tp kw op">:</span> <span class="tp">sslice</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">sslice</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#string_3">string<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp tpp">slice</span> <span class="tp kw op">:</span> <span class="tp">sslice</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#find">find<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>find: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">regex</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="#rx_iso_time">rx-iso-time<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>rx<span class="dash">-</span>iso<span class="dash">-</span>time: <span class="tp">regex</span></span></a>)) {
        <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>    <span class="kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
        <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">capt<span class="pc">capt: <span class="tp">matched</span></span></a>) <span class="kw op">-></span> {
          <span class="kw">val</span> <a class="pp">hours<span class="pc">hours: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">capt<span class="pc">capt: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">1</span>)
          <span class="kw">val</span> <a class="pp">mins<span class="pc">mins: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp">capt<span class="pc">capt: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">2</span>)
          <span class="kw">val</span> <a class="pp">secs<span class="pc">secs: <span class="tp">ddouble</span></span></a>  <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#parse_ddouble">parse-ddouble<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>parse<span class="dash">-</span>ddouble: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">ddouble</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">capt<span class="pc">capt: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>[]: <span class="tp sp">(</span><span class="tp tpp">groups</span> <span class="tp kw op">:</span> <span class="tp">groups</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="number">3</span>] <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">"."</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">capt<span class="pc">capt: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>[]: <span class="tp sp">(</span><span class="tp tpp">groups</span> <span class="tp kw op">:</span> <span class="tp">groups</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="number">4</span>])<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#default">default<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>default: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#zero">zero<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>zero: <span class="tp">ddouble</span></span></a>)
          <span class="kw">val</span> <a class="pp">tzsign<span class="pc">tzsign: <span class="tp">int</span></span></a><span class="kw">=</span> <span class="kw">if</span> (<a class="pp">capt<span class="pc">capt: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="number">5</span>]<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_eq__eq__3">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><span class="st">"+"</span>) <span class="kw">then</span> <span class="number">1</span> <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_tilde_">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">1</span>
          <span class="kw">val</span> <a class="pp">tzhours<span class="pc">tzhours: <span class="tp">int</span></span></a><span class="kw">=</span> <a class="pp">capt<span class="pc">capt: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">6</span>) 
          <span class="kw">val</span> <a class="pp">tzmins<span class="pc">tzmins: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">capt<span class="pc">capt: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">7</span>)
          <span class="kw">val</span> <a class="pp">tzone<span class="pc">tzone: <span class="tp">timezone</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar-source.html#tz_fixed">tz-fixed<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>fixed: <span class="tp sp">(</span><span class="tp tpp">hours</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">mins</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">abbrv</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">hourwidth</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timezone</span></span></a>(<a class="pp">tzsign<span class="pc">tzsign: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">tzhours<span class="pc">tzhours: <span class="tp">int</span></span></a>, <a class="pp">tzmins<span class="pc">tzmins: <span class="tp">int</span></span></a>)
          <span class="kw">val</span> <a class="pp">clock<span class="pc">clock: <span class="tp">clock</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#con_space_Clock"><span class="co">Clock</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>Clock: <span class="tp sp">(</span><span class="tp tpp">hours</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">minutes</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">seconds</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">clock</span></span></a>(<a class="pp">hours<span class="pc">hours: <span class="tp">int</span></span></a>,<a class="pp">mins<span class="pc">mins: <span class="tp">int</span></span></a>,<a class="pp">secs<span class="pc">secs: <span class="tp">ddouble</span></span></a>)
          <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_time-source.html#time_3">time<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>time<span class="fslash last">/</span></span>time<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">clock</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">timezone</span><span class="tp sp">,</span> <span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">time</span></span></a>(<a class="pp">date<span class="pc">date: <span class="tp">date</span></span></a>,<a class="pp">clock<span class="pc">clock: <span class="tp">clock</span></span></a>,tz<span class="kw">=</span><a class="pp">tzone<span class="pc">tzone: <span class="tp">timezone</span></span></a>,cal<span class="kw">=</span><a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a>))
        }
      }
    }
  }
</span>}
<span class="decl-val" id="rx_iso_date"><span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_parse.html#rx_iso_date">rx-iso-date<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>rx<span class="dash">-</span>iso<span class="dash">-</span>date: <span class="tp">regex</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#regex">regex<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>regex: <span class="tp sp">(</span><span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">ignorecase</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">multiline</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">regex</span></span></a>(<span class="st">"^(\\d\\d\\d\\d)\\-?(?:(\\d\\d)\\-?(\\d\\d)|W(\\d\\d)\\-?(\\d)?|(\\d\\d\\d)|M(\\d\\d)\\-?(\\d\\d)|M(\\d\\d\\d))(?=$|[T\\+\\- ]\\d|Z)"</span></span>);
<span class="decl-val" id="rx_iso_time"><span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_parse.html#rx_iso_time">rx-iso-time<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>rx<span class="dash">-</span>iso<span class="dash">-</span>time: <span class="tp">regex</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#regex">regex<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>regex: <span class="tp sp">(</span><span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">ignorecase</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">multiline</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">regex</span></span></a>(<span class="st">"^(?:[T ](\\d\\d)(?:\\:?(\\d\\d)(?:\\:?(\\d\\d))?)?(?:[\\.,](\\d+))?)?(?:Z|([\\+\\-])(\\d\\d)(?:\\:?(\\d\\d))?)?$"</span></span>)

<span class="decl-fun" id="num"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_parse.html#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#type_space_matched"><span class="tp">matched</span><span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>matched: <span class="tp">V</span></span></a>, <a class="pp">group<span class="pc">group: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">default<span class="pc">default: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0</span> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#parse_int_default">parse-int-default<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>parse<span class="dash">-</span>int<span class="dash">-</span>default: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">hex</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>[]: <span class="tp sp">(</span><span class="tp tpp">groups</span> <span class="tp kw op">:</span> <span class="tp">groups</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><a class="pp">group<span class="pc">group: <span class="tp">int</span></span></a>], default <span class="kw">=</span> <a class="pp">default<span class="pc">default: <span class="tp">int</span></span></a>)
</span>}

<span class="comment">// Parse an [Internet Message Format](https://tools.ietf.org/html/rfc2822#section-3.3) time string.
// For example: &#96;"Tue, 27 Sep 2016 06:36:55 -0700"&#96;.
</span><span class="decl-fun" id="parse_imf"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_parse.html#parse_imf">parse-imf<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>parse<span class="dash">-</span>imf: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">time</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_time-source.html#type_space_time"><span class="tp">time</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>time<span class="fslash last">/</span></span>time: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <span class="kw">match</span>(<a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#find">find<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>find: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">regex</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="#rx_imf">rx-imf<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>rx<span class="dash">-</span>imf: <span class="tp">regex</span></span></a>)) {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a>) <span class="kw op">-></span> {
      <span class="kw">val</span> <a class="pp">day<span class="pc">day: <span class="tp">int</span></span></a>   <span class="kw">=</span> <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">2</span>)
      <span class="kw">val</span> <a class="pp">month<span class="pc">month: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="#month_from_name">month-from-name<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>month<span class="dash">-</span>from<span class="dash">-</span>name: <span class="tp sp">(</span><span class="tp tpp">mname</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>[]: <span class="tp sp">(</span><span class="tp tpp">groups</span> <span class="tp kw op">:</span> <span class="tp">groups</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="number">3</span>])<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#default">default<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>default: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<span class="number">1</span>)
      <span class="kw">val</span> <a class="pp">xyear<span class="pc">xyear: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">4</span>)
      <span class="kw">val</span> <a class="pp">hours<span class="pc">hours: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">5</span>)
      <span class="kw">val</span> <a class="pp">mins<span class="pc">mins: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">6</span>)
      <span class="kw">val</span> <a class="pp">secs<span class="pc">secs: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">7</span>)
      <span class="kw">val</span> <a class="pp">tzsign<span class="pc">tzsign: <span class="tp">int</span></span></a><span class="kw">=</span> <span class="kw">if</span> (<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="number">8</span>]<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_eq__eq__3">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><span class="st">"+"</span>) <span class="kw">then</span> <span class="number">1</span> <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_tilde_">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">1</span>
      <span class="kw">val</span> <a class="pp">tzhours<span class="pc">tzhours: <span class="tp">int</span></span></a><span class="kw">=</span> <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">9</span>) 
      <span class="kw">val</span> <a class="pp">tzmins<span class="pc">tzmins: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="#num">num<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>num: <span class="tp sp">(</span><span class="tp tpp">cap</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">,</span> <span class="tp tpp">group</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">10</span>)
      <span class="kw">val</span> <a class="pp">tzone<span class="pc">tzone: <span class="tp">timezone</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar-source.html#tz_fixed">tz-fixed<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>fixed: <span class="tp sp">(</span><span class="tp tpp">hours</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">mins</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">abbrv</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">hourwidth</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timezone</span></span></a>(<a class="pp">tzsign<span class="pc">tzsign: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">tzhours<span class="pc">tzhours: <span class="tp">int</span></span></a>, <a class="pp">tzmins<span class="pc">tzmins: <span class="tp">int</span></span></a>)
      <span class="comment">// adjust 2 digit year
</span>      <span class="kw">val</span> <a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a>  <span class="kw">=</span> <span class="kw">if</span> (<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="number">4</span>]<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#count_1">count<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>count<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">2</span>) 
                   <span class="kw">then</span> (<span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">xyear</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_lt__1">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">50</span>) <span class="kw">then</span> <span class="number">2000</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">xyear<span class="pc">xyear: <span class="tp">int</span></span></a> <span class="kw">else</span> <span class="number">1900</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">xyear<span class="pc">xyear: <span class="tp">int</span></span></a>)
                   <span class="kw">else</span> <a class="pp">xyear<span class="pc">xyear: <span class="tp">int</span></span></a>
      <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_time-source.html#time_2">time<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>time<span class="fslash last">/</span></span>time<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">day</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">hours</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">minutes</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">secs</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">timezone</span><span class="tp sp">,</span> <span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">time</span></span></a>(<a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a>,<a class="pp">month<span class="pc">month: <span class="tp">int</span></span></a>,<a class="pp">day<span class="pc">day: <span class="tp">int</span></span></a>,<a class="pp">hours<span class="pc">hours: <span class="tp">int</span></span></a>,<a class="pp">mins<span class="pc">mins: <span class="tp">int</span></span></a>,<a class="pp">secs<span class="pc">secs: <span class="tp">int</span></span></a>,tz<span class="kw">=</span><a class="pp">tzone<span class="pc">tzone: <span class="tp">timezone</span></span></a>))
    }
  }
</span>}
<span class="decl-val" id="rx_imf"><span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_parse.html#rx_imf">rx-imf<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>rx<span class="dash">-</span>imf: <span class="tp">regex</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_text_regex-source.html#regex">regex<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>regex: <span class="tp sp">(</span><span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">ignorecase</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">multiline</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">regex</span></span></a>(<span class="st">"^ &#42;(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun) &#42;, &#42;)? (\\d\\d?) &#42;(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) &#42;(\\d\\d(?:\\d\\d)?) +(\\d\\d?):(\\d\\d?)(?::(\\d\\d))? &#42;(?:([\\+\\-])(\\d\\d)(\\d\\d) &#42;)?$"</span></span>)

<span class="decl-fun" id="month_from_name"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_parse.html#month_from_name">month-from-name<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>parse<span class="fslash last">/</span></span>month<span class="dash">-</span>from<span class="dash">-</span>name: <span class="tp sp">(</span><span class="tp tpp">mname</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">mname<span class="pc">mname: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <span class="kw">val</span> <a class="pp">lname<span class="pc">lname: <span class="tp">string</span></span></a> <span class="kw">=</span> <a class="pp">mname<span class="pc">mname: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#to_lower">to-lower<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>to<span class="dash">-</span>lower: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>
  <span class="decl-fun" id="search"><span class="kw">fun</span> <a class="pp">search<span class="pc">search: <span class="tp sp">(</span><span class="tp tpp">names</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">names<span class="pc">names: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">month<span class="pc">month: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
    <span class="kw">match</span>(<a class="pp">names<span class="pc">names: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a>) {
      <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
      <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a>,<a class="pp">rest<span class="pc">rest: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a>) <span class="kw op">-></span> {
        <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">name</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#to_lower">to-lower<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>to<span class="dash">-</span>lower: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#starts_with">starts-with<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>starts<span class="dash">-</span>with: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">pre</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">sslice</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">lname<span class="pc">lname: <span class="tp">string</span></span></a>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#bool_1">bool<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>bool<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) 
         <span class="kw">then</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">month<span class="pc">month: <span class="tp">int</span></span></a>) 
         <span class="kw">else</span> <a class="pp">search<span class="pc">search: <span class="tp sp">(</span><span class="tp tpp">names</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">rest<span class="pc">rest: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a>,<a class="pp">month<span class="pc">month: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">1</span>)
      }
    }
  </span>}
  <a class="pp">search<span class="pc">search: <span class="tp sp">(</span><span class="tp tpp">names</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_locale-source.html#time_locale_en_iso">time-locale-en-iso<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>locale<span class="fslash last">/</span></span>time<span class="dash">-</span>locale<span class="dash">-</span>en<span class="dash">-</span>iso: <span class="tp">time<span class="dash">-</span>locale</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_locale-source.html#month_names">month-names<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>locale<span class="fslash last">/</span></span>month<span class="dash">-</span>names: <span class="tp sp">(</span><span class="tp">time<span class="dash">-</span>locale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a>,<span class="number">1</span>)
</span>}

</pre>

</div></body>
</html>
