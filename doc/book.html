<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta name="generator" content="Madoko, version 1.2.3" />
  <meta name="viewport" content="initial-scale=1.0" />
  <meta name="description" content="Provides an automatically expanding table-of-contents
      in a side-panel next to the main content.
      The TOC must be in a `SidePanel` block, while all
      the other content must be in a `MainPanel`." />
  <title>The Koka Programming Language</title>
  <style type="text/css"  class="link">
  /*# sourceURL=madoko.css */
  
  .madoko .toc>.tocblock .tocblock .tocblock {
    margin-left: 2.25em;
  }
  .madoko .toc>.tocblock .tocblock {
    margin-left: 1.5em;
  }
  .madoko .toc-contents>.tocblock>.tocitem {
    font-weight: bold;
  }
  .madoko .toc {
    margin-top: 1em;
  }
  .madoko p.para-continue {
    margin-bottom: 0pt;
  }
  .madoko .para-block+p {
    margin-top: 0pt;
  }
  .madoko ul.para-block, .madoko ol.para-block {
    margin-top: 0pt;
    margin-bottom: 0pt;
  }
  .madoko ul.para-end, .madoko ol.para-end {
    margin-bottom: 1em;
  }
  .madoko dl {
    margin-left: 0em;
  }
  .madoko blockquote {
    font-style: italic;
  }
  .madoko a.localref {
    text-decoration: none;
  }
  .madoko a.localref:hover {
    text-decoration: underline;
  }
  .madoko .footnotes {
    font-size: smaller;
    margin-top: 2em;
  }
  .madoko .footnotes hr {
    width: 50%;
    text-align: left;
  }
  .madoko .footnote {
    margin-left: 1em;
  }
  .madoko .footnote-before {
    margin-left: -1em;
    width: 1em;
    display: inline-block;
  }
  .madoko .align-center, .madoko .align-center>p {
    text-align: center !important;
  }
  .madoko .align-center pre {
    text-align: left;
  }
  .madoko .align-center>* {
    margin-left: auto !important;
    margin-right: auto !important;
  }
  .madoko .align-left, .madoko .align-left>p {
    text-align: left !important;
  }
  .madoko .align-left>* {
    margin-left: 0pt !important;
    margin-right: auto !important;
  }
  .madoko .align-right, .madoko .align-right>p {
    text-align: right !important;
  }
  .madoko .align-right>* {
    margin-left: auto !important;
    margin-right: 0pt !important;
  }
  .madoko .align-center>table,
  .madoko .align-left>table,
  .madoko .align-right>table {
    text-align: left !important;
  }
  .madoko .equation-before {
    float: right;
  }
  .madoko .bibitem {
    font-size: smaller;
  }
  .madoko .bibsearch {
    font-size: x-small;
    text-decoration:none;
    color: black;
    font-family: "Segoe UI Symbol", Symbola, serif;
  }
  .madoko .block, .madoko .figure, .madoko .bibitem, .madoko .equation, .madoko div.math {
    margin-top: 1ex;
    margin-bottom: 1ex;
  }
  .madoko .figure {
    padding: 0.5em;
    margin-left: 0pt;
    margin-right: 0pt;
  }
  .madoko .hidden {
    display: none;
  }
  .madoko .invisible {
    visibility: hidden;
  }
  .madoko.preview .invisible {
    visibility: visible;
    opacity: 0.5;
  }
  .madoko code.code, .madoko span.code {
    white-space: pre-wrap;
  }
  .madoko hr, hr.madoko {
    border: none;
    border-bottom: black solid 1px;
    margin-bottom: 0.5ex;
  }
  .madoko .framed>*:first-child {
    margin-top: 0pt;
  }
  .madoko .framed>*:last-child {
    margin-bottom: 0pt;
  }
  .madoko ul.list-style-type-dash {
      list-style-type: none !important;
  }
  .madoko ul.list-style-type-dash > li:before {
      content: "\2013";
      position: absolute;
      margin-left: -1em;
  }
  .madoko table.madoko {
    border-collapse: collapse;
  }
  .madoko td, .madoko th {
    padding: 0ex 0.5ex;
    margin: 0pt;
    vertical-align: top;
  }
  .madoko .cell-border-left {
    border-left: 1px solid black;
  }
  .madoko .cell-border-right {
    border-right: 1px solid black;
  }
  .madoko thead>tr:first-child>.cell-line,
  .madoko tbody:first-child>tr:first-child>.cell-line {
    border-top: 1px solid black;
    border-bottom: none;
  }
  .madoko .cell-line, .madoko .cell-double-line {
    border-bottom: 1px solid black;
    border-top: none;
  }
  .madoko .cell-double-line {
    border-top: 1px solid black;
    padding-top: 1.5px !important;
  }
  .madoko .input-mathpre .MathJax_Display {
    text-align: left !important;
  }
  .madoko div.input-mathpre {
    text-align: left;
    margin-top: 1.5ex;
    margin-bottom: 1ex;
  }
  .madoko .math-rendering {
    text-align: left;
    white-space: pre;
    color: gray;
  }
  .madoko .mathdisplay {
    text-align: center;
  }
  .madoko span.math-rendering {
    display:inline-block;
    width:8em;
    overflow-x:auto;
    font-size:70%;
  }
  .madoko span.math-rendering::-webkit-scrollbar {
    width:4px;
  }
  .madoko .pretty table {
    border-collapse: collapse;
  }
  .madoko .pretty td {
    padding: 0em;
  }
  .madoko .pretty td.empty {
    min-width: 1.5ex;
  }
  .madoko .pretty td.expander {
    width: 100em;
  }
  body.madoko, .madoko .serif {
    font-family: Cambria,"Times New Roman","Liberation Serif","Times",serif;
  }
  .madoko .sans-serif {
    font-family: "Calibri", "Optima", sans-serif;
  }
  .madoko .symbol {
    font-family: "Segoe UI Symbol", Symbola, serif;
  }
  body.madoko {
    -webkit-text-size-adjust: 100%;       
    text-rendering: optimizeLegibility;
  }
  body.madoko {
    max-width: 88ex; 
    margin: 1em auto;
    padding: 0em 2em;
  }
  body.preview.madoko {
    padding: 0em 1em;
  }
  .madoko p {
    text-align: justify;
  }
  .madoko h1, .madoko h2, .madoko h3, .madoko h4 {
    margin-top: 1.22em;
    margin-bottom: 1ex;
  }
  .madoko h1+p, .madoko h2+p, .madoko h3+p, .madoko h4+p, .madoko h5+p  {
    margin-top: 1ex;
  }
  .madoko h5, .madoko h6 {
    margin-top: 1ex;
    font-size: 1em;
  }
  .madoko h5 {
    margin-bottom: 0.5ex;
  }
  .madoko h5 + p {
    margin-top: 0.5ex;
  }
  .madoko h6 {
    margin-bottom: 0pt;
  }
  .madoko h6 + p {
    margin-top: 0pt;
  }
  .madoko pre, .madoko code, .madoko kbd, .madoko samp, .madoko tt,
  .madoko .monospace, .madoko .token-indent, .madoko .reveal pre, .madoko .reveal code, .madoko .email {
    font-family: Consolas,"Andale Mono WT","Andale Mono",Lucida Console,Monaco,monospace,monospace;
    font-size: 0.85em;
  }
  .madoko pre code, .madoko .token-indent {
    font-size: 0.95em;
  }
  .madoko pre code {
    font-family: inherit !important;
  }
  .madoko ol.linenums li {
    background-color: white;
    list-style-type: decimal;
  }
  .madoko .remote {
    background-color: #F0FFF0;
  }
  .madoko .remote + * {
    margin-top: 0pt;
  }
  @media print {
    body.madoko {
      font-size: 10pt;
    }
    @page {
      margin: 1in 1.5in;
    }
  }
  @media only screen and (max-device-width:1024px) {
    body.madoko {
      padding: 0em 0.5em;
    }
    .madoko li {
      text-align: left;
    }
  }
  
    </style>
  <style type="text/css"  class="link">
  /*# sourceURL=styles/koka.css */
  
  @import url('https://fonts.googleapis.com/css?family=Nunito:400,400italic,700,700italic');
  @import url('https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic');
  @import url('https://fonts.googleapis.com/css?family=Roboto+Slab:300,400,700');
  body.madoko,body.koka,.serif,.sans-serif,.comment {
    font-family: 'Nunito', 'Calibri', serif;
  }
  .sans-serif { 
    font-family: 'Nunito', 'Segoe UI', 'Calibri', sans-serif;
  }
  .sans-section { 
    font-family: 'Nunito', 'Century Gothic', 'Apple Gothic',  sans-serif; 
  }
  pre.koka, code.koka, .koka.doc .header {
    background-color: #f4f3f2;
  }
  @media screen {
    body.madoko,body.koka {
      max-width  : 62em;
      margin     : 1em auto;
      padding    : 0em 1em 45em 1em; 
      line-height: 1.4;    
    }
    .koka.doc p {
      text-align: left;
    }
  }
  @media screen and (max-device-width: 1022px) {
    body.madoko,body.koka {
      max-width: 100%;
      padding: 0em 0.5em 40em 0.5em;
      margin: 1em;
    }
  }
  @media screen and (min-device-width: 2048px) {
    html {
      font-size:120%;
    }
  }
  @media print {
    body {
      font-size: 9pt;
      margin: 0pt;
    }
    h2,h3,h4 { 
      page-break-after: avoid; 
    }  
    p { 
      text-align: justify;
    }
    @page:left  { margin: 8% 5% 8% 5%; }
    @page:right { margin: 8% 5% 8% 5%; }
  }
  body {
    -webkit-text-size-adjust: 100%;   
    text-size-adjust:100%;
    color: black;
  }
  h1 { 
    font-size: 150%; 
  }
  h1.mo, h1 .mo, h1 .toc-link {
    color: inherit !important;
  }
  .koka.source,
  .koka.codeblock,
  .koka.preblock, 
  code, code.koka, .koka .code, .madoko code,
  pre, pre.koka, .madoko pre,
  .monospace { 
    font-family: Consolas, "Menlo", "Andale Mono", Lucida Console, Monaco, "Roboto Mono", monospace,monospace;
  }
  .madoko pre, .madoko code, .madoko kbd, .madoko samp, .madoko tt, .madoko .monospace, .madoko .token-indent, .madoko .reveal pre, .madoko .reveal code, .madoko .email {
    font-size: 0.95em;
  }
  .koka .code {   
    xfont-size: 90%;        
  }
  code, code.koka, .koka .code, .madoko code { 
    border-radius: 4px;
    padding: 0pt 0.2ex;
  }
  pre code code, .madoko pre code code {
    xfont-size: 1em;
  }
  .koka.codeblock,
  .koka.preblock { 
    padding: 0.5ex 1ex 0.5ex 1ex;
  }
  .koka.source  { 
    padding: 0.5ex 1em 0.5ex 1em;
  }
  .koka.source.unchecked {
  }
  .koka.source-body .source {
    margin-right: 1ex;
  }
  .koka .dash { 
    margin-left: -0.25ex; margin-right: -0.25ex
  }
  .koka .minus {
    font-weight: bold;
  }
  .koka .fslash {
    font-size: 90%;  
  }
  .koka .fslash .last {
    margin-right: 0.5ex;
  }
  .koka .postfix { 
    color: gray 
  }
  .koka.source,
  .koka.codeblock,
  .koka.preblock,
  .koka.code, code,
  .koka.pre, pre { 
    xwhite-space: pre-wrap;
    overflow-x: auto;
  }
  pre.koka.source {
    border: 1px solid #CCC;
  }
  .madoko pre.koka.source {
    xfont-size: 0.9em;
  }
  .koka.doc .comment p {
    margin: 0pt;
    margin-bottom: 0.25ex;
  }
  .plaincode  { 
    display: none;
    white-space: pre-wrap;
  }
  .koka.source a:hover,
  .koka.code a:hover, code.koka a:hover
  .koka.pre a:hover, pre.koka a:hover { 
    text-decoration: none 
  }
  .koka .type, .koka .tp          { color: teal }
  .koka .keyword, .koka .kw       { color: blue }     
  .koka .string, .koka .st        { color: maroon }
  .koka .module, .koka .mo        { color: navy }
  .koka .number, .koka .nu        { color: black }
  .koka .constructor, .koka .co   {  color: purple }
  .koka .namespace, .koka .mo     { color: navy }
  .koka .comment                  { color: green }
  .koka .type.typeparam, .koka .tp.tpp { color: #555 }
  .koka .type.typevar, .koka .tp.tv    { font-style: italic }
  .koka .type.keyword.operator, .koka .tp.kw.op { color: teal }
  .koka.emph {
    font-style: italic;
    color: black;
  }
  .koka.preblock,     
  .koka.codeblock
        { display: block 
        ; margin-top: 1ex
        ; margin-bottom: 1ex
        }
  .koka.line
        { display: block
        ; border-bottom: 1px dotted
        ; margin-top: 3px
        ; width: 75%
        }
  .koka .error, 
  .koka .warning { 
    border-bottom: dotted;
    border-width: 2px;
  }
  .koka .error    { border-color: red }
  .koka .warning  { border-color: teal }
  .koka .decl.type,
  .koka .decl.cotype,
  .koka .decl.rectype,
  .koka .decl.fun,
  .koka .decl.val,
  .koka .decl.external { 
  }
  .koka .decl.alias,
  .koka .decl.alias .koka .keywordop { 
    color: teal 
  }
  a.pp    { 
    position: relative;
    text-decoration: none;
    color: black;
  }
  .pc { 
    display: none;
  }
  a.pp:hover  { 
    z-index: 100;
    text-decoration: none;
  }
  a.pp:hover .pc, .tooltip { 
    display:block;
    position:absolute;
    top:1.5em;
    left:2ex;
    padding: 0.2ex 0.75ex 0.2ex 0.5ex;
    border:1px solid black;
    background: #fffdf0;   
    white-space: pre;
  }
  a.pp a.pp:hover .pc
    { top: 3em }
  .koka.doc>pre.source {
    border: 1px solid #CCC;
  }
  h1.koka.module
        { font-weight: normal
        }
  .koka .toc-link 
        { font-size: 75%
        ; float: right
        ; color: navy
        }
  .koka.doc .header
        { padding: 0.25ex
        ; padding-left: 0.5ex
        ; margin-top: 0px
        ; margin-bottom: 0.5em
        }
  .koka.doc .link 
        { text-decoration: none
        ; color: black
        }
  .koka.doc .doc.comment
        { color: black;
        }
  .koka.doc .decl .decl
        { margin-left: 1em 
        }
  .koka.doc .decl .comment
        { margin: 0em 0em 0em 1em }
  .koka.doc.body>.comment
        { margin-bottom: 1em }
  .koka.doc .decl, 
  .koka.doc .con-decl
        { margin-top: 1.2em
        ; border: 1px solid #AAA
        ; border-width: 1px 0px 0px 1px
        }
  .koka.doc .synopsis {
    font-size: 150%;
    margin-top: -0.5em;
    margin-bottom: 0.25em;
  }  
  div.nested { 
    margin: 1.25em 0em 1.25em 1em 
  }
  .koka.doc .nested .decl
        { margin-left: 0em }  
  .koka.doc .con-decl
        { 
        ; margin-left: 1em
        ; margin-top: 0.5em
        ; margin-bottom: 0.5em
        }
  .koka.doc ul.toc 
        { list-style-type: none
        ; margin: 0em
        ; float: left;
        ; clear: none;
        ; padding: 0.5ex 2em 1ex 0.5ex
        ; white-space: nowrap
        ; border-bottom: 1px solid #AAA
        }
  .koka.doc ul.toc li.nested
        { padding-left: 1em
        }
  .koka.doc div.toc 
        { overflow: auto
        ; width: 100%
        }
  .koka.doc div.toc+.doc {
    margin: 1em 0em;
    padding: 1em 0em;
  }
  .koka table.index {
    border: 1px solid #AAA;
  }
  .koka.doc table.index td {
    vertical-align: top;
    padding-right: 2.5em;
    padding-bottom: 0.5ex;
  }
  .koka.doc table.index .nested1 {
    margin-left: 2em;
  }
  .koka.doc table.index .nested2 {
    margin-left: 3em;
  }
  .koka.doc table.index .nested3 {
    margin-left: 4em;
  }
  
    </style>
  <style type="text/css"  class="link">
  /*# sourceURL=styles/book.css */
  .tocitem {
    font-weight: normal;
  }
  .koka.source, .madoko .koka.source {
  }
  .madoko .koka.source:not(.unchecked)::before {
    float: right;
    margin-right: -1ex;
  	margin-top: -1.4ex;
    color: #999;
    padding: 0ex 0ex 0ex 0.2ex;  
    content: "checked";
    font-family: Nunito;
    font-size: x-small;
  }
  body.madoko {
    margin: 0em !important;
  }
  code, .madoko code,
  pre, .madoko pre,
  .koka.source.unchecked,
  .sidepanel {
    background-color: #f4f3f2;
  }
  pre, .madoko pre,
  pre.koka.source,
  .koka.source,
  .koka.source.unchecked {
    border: none;
    padding: 0.5ex 1ex 0.5ex 1ex;
  }
  body,pre,.sidepanel,.news-items {
    scrollbar-width: thin;
  }
  ::-webkit-scrollbar {
    height: 8px;
    width: 8px;
  }
  ::-webkit-scrollbar-thumb {
    background-color: #ccc;
  }
  ::-webkit-scrollbar-track {
    -webkit-box-shadow: inset 0 0 4px rgba(0,0,0,0.3); 
  }
  code, .madoko code {
    padding-right: 0.2ex;
  }
  .button code, .button code span {
    background-color: inherit !important;
    color: inherit !important;
  }
  .grammar table,
  table.grammar  {   
    margin: 0.5ex 0.5ex 0.5ex 2ex;
    padding: 0.5ex 1ex 0.5ex 1ex;
  }
  .grammar .code,
  .grammar code {
    padding: 0pt;
  }
  .grammar .bar {
    padding: 0ex 0.5ex;
  }
  .grammar td:nth-child(2) {
    font-style: normal; 
    padding: 0em 1ex;
    text-align: center;
  }
  .grammar td:nth-child(4) {
    font-style: normal; 
    padding-left: 2ex;
  }
  .grammar td {
    white-space: nowrap;
  }
  .grammar .code, .grammar code,
  .grammar .pre, .grammar pre {
    font-weight: bold;
  }
  table .kw, table .tp, table .co,
  .grammar .keyword, .grammar .kw,
  .grammar .type, .grammar .tp,
  .grammar .constructor, .grammar .co {
    color: black;
  }
  .nt {
    font-style: italic;
  }          
  .opt, .many {   
    padding: 0ex 0.5ex;
  }
  #toc {
    display: none;
  }
  #toc-toggle {
    cursor: pointer;
    vertical-align: center;
    margin-right: 10px;
    font-size: 16pt;
  }
  .button {  
    display: inline-block;
    border: 1px solid #AAA;
    margin: 0ex 1ex 1ex 0ex;
    padding: 1ex;  
    transition: all 0.25s;
    cursor: pointer;
    margin-top: 0ex;  
    border-radius: 1ex;
  }
  .button, .translate {
    background-color: #fffdf0;
  }
  .button:hover {
    background-color: #b9dae8 !important;  
  }
  a.button, .button a {
    text-decoration: none !important;
  }
  .translate .koka.source.unchecked, .translate pre {
  }
  .translate pre {
    margin: 0.5em 0em;
  }
  .aside {
    float: right;
    width: 50%;
    margin: 0em 0em 1ex 2em;
  }
  pre.lang-cpp::before {
    content: "C++";
    float: right;
    margin-right: -0.5ex;
  	color: #999;
  	border: 1px solid #AAA;
    padding: 0ex 0.2ex;  
  }
  html {
    scroll-behavior: smooth;
  }
  .fa-external-link {
    font-size: 75% !important;
    padding-left: 0.75ex;
  }
  .translate-row {
    display: flex;
  }
  .madoka h2, .madoko h3, .madoko h4 {
    margin-top: 2em;
  }
  .madoko h3 {
    font-size: 130%;
  }
  .madoko h4 {
    font-size: 110%;
  }
  .banners {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
  }
  .banners .banner {
    width: calc(50% - 1.5em);
    min-width: 20em;
    margin-bottom: 1em;
  }
  .banner p {
    margin: 1ex 0ex;
  }
  .banner-caption {
  	display: block;
  	margin: 0pt auto 0.5ex 0pt;
  	font-weight: bold;
    text-align: center;
  }
  .banner .button {
  	text-align: center;
  	display: block;
  	margin: 0pt;
  }
  .colored .wide, .colored .sidepanel {
    background-color: #1b4253;
  }
  .colored .button {
    background-color:#215166;
  }
  .grad.colored .wide, .grad.colored .sidepanel {
    background: linear-gradient(#1b4253,#286179);
  }
  .colored .sidepanel, .colored .sidepanel a, .colored a.button, .colored .button a, .colored .button .fa {
    color: #e8e8e8 !important;
  }
  .colored .sidepanel .current a {
    color: white !important;
  }
  .colored .button {
    border:none;
  }
  .colored .button:hover {
    background-color: #2e708d !important;  
  }
  .penrose.colored .wide, .penrose.colored .sidepanel {
    background: url(images/penrose-tiling.png);
  }
  .fa-angle-double-down {
    vertical-align: -0.1ex;
  }
  .news-items {
  	height: 7em;
  	overflow-y: auto;
  	padding-top: 1ex;
    margin-top: -1em;
    font-size: larger;
  }
  .advanced h3, .advanced h4 {
    margin-top: 0em;
  }
  .tooltip-copied {
    position: relative;
  }
  .tooltip-copied::after, .tooltip-copied::before {
    position: absolute;
    z-index: 1000;
    pointer-events:none;   
    animation: tooltip-appear;
    animation-duration: 0.1s;
    animation-timing-function: ease-in;
  }
  .tooltip-copied::after {
    top: 100%;
    right: -50%;
    margin-top:7px;
    text-align: center;
    content: attr(data-tooltip);
    border-radius:5px;
    padding: 1ex;
    background-color: #215166;
    color: #e8e8e8;
  }
  .tooltip-copied::before {
    width:0;
    height:0;
    content:"";
    top:auto;
    right: 0%;
    bottom: -7px;
    margin-right: 7px;
    border: 7px solid transparent;  
    border-bottom-color:#215166;
  }
  @keyframes tooltip-appear {
    from { opacity: 0; }
    to   { opacity: 1; }
  }
    </style>
  <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"  class="link">
  <script  class="script">// ---------------------------------------------------
  // grammar
  // ---------------------------------------------------
  
  function genFullGrammar() {
    var fullLex = "";
    var fullParse = "";
    var divLex = document.getElementById("full-lexical");
    var divGrammar = document.getElementById("full-grammar");
    if (!divLex || !divGrammar) return; 
  
    var gs = document.getElementsByClassName("grammar");
    for(var i = 0; i < gs.length; i++) {
      var elem = gs[i];
      if (elem.tagName.toLowerCase() != "table") continue;
      if (elem.className.indexOf("lex") >= 0) fullLex += elem.innerHTML;
      else if (elem.className.indexOf("parse") >= 0) fullParse += elem.innerHTML;
    }
    divLex.innerHTML="<table class='grammar'>\n"+ fullLex + "</table>"; 
    divGrammar.innerHTML="<table class='grammar'>\n" + fullParse + "</table>";
  }
  
  // ---------------------------------------------------
  // external link symbol
  // ---------------------------------------------------
  
  function addExternalLinkIcons() {
    const locals = document.querySelectorAll("a:not(.localref)");
    const currentUrl = window.location.href.replace(/#.*$/,"");
    locals.forEach( function(link){
      const child = link.firstElementChild;
      const ctag = (child==null ? "" : child.tagName);
      const linkUrl = link.href.replace(/#.*$/,"");
      if (linkUrl != currentUrl && link.className.indexOf("bib") < 0 && ctag != "IMG" && ctag != "SPAN") {  // no bib, image or code links
        link.innerHTML = link.innerHTML + "<i class=\"fa fa-external-link\"></i>";
      }
    });
  }
  
  // ---------------------------------------------------
  // copy button
  // ---------------------------------------------------
  
  function addClass(elem,cls) {
    elem.className = elem.className + " " + cls;
  }
  
  function removeClass(elem,cls) {
    elem.className = elem.className.split(/\s+/).filter( function(c){ return (c != cls); } ).join(" ");
  }
  
  function removeCopiedTooltip( target ) {
    removeClass(target,"tooltip-copied");
    target.setAttribute("title","Copy");  
  }
  
  function addCopiedTooltip(target,ok) {
    target.setAttribute("data-tooltip",ok ? "Copied!" : "Failed to copy!" );
    addClass(target,"tooltip-copied");
    target.setAttribute("title","");
    setTimeout( function(){ removeCopiedTooltip(target); }, 2000 );
  }
  
  
  function commandCopyToClipboard(text) {
    // use hidden text element to select and copy
    const elem = document.createElement('textarea');  
    elem.style.fontSize = '12pt';
    elem.style.border = '0';
    elem.style.padding = '0';
    elem.style.margin = '0';
    elem.style.position = 'absolute';
    const isRtl = document.documentElement.getAttribute('dir') === 'rtl';
    elem.style[isRtl ? 'right' : 'left'] = '-10000px';
    let ypos = window.pageYOffset || document.documentElement.scrollTop;
    elem.style.top = "" + ypos + "px";    
    elem.setAttribute('readonly', '');
    elem.value = text;
    document.body.appendChild(elem);
    
    // select and copy
    elem.focus();
    elem.select();
    var ok;
    try {
      ok = document.execCommand("copy");
    }
    catch(exn) {
      ok = false;
    }
    elem.remove();
    return ok;
  }  
  
  function copyToClipboard( event ) {
    const target = event.delegateTarget || event.currentTarget;
    const text = target.getAttribute( "data-value" );
    if (!text) return;
  
    if (navigator.clipboard) {
      navigator.clipboard.writeText(text).then( function(){
        addCopiedTooltip(target,true);
      }, function(err) {
        const ok = commandCopyToClipboard(text);
        addCopiedTooltip(target,ok);      
      });
    }
    else {
      const ok = commandCopyToClipboard(text);
      addCopiedTooltip(target,ok);
    }
  }
   
  function enableCopyButtons() {
    const buttons = document.querySelectorAll(".copy.button");
    buttons.forEach( function(button){
      button.addEventListener("click", copyToClipboard);
      /*
      button.addEventListener("mouseleave", function(event) {
        const target = event.delegateTarget || event.currentTarget;
        removeCopiedTooltip(target); 
      });
      */
    });
  }
  
  // ---------------------------------------------------
  // onload
  // ---------------------------------------------------
  
  window.onload = function() {   
    genFullGrammar();  
    addExternalLinkIcons();
    enableCopyButtons();
  }
  
  //# sourceURL=scripts/book.js
  </script>
  
  <style>
    h0:hover .entity-anchor,
        h1:hover .entity-anchor,
        h2:hover .entity-anchor,
        h3:hover .entity-anchor {
          display: inline-block;
        }
        
        a.entity-anchor {
          color: black;
        }
        
        a.localref.entity-anchor:hover {
          text-decoration: none;
        }
        
        .entity-anchor {
          display: none;
          width: 1.5em;
          margin: 0pt;
          margin-left: -1.5em;
          xfont-family: "Segoe UI Symbol", Symbola, serif;
          font-size: 75% !important;
        }
    /* ---------------------------------------------
          Center document in the viewport
        ----------------------------------------------*/
        body.madoko {
          margin: 0pt;
          padding: 0pt;
          max-width: 100%;
        }
        .body {
          margin: 1em;
        }    
        .maincontent, .mainheader {
          margin: 0pt auto;
        }    
        .preview .maincontent {
          width: 98%;
          max-width: 100%;
          margin: 0.25em auto;
        }
        .tocblock2, .tocblock3 {
          display:none;
        }
        .tocblock.click-expands {
          display:block;
        }
        .expand-all .tocblock1, .expand-all .tocblock2 {
          display:block;
        }
        span.unexpanded, span.expanded {
          display: inline-block;
          width: 1em;
          margin-left: -1em;
          font-family: FontAwesome;
          cursor: pointer;
          text-align: center;
        }
        span.unexpanded::before {
          content: "\25B6";  /* triangle */
          content: "\F0DA";  /* thick caret */      
          content: "\F105";  /* caret */
        }
        .expand-all span.expanded, span.expanded::before {
          content: "\25BC";  /* triangle */
          content: "\F0D7";  /* thick caret */
          content: "\F107";  /* caret */
        }
        
        /* -----------------------------------------
           Settings for a wide viewport:
           The contents are shown in the side panel
           on the left side.
        -------------------------------------------- */    
        @media screen and (min-width: 1024px) {
          .maincontent {
            width: 60em;
            max-width: 100%;
          }
          .body {
            margin: 0pt;
          }
          .sidepanel {
            float     : right;
            width     : 20rem ; 
            position  : fixed;
            top       : 0rem ;
            height    : 100%;
            max-height: 100%;
            overflow-y: auto;
            border-right: 1px solid #AAA;          
          }
          .mainpanel, .footnotes, .mainheader {
            margin-left: calc(20rem + 6rem + 2px + 1rem);
            margin-right: 10%;
          }            
          .mainheader {
            padding-top: 2em;
          }
          .tocblock.auto-expands {
            display: block;
          }
          .tocitem.current {
            font-weight: bold;
          }            
        }
        
        /* ---------------------------------------------------
           Set margins and padding for side panel and sections
        ------------------------------------------------------ */
        .sidepanel, .mainpanel section, .footnotes {
          padding: 0rem 1rem 0rem 3rem;
        }
        .sidepanel .tocblock {
          font-size  : 95%;
          white-space: nowrap;
        }
        .sidepanel .toc, .sidepanel h2, .sidepanel h1 {
          margin-top: 0pt;
        }
        .footnotes {
          padding-top: 0.5em; 
        }
        .footnotes>hr {
          display:none;
        }
        section,.sidepanel {
          margin-bottom: 1em;
        }
        
        /* -----------------------------------
           Nice scrollbar for toc
        ----------------------------------- */
        .xsidepanel::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }     
        /* Track */
        .xsidepanel::-webkit-scrollbar-track {
            -webkit-box-shadow: inset 0 0 4px rgba(0,0,0,0.3); 
            -webkit-border-radius: 6px;
            border-radius: 6px;
        }    
        /* Handle */
        .xsidepanel::-webkit-scrollbar-thumb {
            -webkit-border-radius: 6px;
            border-radius: 6px;
            background: lightgray; 
            -webkit-box-shadow: inset 0 0 4px rgba(0,0,0,0.5); 
        }
        .xsidepanel::-webkit-scrollbar-thumb:window-inactive {
          background: gainsboro; 
        }
        .madoko .toc > .tocblock .tocblock .tocblock {
          margin-left: 1.5em;
        }
        .madoko .toc a {
          color: #444; 
        }
  </style>
  </head>
<body class="madoko">

<div class="body madoko colored" style="line-adjust:0">

<div class="mainheader">

<div class="titleblock align-center para-block" style="text-align:center;line-adjust:0">
<div class="titleheader align-center" style="text-align:center;line-adjust:0">
<div class="title para-block" style="font-weight:bold;margin-bottom:0.5ex;font-size:xxx-large;line-adjust:0">The Koka Programming Language</div>
<div class="titlenote para-block" style="line-adjust:0"><span style="font-size:75%">(Daan Leijen, 2021-08-25)</span></div></div></div></div>
<div class="flexbody">

<div class="sidepanel">

<p class="p noindent"><a href="https://github.com/koka-lang/koka"><img src="images/koka-logo-filled.png" alt="koka-logo" data-path="images/koka-logo-filled.png" data-linkid="koka-logo" style="max-height:120px;padding:1rem 1rem 1rem 1.5rem"></a>
</p><span data-line=""></span>
<nav class="toc toc-contents expand-all" style="font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">
<div class="tocblock tocblock1">
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="getstarted" data-toc-depth="1" data-toc-line="[1]{.heading-label}.&#8194;Getting started" style="toctarget:getstarted"><a href="#getstarted" class="localref"><span class="heading-label">1</span>.&#8194;Getting started</a></div>
<div class="tocblock tocblock2">
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="install" data-toc-depth="2" data-toc-line="[1.1]{.heading-label}.&#8194;Installing the compiler" style="toctarget:install"><a href="#install" class="localref"><span class="heading-label">1.1</span>.&#8194;Installing the compiler</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-running-the-compiler" data-toc-depth="2" data-toc-line="[1.2]{.heading-label}.&#8194;Running the compiler" style="toctarget:sec-running-the-compiler"><a href="#sec-running-the-compiler" class="localref"><span class="heading-label">1.2</span>.&#8194;Running the compiler</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-running-the-interactive-compiler" data-toc-depth="2" data-toc-line="[1.3]{.heading-label}.&#8194;Running the interactive compiler" style="toctarget:sec-running-the-interactive-compiler"><a href="#sec-running-the-interactive-compiler" class="localref"><span class="heading-label">1.3</span>.&#8194;Running the interactive compiler</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-samples-and-editors" data-toc-depth="2" data-toc-line="[1.4]{.heading-label}.&#8194;Samples and Editors" style="toctarget:sec-samples-and-editors"><a href="#sec-samples-and-editors" class="localref"><span class="heading-label">1.4</span>.&#8194;Samples and Editors</a></div></div>
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="why" data-toc-depth="1" data-toc-line="[2]{.heading-label}.&#8194;Why Koka?" style="toctarget:why"><a href="#why" class="localref"><span class="heading-label">2</span>.&#8194;Why Koka?</a></div>
<div class="tocblock tocblock2">
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="why-mingen" data-toc-depth="2" data-toc-line="[2.1]{.heading-label}.&#8194;Minimal but General" style="toctarget:why-mingen"><a href="#why-mingen" class="localref"><span class="heading-label">2.1</span>.&#8194;Minimal but General</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="why-effects" data-toc-depth="2" data-toc-line="[2.2]{.heading-label}.&#8194;Effect Typing" style="toctarget:why-effects"><a href="#why-effects" class="localref"><span class="heading-label">2.2</span>.&#8194;Effect Typing</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="why-handlers" data-toc-depth="2" data-toc-line="[2.3]{.heading-label}.&#8194;Effect Handlers" style="toctarget:why-handlers"><a href="#why-handlers" class="localref"><span class="heading-label">2.3</span>.&#8194;Effect Handlers</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="why-perceus" data-toc-depth="2" data-toc-line="[2.4]{.heading-label}.&#8194;Perceus Optimized Reference Counting" style="toctarget:why-perceus"><a href="#why-perceus" class="localref"><span class="heading-label">2.4</span>.&#8194;Perceus Optimized Reference Counting</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="why-fbip" data-toc-depth="2" data-toc-line="[2.5]{.heading-label}.&#8194;Reuse Analysis" style="toctarget:why-fbip"><a href="#why-fbip" class="localref"><span class="heading-label">2.5</span>.&#8194;Reuse Analysis</a></div></div>
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="tour" data-toc-depth="1" data-toc-line="[3]{.heading-label}.&#8194;A Tour of Koka" style="toctarget:tour"><a href="#tour" class="localref"><span class="heading-label">3</span>.&#8194;A Tour of Koka</a></div>
<div class="tocblock tocblock2">
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-basics" data-toc-depth="2" data-toc-line="[3.1]{.heading-label}.&#8194;Basics" style="toctarget:sec-basics"><a href="#sec-basics" class="localref"><span class="heading-label">3.1</span>.&#8194;Basics</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-hello-world" data-toc-depth="3" data-toc-line="[3.1.1]{.heading-label}.&#8194;Hello world" style="toctarget:sec-hello-world"><a href="#sec-hello-world" class="localref"><span class="heading-label">3.1.1</span>.&#8194;Hello world</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-dot" data-toc-depth="3" data-toc-line="[3.1.2]{.heading-label}.&#8194;Dot selection" style="toctarget:sec-dot"><a href="#sec-dot" class="localref"><span class="heading-label">3.1.2</span>.&#8194;Dot selection</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-type-inference" data-toc-depth="3" data-toc-line="[3.1.3]{.heading-label}.&#8194;Type Inference" style="toctarget:sec-type-inference"><a href="#sec-type-inference" class="localref"><span class="heading-label">3.1.3</span>.&#8194;Type Inference</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-anon" data-toc-depth="3" data-toc-line="[3.1.4]{.heading-label}.&#8194;Anonymous Functions and Trailing Lambdas" style="toctarget:sec-anon"><a href="#sec-anon" class="localref"><span class="heading-label">3.1.4</span>.&#8194;Anonymous Functions and Trailing Lambdas</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-with" data-toc-depth="3" data-toc-line="[3.1.5]{.heading-label}.&#8194;With Statements" style="toctarget:sec-with"><a href="#sec-with" class="localref"><span class="heading-label">3.1.5</span>.&#8194;With Statements</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-default" data-toc-depth="3" data-toc-line="[3.1.6]{.heading-label}.&#8194;Optional and Named Parameters" style="toctarget:sec-default"><a href="#sec-default" class="localref"><span class="heading-label">3.1.6</span>.&#8194;Optional and Named Parameters</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-a-larger-example--cracking-caesar-encoding" data-toc-depth="3" data-toc-line="[3.1.7]{.heading-label}.&#8194;A larger example: cracking Caesar encoding" style="toctarget:sec-a-larger-example--cracking-caesar-encoding"><a href="#sec-a-larger-example--cracking-caesar-encoding" class="localref"><span class="heading-label">3.1.7</span>.&#8194;A larger example: cracking Caesar encoding</a></div></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-effect-types" data-toc-depth="2" data-toc-line="[3.2]{.heading-label}.&#8194;Effect types" style="toctarget:sec-effect-types"><a href="#sec-effect-types" class="localref"><span class="heading-label">3.2</span>.&#8194;Effect types</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-semantics-of-effects" data-toc-depth="3" data-toc-line="[3.2.1]{.heading-label}.&#8194;Semantics of effects" style="toctarget:sec-semantics-of-effects"><a href="#sec-semantics-of-effects" class="localref"><span class="heading-label">3.2.1</span>.&#8194;Semantics of effects</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-combining-effects" data-toc-depth="3" data-toc-line="[3.2.2]{.heading-label}.&#8194;Combining effects" style="toctarget:sec-combining-effects"><a href="#sec-combining-effects" class="localref"><span class="heading-label">3.2.2</span>.&#8194;Combining effects</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-polymorphic-effects" data-toc-depth="3" data-toc-line="[3.2.3]{.heading-label}.&#8194;Polymorphic effects" style="toctarget:sec-polymorphic-effects"><a href="#sec-polymorphic-effects" class="localref"><span class="heading-label">3.2.3</span>.&#8194;Polymorphic effects</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-var" data-toc-depth="3" data-toc-line="[3.2.4]{.heading-label}.&#8194;Local Mutable Variables" style="toctarget:sec-var"><a href="#sec-var" class="localref"><span class="heading-label">3.2.4</span>.&#8194;Local Mutable Variables</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-runst" data-toc-depth="3" data-toc-line="[3.2.5]{.heading-label}.&#8194;Reference Cells and Isolated state" style="toctarget:sec-runst"><a href="#sec-runst" class="localref"><span class="heading-label">3.2.5</span>.&#8194;Reference Cells and Isolated state</a></div></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-data-types" data-toc-depth="2" data-toc-line="[3.3]{.heading-label}.&#8194;Data Types" style="toctarget:sec-data-types"><a href="#sec-data-types" class="localref"><span class="heading-label">3.3</span>.&#8194;Data Types</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-structs" data-toc-depth="3" data-toc-line="[3.3.1]{.heading-label}.&#8194;Structs" style="toctarget:sec-structs"><a href="#sec-structs" class="localref"><span class="heading-label">3.3.1</span>.&#8194;Structs</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-copying" data-toc-depth="3" data-toc-line="[3.3.2]{.heading-label}.&#8194;Copying" style="toctarget:sec-copying"><a href="#sec-copying" class="localref"><span class="heading-label">3.3.2</span>.&#8194;Copying</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-union" data-toc-depth="3" data-toc-line="[3.3.3]{.heading-label}.&#8194;Alternatives (or Unions)" style="toctarget:sec-union"><a href="#sec-union" class="localref"><span class="heading-label">3.3.3</span>.&#8194;Alternatives (or Unions)</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-matching" data-toc-depth="3" data-toc-line="[3.3.4]{.heading-label}.&#8194;Matching" style="toctarget:sec-matching"><a href="#sec-matching" class="localref"><span class="heading-label">3.3.4</span>.&#8194;Matching</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-extensible-data-types" data-toc-depth="3" data-toc-line="[3.3.5]{.heading-label}.&#8194;Extensible Data Types" style="toctarget:sec-extensible-data-types"><a href="#sec-extensible-data-types" class="localref"><span class="heading-label">3.3.5</span>.&#8194;Extensible Data Types</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-inductive-co-inductive-and-recursive-types" data-toc-depth="3" data-toc-line="[3.3.6]{.heading-label}.&#8194;Inductive, Co-inductive, and Recursive Types" style="toctarget:sec-inductive-co-inductive-and-recursive-types"><a href="#sec-inductive-co-inductive-and-recursive-types" class="localref"><span class="heading-label">3.3.6</span>.&#8194;Inductive, Co-inductive, and Recursive Types</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-value-types" data-toc-depth="3" data-toc-line="[3.3.7]{.heading-label}.&#8194;Value Types" style="toctarget:sec-value-types"><a href="#sec-value-types" class="localref"><span class="heading-label">3.3.7</span>.&#8194;Value Types</a></div></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-handlers" data-toc-depth="2" data-toc-line="[3.4]{.heading-label}.&#8194;Effect Handlers" style="toctarget:sec-handlers"><a href="#sec-handlers" class="localref"><span class="heading-label">3.4</span>.&#8194;Effect Handlers</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-handling" data-toc-depth="3" data-toc-line="[3.4.1]{.heading-label}.&#8194;Handling" style="toctarget:sec-handling"><a href="#sec-handling" class="localref"><span class="heading-label">3.4.1</span>.&#8194;Handling</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-resume" data-toc-depth="3" data-toc-line="[3.4.2]{.heading-label}.&#8194;Resuming" style="toctarget:sec-resume"><a href="#sec-resume" class="localref"><span class="heading-label">3.4.2</span>.&#8194;Resuming</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-opfun" data-toc-depth="3" data-toc-line="[3.4.3]{.heading-label}.&#8194;Tail-Resumptive Operations" style="toctarget:sec-opfun"><a href="#sec-opfun" class="localref"><span class="heading-label">3.4.3</span>.&#8194;Tail-Resumptive Operations</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-abstracting-handlers" data-toc-depth="3" data-toc-line="[3.4.4]{.heading-label}.&#8194;Abstracting Handlers" style="toctarget:sec-abstracting-handlers"><a href="#sec-abstracting-handlers" class="localref"><span class="heading-label">3.4.4</span>.&#8194;Abstracting Handlers</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-return" data-toc-depth="3" data-toc-line="[3.4.5]{.heading-label}.&#8194;Return Operations" style="toctarget:sec-return"><a href="#sec-return" class="localref"><span class="heading-label">3.4.5</span>.&#8194;Return Operations</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-combine" data-toc-depth="3" data-toc-line="[3.4.6]{.heading-label}.&#8194;Combining Handlers" style="toctarget:sec-combine"><a href="#sec-combine" class="localref"><span class="heading-label">3.4.6</span>.&#8194;Combining Handlers</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-mask" data-toc-depth="3" data-toc-line="[3.4.7]{.heading-label}.&#8194;Masking Effects" style="toctarget:sec-mask"><a href="#sec-mask" class="localref"><span class="heading-label">3.4.7</span>.&#8194;Masking Effects</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-overriding-handlers" data-toc-depth="3" data-toc-line="[3.4.8]{.heading-label}.&#8194;Overriding Handlers" style="toctarget:sec-overriding-handlers"><a href="#sec-overriding-handlers" class="localref"><span class="heading-label">3.4.8</span>.&#8194;Overriding Handlers</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-isolate" data-toc-depth="3" data-toc-line="[3.4.9]{.heading-label}.&#8194;Side-effect Isolation" style="toctarget:sec-isolate"><a href="#sec-isolate" class="localref"><span class="heading-label">3.4.9</span>.&#8194;Side-effect Isolation</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-multi-resume" data-toc-depth="3" data-toc-line="[3.4.10]{.heading-label}.&#8194;Resuming more than once" style="toctarget:sec-multi-resume"><a href="#sec-multi-resume" class="localref"><span class="heading-label">3.4.10</span>.&#8194;Resuming more than once</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-resource" data-toc-depth="3" data-toc-line="[3.4.11]{.heading-label}.&#8194;Initially and Finally" style="toctarget:sec-resource"><a href="#sec-resource" class="localref"><span class="heading-label">3.4.11</span>.&#8194;Initially and Finally</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-linear" data-toc-depth="3" data-toc-line="[3.4.12]{.heading-label}.&#8194;Linear Effects" style="toctarget:sec-linear"><a href="#sec-linear" class="localref"><span class="heading-label">3.4.12</span>.&#8194;Linear Effects</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-namedh" data-toc-depth="3" data-toc-line="[3.4.13]{.heading-label}.&#8194;Named and Scoped Handlers" style="toctarget:sec-namedh"><a href="#sec-namedh" class="localref"><span class="heading-label">3.4.13</span>.&#8194;Named and Scoped Handlers</a></div></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-fbip" data-toc-depth="2" data-toc-line="[3.5]{.heading-label}.&#8194;FBIP: Functional but In-Place" style="toctarget:sec-fbip"><a href="#sec-fbip" class="localref"><span class="heading-label">3.5</span>.&#8194;FBIP: Functional but In-Place</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-tree-rebalancing" data-toc-depth="3" data-toc-line="[3.5.1]{.heading-label}.&#8194;Tree Rebalancing" style="toctarget:sec-tree-rebalancing"><a href="#sec-tree-rebalancing" class="localref"><span class="heading-label">3.5.1</span>.&#8194;Tree Rebalancing</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-morris-traversal" data-toc-depth="3" data-toc-line="[3.5.2]{.heading-label}.&#8194;Morris Traversal" style="toctarget:sec-morris-traversal"><a href="#sec-morris-traversal" class="localref"><span class="heading-label">3.5.2</span>.&#8194;Morris Traversal</a></div></div></div>
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="sec-koka-language-specification" data-toc-depth="1" data-toc-line="[4]{.heading-label}.&#8194;Koka language specification" style="toctarget:sec-koka-language-specification"><a href="#sec-koka-language-specification" class="localref"><span class="heading-label">4</span>.&#8194;Koka language specification</a></div>
<div class="tocblock tocblock2">
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-lexical-syntax" data-toc-depth="2" data-toc-line="[4.1]{.heading-label}.&#8194;Lexical syntax" style="toctarget:sec-lexical-syntax"><a href="#sec-lexical-syntax" class="localref"><span class="heading-label">4.1</span>.&#8194;Lexical syntax</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-source-code" data-toc-depth="3" data-toc-line="[4.1.1]{.heading-label}.&#8194;Source code" style="toctarget:sec-source-code"><a href="#sec-source-code" class="localref"><span class="heading-label">4.1.1</span>.&#8194;Source code</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-encoding" data-toc-depth="3" data-toc-line="[4.1.2]{.heading-label}.&#8194;Encoding" style="toctarget:sec-encoding"><a href="#sec-encoding" class="localref"><span class="heading-label">4.1.2</span>.&#8194;Encoding</a></div></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-lexical-grammar" data-toc-depth="2" data-toc-line="[4.2]{.heading-label}.&#8194;Lexical grammar" style="toctarget:sec-lexical-grammar"><a href="#sec-lexical-grammar" class="localref"><span class="heading-label">4.2</span>.&#8194;Lexical grammar</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-lexical-tokens" data-toc-depth="3" data-toc-line="[4.2.1]{.heading-label}.&#8194;Lexical tokens" style="toctarget:sec-lexical-tokens"><a href="#sec-lexical-tokens" class="localref"><span class="heading-label">4.2.1</span>.&#8194;Lexical tokens</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-identifiers" data-toc-depth="3" data-toc-line="[4.2.2]{.heading-label}.&#8194;Identifiers" style="toctarget:sec-identifiers"><a href="#sec-identifiers" class="localref"><span class="heading-label">4.2.2</span>.&#8194;Identifiers</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-operators-and-symbols" data-toc-depth="3" data-toc-line="[4.2.3]{.heading-label}.&#8194;Operators and symbols" style="toctarget:sec-operators-and-symbols"><a href="#sec-operators-and-symbols" class="localref"><span class="heading-label">4.2.3</span>.&#8194;Operators and symbols</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-literals" data-toc-depth="3" data-toc-line="[4.2.4]{.heading-label}.&#8194;Literals" style="toctarget:sec-literals"><a href="#sec-literals" class="localref"><span class="heading-label">4.2.4</span>.&#8194;Literals</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-white-space" data-toc-depth="3" data-toc-line="[4.2.5]{.heading-label}.&#8194;White space" style="toctarget:sec-white-space"><a href="#sec-white-space" class="localref"><span class="heading-label">4.2.5</span>.&#8194;White space</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-character-classes" data-toc-depth="3" data-toc-line="[4.2.6]{.heading-label}.&#8194;Character classes" style="toctarget:sec-character-classes"><a href="#sec-character-classes" class="localref"><span class="heading-label">4.2.6</span>.&#8194;Character classes</a></div></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec:layout" data-toc-depth="2" data-toc-line="[4.3]{.heading-label}.&#8194;Semicolon insertion" style="toctarget:sec:layout"><a href="#sec:layout" class="localref"><span class="heading-label">4.3</span>.&#8194;Semicolon insertion</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-the-layout-algorithm" data-toc-depth="3" data-toc-line="[4.3.1]{.heading-label}.&#8194;The layout algorithm" style="toctarget:sec-the-layout-algorithm"><a href="#sec-the-layout-algorithm" class="localref"><span class="heading-label">4.3.1</span>.&#8194;The layout algorithm</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec:lex-implementation" data-toc-depth="3" data-toc-line="[4.3.2]{.heading-label}.&#8194;Implementation" style="toctarget:sec:lex-implementation"><a href="#sec:lex-implementation" class="localref"><span class="heading-label">4.3.2</span>.&#8194;Implementation</a></div></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-context-free-syntax" data-toc-depth="2" data-toc-line="[4.4]{.heading-label}.&#8194;Context-free syntax" style="toctarget:sec-context-free-syntax"><a href="#sec-context-free-syntax" class="localref"><span class="heading-label">4.4</span>.&#8194;Context-free syntax</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-modules" data-toc-depth="3" data-toc-line="[4.4.1]{.heading-label}.&#8194;Modules" style="toctarget:sec-modules"><a href="#sec-modules" class="localref"><span class="heading-label">4.4.1</span>.&#8194;Modules</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-top-level-declarations" data-toc-depth="3" data-toc-line="[4.4.2]{.heading-label}.&#8194;Top level declarations" style="toctarget:sec-top-level-declarations"><a href="#sec-top-level-declarations" class="localref"><span class="heading-label">4.4.2</span>.&#8194;Top level declarations</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-type-declarations" data-toc-depth="3" data-toc-line="[4.4.3]{.heading-label}.&#8194;Type declarations" style="toctarget:sec-type-declarations"><a href="#sec-type-declarations" class="localref"><span class="heading-label">4.4.3</span>.&#8194;Type declarations</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-value-and-function-declarations" data-toc-depth="3" data-toc-line="[4.4.4]{.heading-label}.&#8194;Value and function declarations" style="toctarget:sec-value-and-function-declarations"><a href="#sec-value-and-function-declarations" class="localref"><span class="heading-label">4.4.4</span>.&#8194;Value and function declarations</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-statements" data-toc-depth="3" data-toc-line="[4.4.5]{.heading-label}.&#8194;Statements" style="toctarget:sec-statements"><a href="#sec-statements" class="localref"><span class="heading-label">4.4.5</span>.&#8194;Statements</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-expressions" data-toc-depth="3" data-toc-line="[4.4.6]{.heading-label}.&#8194;Expressions" style="toctarget:sec-expressions"><a href="#sec-expressions" class="localref"><span class="heading-label">4.4.6</span>.&#8194;Expressions</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-operator-expressions" data-toc-depth="3" data-toc-line="[4.4.7]{.heading-label}.&#8194;Operator expressions" style="toctarget:sec-operator-expressions"><a href="#sec-operator-expressions" class="localref"><span class="heading-label">4.4.7</span>.&#8194;Operator expressions</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-atomic-expressions" data-toc-depth="3" data-toc-line="[4.4.8]{.heading-label}.&#8194;Atomic expressions" style="toctarget:sec-atomic-expressions"><a href="#sec-atomic-expressions" class="localref"><span class="heading-label">4.4.8</span>.&#8194;Atomic expressions</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-matching" data-toc-depth="3" data-toc-line="[4.4.9]{.heading-label}.&#8194;Matching" style="toctarget:sec-matching"><a href="#sec-matching" class="localref"><span class="heading-label">4.4.9</span>.&#8194;Matching</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-operation-clauses" data-toc-depth="3" data-toc-line="[4.4.10]{.heading-label}.&#8194;Operation Clauses" style="toctarget:sec-operation-clauses"><a href="#sec-operation-clauses" class="localref"><span class="heading-label">4.4.10</span>.&#8194;Operation Clauses</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-type-schemes" data-toc-depth="3" data-toc-line="[4.4.11]{.heading-label}.&#8194;Type schemes" style="toctarget:sec-type-schemes"><a href="#sec-type-schemes" class="localref"><span class="heading-label">4.4.11</span>.&#8194;Type schemes</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-types" data-toc-depth="3" data-toc-line="[4.4.12]{.heading-label}.&#8194;Types" style="toctarget:sec-types"><a href="#sec-types" class="localref"><span class="heading-label">4.4.12</span>.&#8194;Types</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-kinds" data-toc-depth="3" data-toc-line="[4.4.13]{.heading-label}.&#8194;Kinds" style="toctarget:sec-kinds"><a href="#sec-kinds" class="localref"><span class="heading-label">4.4.13</span>.&#8194;Kinds</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-implementation" data-toc-depth="3" data-toc-line="[4.4.14]{.heading-label}.&#8194;Implementation" style="toctarget:sec-implementation"><a href="#sec-implementation" class="localref"><span class="heading-label">4.4.14</span>.&#8194;Implementation</a></div></div></div>
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="sec-references" data-toc-depth="1" data-toc-line="References" style="toctarget:sec-references"><a href="#sec-references" class="localref">References</a></div>
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="sec-full-grammar-specification" data-toc-depth="1" data-toc-line="[A]{.heading-label}.&#8194;Full grammar specification" style="toctarget:sec-full-grammar-specification"><a href="#sec-full-grammar-specification" class="localref"><span class="heading-label">A</span>.&#8194;Full grammar specification</a></div>
<div class="tocblock tocblock2">
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec:full-lexical" data-toc-depth="2" data-toc-line="[A.1]{.heading-label}.&#8194;Lexical syntax" style="toctarget:sec:full-lexical"><a href="#sec:full-lexical" class="localref"><span class="heading-label">A.1</span>.&#8194;Lexical syntax</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec:full-grammar" data-toc-depth="2" data-toc-line="[A.2]{.heading-label}.&#8194;Context-free syntax" style="toctarget:sec:full-grammar"><a href="#sec:full-grammar" class="localref"><span class="heading-label">A.2</span>.&#8194;Context-free syntax</a></div></div></div></nav></div>
<div class="mainpanel">

<div class="maincontent">
<!-- #00547D -->


<p class="p noindent"><a href="https://gitter.im/koka-lang/koka?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img align="right" src="https://badges.gitter.im/koka-lang/koka.svg"/></a>
</p><h1 id="getstarted" class="h1" data-heading-depth="1" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#getstarted" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">1</span>.&#8194;</span>Getting started</h1>
<p class="p noindent">Welcome to Koka &#8211; a strongly typed functional-style language with effect types and handlers.
</p>
<p class="p indent" style="text-align:left"><a href="#why" title="2.&#8194;Why Koka?" class="learn button localref" style="target-element:h1">Why Koka? <span class="fa fa-angle-double-down"></span></a>
<a href="#tour" title="3.&#8194;A Tour of Koka" class="learn button localref" style="target-element:h1">A Tour of Koka <span class="fa fa-angle-double-down"></span></a>
<a href="#install" title="1.1.&#8194;Installing the compiler" class="learn button localref" style="target-element:h2">Install <span class="fa fa-angle-double-down"></span></a>
<a href="https://github.com/koka-lang/koka/discussions" data-linkid="forum" class="button learn">Discussion forum</a>
<a href="https://github.com/koka-lang/koka" data-linkid="kokarepo" class="button learn" target="_top">Github</a>
<a href="https://koka-lang.github.io/koka/doc/toc.html" data-linkid="libraries" class="button learn" target="_top">Libraries</a></p>
<div class="smaller" style="font-size:smaller">
<p class="p noindent">Note: Koka v2 is a research language that is currently under development
and not ready for production use. 
Nevertheless, the language is stable and the compiler
implements the full specification. The main things lacking at the moment are 
libraries, package management, and deep IDE integration. 
</p>
<div class="news">
<p class="p noindent">News:
</p>
<ul class="ul list-star news-items compact">
<li class="li ul-li list-star-li news-items-li compact-li" style="margin-bottom:1ex">2021-08-25: Tomorrow at 12:30 EST/NewYork starts the&nbsp;<a href="https://icfp21.sigplan.org/details/icfp-2021-tutorials/5/Programming-with-Effect-Handlers-and-FBIP-in-Koka">Koka Tutorial at
ICFP&#39;21</a> (together with Ningning Xie). A live stream link will be posted here half an
hour before the start. (You can still register at ICFP for as low as $10 and be able to ask questions etc.)
</li>
<li class="li ul-li list-star-li news-items-li compact-li" style="margin-bottom:1ex">2021-06-23: Koka v2.1.9 released, initial cross-module specialization (by Steven Fontanella)
</li>
<li class="li ul-li list-star-li news-items-li compact-li" style="margin-bottom:1ex">2021-06-17: Koka v2.1.8 released, initial Apple M1 support.
</li>
<li class="li ul-li list-star-li news-items-li compact-li" style="margin-bottom:1ex">The&nbsp;<a href="https://www.microsoft.com/en-us/research/publication/perceus-garbage-free-reference-counting-with-reuse/" data-linkid="perceus">Perceus</a> paper won a distinguished paper award at PLDI&#39;21!
</li>
<li class="li ul-li list-star-li news-items-li compact-li" style="margin-bottom:1ex">2021-06-10: Koka v2.1.6 released.
</li>
<li class="li ul-li list-star-li news-items-li compact-li" style="margin-bottom:1ex">2021-05-31: Koka v2.1.4 released.
</li>
<li class="li ul-li list-star-li news-items-li compact-li" style="margin-bottom:1ex">2021-05-01: Koka v2.1.2 released.
</li>
<li class="li ul-li list-star-li news-items-li compact-li" style="margin-bottom:1ex">2021-03-08: Koka v2.1.1 released.
</li>
<li class="li ul-li list-star-li news-items-li compact-li" style="margin-bottom:1ex">2021-02-14: Koka v2.0.16 released.
</li>
<li class="li ul-li list-star-li news-items-li compact-li" style="margin-bottom:1ex">2020-12-12: Koka v2.0.14 released.
</li>
<li class="li ul-li list-star-li news-items-li compact-li" style="margin-bottom:1ex">2020-12-02: Koka v2.0.12 released.
</li>
<li class="li ul-li list-star-li news-items-li compact-li" style="margin-bottom:1ex">2020-11-29: Perceus technical report publised (<a href="https://www.microsoft.com/en-us/research/publication/perceus-garbage-free-reference-counting-with-reuse/" data-linkid="perceus">pdf</a>).</li></ul>
</div></div><h2 id="install" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#install" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">1.1</span>.&#8194;</span>Installing the compiler</h2>
<p class="p noindent">For Linux (x64, arm64) and macOS (x64, M1), you can install Koka using:
</p>
<p class="p copy button indent" title="Copy" data-value="curl -sSL https://github.com/koka-lang/koka/releases/latest/download/install.sh | sh" style="float:left;font-size:75%"><span class="fa fa-copy"></span></p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2">curl -sSL https://github.com/koka-lang/koka/releases/latest/download/install.sh &#124; sh</strong></span></code></pre>
<p class="p noindent para-continued">For Windows (x64), open a <code class="code code2">cmd</code> prompt and use:
</p>
<p class="p copy button indent" title="Copy" data-value="curl -sSL -o %tmp%\install-koka.bat https://github.com/koka-lang/koka/releases/latest/download/install.bat &amp;&amp; %tmp%\install-koka.bat" style="float:left;font-size:75%"><span class="fa fa-copy"></span></p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2">curl -sSL -o %tmp%\install-koka.bat https://github.com/koka-lang/koka/releases/latest/download/install.bat &amp;&amp; %tmp%\install-koka.bat</strong></span></code></pre>
<p class="p noindent para-continued">This also installs syntax highlighting for the VS Code and Atom editors.
</p>
<p class="p indent">After installation, verify if Koka installed correctly:
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">$ koka</code></strong></span>
 _         _
| |       | |
| | _ ___ | | _ __ _
| |/ / _ \| |/ / _&#39; |  welcome to the koka interactive compiler
|   ( (_) |   ( (_| |  version 2.1.7, Jun 15 2021, libc x64 (gcc)
|_|\_\___/|_|\_\__,_|  type :? for help, and :q to quit

loading: std/core
loading: std/core/types
loading: std/core/hnd
<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt;</code></strong></span></code></pre>
<p class="p noindent para-continued">Type <code class="code code2">:q</code> to exit the interactive environment.
</p>
<p class="p indent">For detailed installation instructions and other platforms see the&nbsp;<a href="https://github.com/koka-lang/koka/releases" data-linkid="releases">releases</a> page.
It is also straightforward to build the compiler&nbsp;<a href="https://github.com/koka-lang/koka/#build-from-source" data-linkid="build">from source</a>.
</p><h2 id="sec-running-the-compiler" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-running-the-compiler" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">1.2</span>.&#8194;</span>Running the compiler</h2>
<p class="p noindent">You can compile a Koka source using <code class="koka"><span class="op"><span class="minus">-</span></span>c</code> (note that all&nbsp;<a href="https://github.com/koka-lang/koka/tree/master/samples" data-linkid="samples"><code class="koka">samples</code></a> are pre-installed):
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">$ koka -c samples/basic/caesar.kk</code></strong></span>
compile: samples/basic/caesar.kk
loading: std/core
loading: std/core/types
loading: std/core/hnd
loading: std/num/double
loading: std/text/parse
loading: std/num/int32
check  : samples/basic/caesar
linking: samples_basic_caesar
created: out/v2.1.6/gcc-debug/samples_basic_caesar</code></pre>
<p class="p noindent para-continued">and run the resulting executable:
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">$ out/v2.1.6/gcc-debug/samples_basic_caesar</code></strong></span>
plain  : Koka is a well-typed language
encoded: Krnd lv d zhoo-wbshg odqjxdjh
cracked: Koka is a well-typed language</code></pre>
<p class="p noindent para-continued">The <code class="code code2">-O2</code> flag builds an optimized program. Let&#39;s try it on a purely functional implementation
of balanced insertion in a red-black tree (<a href="https://github.com/koka-lang/koka/tree/master/samples/basic/rbtree.kk"><code class="koka">rbtree<span class="kw op">.</span>kk</code></a>):
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">$ koka -O2 -c samples/basic/rbtree.kk</code></strong></span>
...
linking: samples_basic_rbtree
created: out/v2.1.6/gcc-drelease/samples_basic_rbtree

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">$ time out/v2.1.6/gcc-drelease/samples_basic_rbtree</code></strong></span>
420000
real    0m0.750s
...</code></pre>
<p class="p noindent para-continued">(On Windows you can give the <code class="koka"><span class="op">--</span>kktime</code> option to see the elapsed time).
We can compare this against an in-place updating C++ implementation using <code class="code code2">stl::map</code>
(<a href="https://github.com/koka-lang/koka/tree/master/samples/basic/rbtree.cpp"><code class="code code2">rbtree.cpp</code></a>) (which also uses a
<a href="https://code.woboq.org/gcc/libstdc++-v3/src/c++98/tree.cc.html">red-black tree</a> internally):
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">$ clang++ --std=c++17 -o cpp-rbtree -O3 /usr/local/share/koka/v2.1.6/samples/basic/rbtree.cpp</code></strong></span>
<span class="code-escaped"><strong class="strong-star2"><code class="code code2">$ time ./cpp-rbtree</code></strong></span>
420000
real    0m0.864s
...</code></pre>
<p class="p noindent para-continued">The excellent performance relative to C++ here (on Ubuntu with an AMD 3600XT) 
is the result of Perceus automatically
transforming the fast path of the pure functional rebalancing to use mostly in-place updates,
closely mimicking the imperative rebalancing code of the hand optimized C++ library.
</p><h2 id="sec-running-the-interactive-compiler" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-running-the-interactive-compiler" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">1.3</span>.&#8194;</span>Running the interactive compiler</h2>
<p class="p noindent">Without giving any input files, the interactive environment runs by default:
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">$ koka</code></strong></span>
 _         _
| |       | |
| | _ ___ | | _ __ _
| |/ / _ \| |/ / _&#39; |  welcome to the koka interactive compiler
|   ( (_) |   ( (_| |  version 2.1.7, Jun 15 2021, libc x64 (clang-cl)
|_|\_\___/|_|\_\__,_|  type :? for help, and :q to quit

loading: std/core
loading: std/core/types
loading: std/core/hnd
<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt;</code></strong></span></code></pre>
<p class="p noindent para-continued">Now you can test some expressions:
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; println(&quot;hi koka&quot;)</code></strong></span>
check  : interactive
check  : interactive
linking: interactive
created: out\v2.1.7\clang-cl-debug\interactive

hi koka

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :t &quot;hi&quot;</code></strong></span>
string

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :t println(&quot;hi&quot;)</code></strong></span>
console ()</code></pre>
<p class="p noindent para-continued">Or load a demo (use <code class="code code2">tab</code> completion to avoid typing too much):
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :l samples/basic/fibonacci</code></strong></span>
compile: samples/basic/fibonacci.kk
loading: std/core
loading: std/core/types
loading: std/core/hnd
check  : samples/basic/fibonacci
modules:
  samples/basic/fibonacci

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; main()</code></strong></span>
check  : interactive
check  : interactive
linking: interactive
created: out\v2.1.7\clang-cl-debug\interactive

The 10000th fibonacci number is 33644764876431783266621612005107543310302148460680063906564769974680081442166662368155595513633734025582065332680836159373734790483865268263040892463056431887354544369559827491606602099884183933864652731300088830269235673613135117579297437854413752130520504347701602264758318906527890855154366159582987279682987510631200575428783453215515103870818298969791613127856265033195487140214287532698187962046936097879900350962302291026368131493195275630227837628441540360584402572114334961180023091208287046088923962328835461505776583271252546093591128203925285393434620904245248929403901706233888991085841065183173360437470737908552631764325733993712871937587746897479926305837065742830161637408969178426378624212835258112820516370298089332099905707920064367426202389783111470054074998459250360633560933883831923386783056136435351892133279732908133732642652633989763922723407882928177953580570993691049175470808931841056146322338217465637321248226383092103297701648054726243842374862411453093812206564914032751086643394517512161526545361333111314042436854805106765843493523836959653428071768775328348234345557366719731392746273629108210679280784718035329131176778924659089938635459327894523777674406192240337638674004021330343297496902028328145933418826817683893072003634795623117103101291953169794607632737589253530772552375943788434504067715555779056450443016640119462580972216729758615026968443146952034614932291105970676243268515992834709891284706740862008587135016260312071903172086094081298321581077282076353186624611278245537208532365305775956430072517744315051539600905168603220349163222640885248852433158051534849622434848299380905070483482449327453732624567755879089187190803662058009594743150052402532709746995318770724376825907419939632265984147498193609285223945039707165443156421328157688908058783183404917434556270520223564846495196112460268313970975069382648706613264507665074611512677522748621598642530711298441182622661057163515069260029861704945425047491378115154139941550671256271197133252763631939606902895650288268608362241082050562430701794976171121233066073310059947366875</code></pre>
<p class="p noindent para-continued">You can also set command line options in the interactive environment using <code class="code code2">:set &lt;options&gt;</code>.
For example, we can load the <code class="code code2">rbtree</code> example again and print out the elapsed runtime with <code class="code code2">--showtime</code>:
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :set --showtime</code></strong></span>

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :l samples/basic/rbtree.kk</code></strong></span>
...
linking: interactive
created: out\v2.1.7\clang-cl-debug\interactive

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; main()</code></strong></span>
...
420000
info: elapsed: 1.119s, user: 1.093s, sys: 0.031s, rss: 230mb</code></pre>
<p class="p noindent para-continued">and then enable optimizations with <code class="code code2">-O2</code> and run again (on Windows with an AMD 5950X):
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :set -O2</code></strong></span>

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :r </code></strong></span>
...
linking: interactive
created: out\v2.1.7\clang-cl-drelease\interactive

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; main()</code></strong></span>
...
420000
info: elapsed: 0.822s, user: 0.828s, sys: 0.000s, rss: 198mb</code></pre>
<p class="p noindent para-continued">And finally we quit the interpreter:
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :q</code></strong></span>

I think of my body as a side effect of my mind.
  -- Carrie Fisher (1956)</code></pre><h2 id="sec-samples-and-editors" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-samples-and-editors" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">1.4</span>.&#8194;</span>Samples and Editors</h2>
<p class="p noindent">The&nbsp;<a href="https://github.com/koka-lang/koka/tree/master/samples/syntax"><code class="code code2">samples/syntax</code></a>
and&nbsp;<a href="https://github.com/koka-lang/koka/tree/master/samples/basic"><code class="code code2">samples/basic</code></a> 
directories contain various basic Koka examples to start with. If you type:
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :l samples/</code></strong></span></code></pre>
<p class="p noindent para-continued">in the interpreter, you can <code class="code code2">tab</code> twice to see the available sample files and directories.
Use <code class="code code2">:s</code> to see the source of a loaded module.
</p>
<p class="p indent">If you use VS Code or Atom (or if you set the <code class="code code2">koka_editor</code> environment variable manually),
you can type <code class="code code2">:e</code> in the interactive prompt to edit your program further. For example,
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :l samples/basic/caesar</code></strong></span>
...
modules:
    samples/basic/caesar

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :e </code></strong></span>

&lt;edit the source and reload&gt;

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :r</code></strong></span>
...
modules:
    samples/basic/caesar

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; main()</code></strong></span>
</code></pre>
<p class="p noindent para-continued">What next?
</p>
<p class="p indent"><a href="#sec-basics" title="3.1.&#8194;Basics" class="learn button localref" style="target-element:h2">Basic Koka syntax <span class="fa fa-angle-double-down"></span></a>
<a href="https://koka-lang.github.io/koka/doc/toc.html" data-linkid="libraries" class="button learn" target="_top">Browse the Library documentation</a>
</p><!--
## Algebraic effect handlers

A novel feature of &koka; is a compiled and typed implementation of algebraic
effect handlers (described in detail in [[3]](#references)).
In the interactive environment, you can load various demo files with algebraic
effects which are located in the [``samples/handlers``](https://github.com/koka-lang/koka/tree/master/samples/handlers) directory.

    > :f samples/handlers/basic

where ``:f`` forces a recompile (versus ``:l`` which avoids a recompile if possible).
Use the ``:?`` command to get an overview of all commands. After
loading the ``common`` demo, we can run it directly from the interpreter:

    > :f samples/handlers/basic
    compile: samples/handlers/basic.kk
    ...
    check  : samples/handlers/basic
    modules:
      samples/handlers/basic

    > :t test2    
    () -> console ()

    > test2()
    check  : interactive
    check  : interactive
    linking: interactive
    created: out\v2.0.5\mingw-debug\interactive

    Hello there, there

Some interesting demos are:

* ``basic.kk``: Various examples from the paper "_Algebraic Effects for
  Functional Programming_" [[3]](#references). Shows how to implement
  common control-flow abstractions like exceptions, state, iterators,
  ambiguity, and asynchronous programming.

* ``nim.kk``: Various examples from the paper "_Liberating effects with
  rows and handlers_" [[1]](#references).

* ``scoped.kk``: Examples from the paper "_Effect Handlers in Scope_" [[5]](#references).
-->


<h1 id="why" class="h1" data-heading-depth="1" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#why" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">2</span>.&#8194;</span>Why Koka?</h1>
<p class="p noindent">There are many new languages being designed, but only few
bring fundamentally new concepts &#8211; like Haskell with
pure versus monadic programming, or Rust with borrow checking.
Koka distinguishes itself through <em class="em-low1">effect typing</em>, <em class="em-low1">effect handlers</em>,
and <em class="em-low1">Perceus</em> memory management:
</p>
<div class="banners">
<div class="banner">
<p class="p noindent"><span class="banner-caption">Minimal but General</span>The core of Koka consists of a small set of well-studied language
features, like first-class functions, a polymorphic type- and effect
system, algebraic data types, and effect handlers. Each of these is
composable and avoid the addition of
&#8220;special&#8221; extensions by being as general as possible.
</p>
<p class="p indent"><a href="#why-mingen" title="2.1.&#8194;Minimal but General" class="learn button localref" style="target-element:h2">Read more about the <em class="em-low1">minimal but general</em> design <span class="fa fa-angle-double-down"></span></a></p></div>
<div class="banner">
<p class="p noindent"><span class="banner-caption">Effect Types</span>Koka tracks the (side) <em class="em-low1">effects</em> of every
function in its type, where pure and effectful computations are
distinguished. The precise effect typing gives Koka <em class="em-low1">rock-solid
semantics</em> backed by well-studied category theory, which makes Koka
particularly easy to reason about for both humans and compilers.
</p>
<p class="p indent"><a href="#why-effects" title="2.2.&#8194;Effect Typing" class="learn button localref" style="target-element:h2">Read more about effect types <span class="fa fa-angle-double-down"></span></a></p></div>
<div class="banner">
<p class="p noindent"><span class="banner-caption">Effect Handlers</span>Effect handlers let you define advanced control abstractions,
like exceptions, async/await, or probabilistic programs, 
as a user library in a typed and composable way.<br>
&#160;
</p>
<p class="p indent"><a href="#why-handlers" title="2.3.&#8194;Effect Handlers" class="learn button localref" style="target-element:h2">Read more about effect handlers <span class="fa fa-angle-double-down"></span></a></p></div>
<div class="banner">
<p class="p noindent"><span class="banner-caption">Perceus Reference Counting</span>Perceus is an advanced compilation method for reference counting.
This lets Koka compile directly to C code <em class="em-low1">without needing
a garbage collector or runtime system</em>! This also gives Koka 
excellent performance in practice.
</p>
<p class="p indent"><a href="#why-perceus" title="2.4.&#8194;Perceus Optimized Reference Counting" class="learn button localref" style="target-element:h2">Read more about Perceus reference counting <span class="fa fa-angle-double-down"></span></a></p></div>
<div class="banner">
<p class="p noindent"><span class="banner-caption">Reuse Analysis</span>Through Perceus, Koka can do reuse analysis and optimize 
functional-style programs to use in-place updates.
</p>
<p class="p indent"><a href="#why-fbip" title="2.5.&#8194;Reuse Analysis" class="learn button localref" style="target-element:h2">Read more about reuse analysis <span class="fa fa-angle-double-down"></span></a></p></div><!--
This makes many functional algorithms behave
like their imperative counterparts on uniquely owned parameters while
degrading gracefully to use copying when persistence is required.
-->


<!--
~ banner { caption:"FBIP: Functional But In-Place"}
Reuse analysis leads to a new style of programming that we call _FBIP_.
Just like tail-recursion lets us write loops in terms of 
function calls, reuse analysis lets us write many imperative 
algorithms in a functional style.

[Read more about FBIP &adown;][#why-fbip]{.learn}
~
-->

</div><h2 id="why-mingen" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#why-mingen" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">2.1</span>.&#8194;</span>Minimal but General</h2>
<p class="p noindent">Koka has a small core set of
orthogonal, well-studied language features &#8211; but each of these is
as general and <em class="em-low1">composable</em> as possible, such that we do not need further
&#8220;special&#8221; extensions. Core features include first-class functions,
a higher-rank impredicative polymorphic type- and effect system, 
algebraic data types, and effect handlers.
</p><pre class="koka source aside"><span class="plaincode">fun hello-ten() {
  var i := 0
  while { i &lt; 10 } {
    println("hello")
    i := i + 1
  }
}
</span><span class="nicecode"><span class="kw">fun</span> hello<span class="dash">-</span>ten() {
  <span class="kw">var</span> i <span class="kw op">:=</span> <span class="number">0</span>
  while { i <span class="op">&lt;</span> <span class="number">10</span> } {
    println(<span class="st">"hello"</span>)
    i <span class="kw op">:=</span> i <span class="op">+</span> <span class="number">1</span>
  }
}
</span></pre>



<p class="p noindent">As an example of the <em class="em-low1">min-gen</em> design principle, Koka implements most
control-flow primitives as regular functions. An anonymous function can
be written as <code class="koka"><span class="kw">fn</span>(){ <span class="op">&#60;</span>body<span class="op">&#62;</span> }</code>; but as a syntactic convenience, any
function without arguments can be shortened further to use just braces,
as <code class="koka">{ <span class="op">&#60;</span>body<span class="op">&#62;</span> }</code>.
</p>
<p class="p indent">We can write a <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> loop now using regular
function calls as shown in the example,
where the call to <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> is desugared to
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( <span class="kw">fn</span>(){ i <span class="op">&#60;</span> <span class="number">10</span> }, <span class="kw">fn</span>(){ <span class="op">...</span> } )</code>. 
</p>
<p class="p indent">This also naturally leads to
<em class="em-low1">consistency</em>: an expression between <em class="em-low1">parenthesis</em> is always evaluated
before a function call, whereas an expression between <em class="em-low1">braces</em> (ah,
<em class="em-low1">suspenders</em>!) is suspended and may be never evaluated or more than once
(as in our example). This is inconsistent in most other languages where
often the predicate of a <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> loop is written in parenthesis but may
be evaluated multiple times.
</p>
<p class="p learn button indent"><a href="book.html#sec-basics">Learn more about basic syntax <span class="fa fa-angle-double-down"></span></a></p><h2 id="why-effects" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#why-effects" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">2.2</span>.&#8194;</span>Effect Typing</h2>
<p class="p noindent">Koka infers and tracks the effect of every function in its type &#8211; 
and a function type has 3 parts: the argument types, the effect type, 
and the type of the result. For example: 
</p><pre class="koka source unchecked"><span class="plaincode">fun sqr    : (int)     -&gt; total int       // mathematical total function    
fun divide : (int,int) -&gt; exn int         // may raise an exception (partial)  
fun turing : (tape)    -&gt; div int         // may not terminate (diverge)  
fun print  : (string)  -&gt; console ()      // may write to the console  
fun rand   : ()        -&gt; ndet int        // non-deterministic  
</span><span class="nicecode"><span class="kw">fun</span> sqr    <span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">)</span>     <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>       <span class="comment">// mathematical total function    
</span><span class="kw">fun</span> divide <span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>         <span class="comment">// may raise an exception (partial)  
</span><span class="kw">fun</span> turing <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">tape</span><span class="tp sp">)</span>    <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>         <span class="comment">// may not terminate (diverge)  
</span><span class="kw">fun</span> print  <span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a><span class="tp sp">)</span>  <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_console"><span class="tp">console</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>console: <span class="tp">X</span></span></a> <span class="tp sp">(</span><span class="tp sp">)</span>      <span class="comment">// may write to the console  
</span><span class="kw">fun</span> rand   <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span>        <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>        <span class="comment">// non-deterministic  
</span></span></pre>



<p class="p noindent">The precise effect typing gives Koka rock-solid semantics and deep 
safety guarantees backed
by well-studied category theory, which makes Koka particularly easy to
reason about for both humans and compilers. (Given the importance of
effect typing, the name Koka was derived from the Japanese word for
<em class="em-low1">effective</em>
(&#x52B9;&#x679C;, &#12371;&#12358;&#12363;,&nbsp;<a href="https://translate.google.com/#view=home&amp;op=translate&amp;sl=auto&amp;tl=en&amp;text=%E5%8A%B9%E6%9E%9C">K&#333;ka</a>)).
</p>
<p class="p indent">A function without any effect is called <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a></code> and corresponds to
mathematically total functions &#8211; a good place to be. Then we have
effects for partial functions that can raise exceptions (<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a></code>), and
potentially non-terminating functions as <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a></code> (divergent). The
combination of <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a></code> and <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a></code> is called <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a></code> as that corresponds to
Haskell&#39;s notion of purity. On top of that we find mutability (as <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">E</span></span></a></code>)
up to full non-deterministic side effects in <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp">io</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a></code>. 
</p>
<p class="p indent">Effects can be polymorphic as well. Consider mapping a function over
a list:
</p><pre class="koka source unchecked"><span class="plaincode">fun map( xs : list&lt;a&gt;, f : a -&gt; e b ) : e list&lt;b&gt; {
  match(xs) {
    Cons(x,xx) -&gt; Cons( f(x), map(xx,f) )
    Nil        -&gt; Nil
  }
}
</span><span class="nicecode"><span class="kw">fun</span> map( xs <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span>, f <span class="tp kw op">:</span> <span class="tp tv">a</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span> ) <span class="tp kw op">:</span> <span class="tp tv">e</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> {
  <span class="kw">match</span>(xs) {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(x,xx) <span class="kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>( f(x), map(xx,f) )
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>        <span class="kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
  }
}
</span></pre>


<p class="p noindent">Single letter types are polymorphic (aka, <em class="em-low1">generic</em>), and Koka infers
that you map from a list of elements <code class="koka"><span class="tp tv">a</span></code> to a list of elements of
type <code class="koka"><span class="tp tv">b</span></code>. Since <code class="koka">map</code> itself has no intrinsic effect, the effect 
of applying <code class="koka">map</code> is exactly the effect of the function <code class="koka">f</code> that
is applied, namely <code class="koka"><span class="tp tv">e</span></code>. 
</p>
<p class="p learn button indent"><a href="book.html#sec-effect-types">Learn more about effect types <span class="fa fa-angle-double-down"></span></a></p><h2 id="why-handlers" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#why-handlers" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">2.3</span>.&#8194;</span>Effect Handlers</h2>
<p class="p noindent">Another example of the <em class="em-low1">min-gen</em> design principle: instead of
various special language and compiler extensions to support exceptions,
generators, async/await etc., Koka has full support for 
algebraic effect handlers &#8211; these lets you define advanced control
abstractions like async/await as a user library in a typed and 
composable way.
</p>
<p class="p indent">Here is an example of an effect definition with
one operation to yield <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code> values:
</p><pre class="koka source"><span class="plaincode">effect yield {
  control yield( i : int ) : bool
}
</span><span class="nicecode"><span class="decl-type" id="type_space_yield"><span class="tp kw">effect</span> <span class="decl-con" id="con_space_Yield"><a class="pp" href="#type_space_yield"><span class="tp">yield</span><span class="pc"><span class="mo">why<span class="fslash last">/</span></span>yield: <span class="tp">HX</span></span></a></span></span> {
  <span class="kw">control</span> <span class="decl-fun" id="yield"><a class="pp" href="#yield">yield<span class="pc"><span class="mo">why<span class="fslash last">/</span></span>yield: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">yield</span> <span class="tp">bool</span></span></a></span>( <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a>
}
</span></pre>


<p class="p noindent">Once the effect is declared, we can use it 
for example to yield the elements of a list:
</p><pre class="koka source"><span class="plaincode">fun traverse( xs : list&lt;int&gt; ) : yield () {
  match(xs) {
    Cons(x,xx) -&gt; if (yield(x)) then traverse(xx) else ()
    Nil        -&gt; ()
  }
}
</span><span class="nicecode"><span class="decl-fun" id="traverse"><span class="kw">fun</span> <a class="pp" href="#traverse">traverse<span class="pc"><span class="mo">why<span class="fslash last">/</span></span>traverse: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">yield</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_yield"><span class="tp">yield</span><span class="pc"><span class="mo">why<span class="fslash last">/</span></span>yield: <span class="tp">HX</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a> {
  <span class="kw">match</span>(<a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>) {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>,<a class="pp">xx<span class="pc">xx: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>) <span class="kw op">-></span> <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp" href="#yield">yield<span class="pc"><span class="mo">why<span class="fslash last">/</span></span>yield: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">yield</span> <span class="tp">bool</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>)) <span class="kw">then</span> <a class="pp" href="#traverse">traverse<span class="pc"><span class="mo">why<span class="fslash last">/</span></span>traverse: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">yield</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">xx<span class="pc">xx: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>) <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space__lp__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>        <span class="kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space__lp__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
  }
</span>}
</span></pre>


<p class="p noindent">The <code class="koka"><a class="pp" href="#traverse">traverse<span class="pc"><span class="mo">why<span class="fslash last">/</span></span>traverse: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">int</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">yield</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> function calls <code class="koka">yield</code> and therefore gets the <code class="koka"><a class="pp" href="#type_space_yield"><span class="tp">yield</span><span class="pc"><span class="mo">why<span class="fslash last">/</span></span>yield: <span class="tp">HX</span></span></a></code> effect in its type,
and if we want to use <code class="koka"><a class="pp" href="#traverse">traverse<span class="pc"><span class="mo">why<span class="fslash last">/</span></span>traverse: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">int</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">yield</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code>, we need to <em class="em-low1">handle</em> the <code class="koka"><a class="pp" href="#type_space_yield"><span class="tp">yield</span><span class="pc"><span class="mo">why<span class="fslash last">/</span></span>yield: <span class="tp">HX</span></span></a></code> effect. 
This is much like defining an exception handler, except we can receive values (here an <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code>),
and we can <em class="em-low1">resume</em> with a result (which determines if we keep traversing):
</p><pre class="koka source"><span class="plaincode">fun print-elems() : console () {
  with control yield(i){
    println("yielded " ++ i.show)
    resume(i&lt;=2)
  }
  traverse([1,2,3,4])
}
</span><span class="nicecode"><span class="decl-fun" id="print_elems"><span class="kw">fun</span> <a class="pp" href="#print_elems">print-elems<span class="pc"><span class="mo">why<span class="fslash last">/</span></span>print<span class="dash">-</span>elems: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_console"><span class="tp"><span class="effect">console</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>console: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a> {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">yield</span><span class="tp sp">,</span><span class="tp">console</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <span class="kw">control</span> <a class="pp">yield<span class="pc">yield: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">resume</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>){
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"yielded "</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__plus__1">++<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(++)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#show">show<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>show: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>)
    <a class="pp">resume<span class="pc">resume: <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><span class="number">2</span>)
  }
  <a class="pp" href="#traverse">traverse<span class="pc"><span class="mo">why<span class="fslash last">/</span></span>traverse: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">yield</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">]</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>)
</span>}
</span></pre>


<p class="p noindent">The <code class="koka"><span class="kw">with</span></code> statement binds the handler for <code class="koka"><a class="pp" href="#type_space_yield"><span class="tp">yield</span><span class="pc"><span class="mo">why<span class="fslash last">/</span></span>yield: <span class="tp">HX</span></span></a></code> over the
rest of the scope, in this case <code class="koka"><a class="pp" href="#traverse">traverse<span class="pc"><span class="mo">why<span class="fslash last">/</span></span>traverse: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">int</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">yield</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</code>. 
Note how the handler discharges the <code class="koka"><a class="pp" href="#type_space_yield"><span class="tp">yield</span><span class="pc"><span class="mo">why<span class="fslash last">/</span></span>yield: <span class="tp">HX</span></span></a></code> effect &#8211; and replaces
it with a <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_console"><span class="tp">console</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>console: <span class="tp">X</span></span></a></code> effect. When we run the example, we get:
</p>
<pre class="para-block pre-fenced pre-fenced4" style="display:block"><code>yielded: 1
yielded: 2
yielded: 3</code></pre>
<p class="p learn button noindent para-continued"><a href="book.html#sec-with">Learn more about <code class="koka"><span class="kw">with</span></code> statements <span class="fa fa-angle-double-down"></span></a></p>
<p class="p learn button indent"><a href="book.html#sec-handlers">Learn more about effect handlers <span class="fa fa-angle-double-down"></span></a></p><h2 id="why-perceus" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#why-perceus" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">2.4</span>.&#8194;</span>Perceus Optimized Reference Counting</h2>
<p class="p noindent"><a href="https://en.wikipedia.org/wiki/Perseus_with_the_Head_of_Medusa"><img src="data:image/jpg;base64,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" title="Perseus by Benvenuto Cellini" alt="perceus3" data-path="images/perceus3.jpg" data-linkid="perceus3" style="width:20%;float:right;margin:1em 0em 1em 2em;border:1px solid #222"></a>
</p>
<p class="p noindent">Perceus is the compiler optimized reference counting technique that Koka
uses for automatic memory management&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#perceus:tech" title="Perceus: Garbage-Free Reference Counting with Reuse
Reinking, Xie, Moura, and Leijen, 2020" class="bibref localref" style="target-element:bibitem"><span class="cite-number">15</span></a>]</span>. This (together
with evidence passing&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#xie:evidently" title="Effect Handlers, Evidently
Xie, Brachthuser, Schuster, Hillerstrm, and Leijen, 2020" class="bibref localref" style="target-element:bibitem"><span class="cite-number">16</span></a>, <a href="#xie:evidence-tr" title="Generalized Evidence Passing for Effect Handlers
Xie and Leijen, 2021" class="bibref localref" style="target-element:bibitem"><span class="cite-number">17</span></a>]</span>)
enables Koka to compile directly to plain C code without needing a
garbage collector or runtime system.
</p>
<p class="p indent">Perceus uses extensive static analysis to aggressively optimize the
reference counts. Here the strong semantic foundation of Koka helps a
lot: inductive data types cannot form cycles, and potential sharing
across threads can be reliably determined.
</p>
<p class="p indent">Normally we need to make a fundamental choice when managing memory: 
</p>
<ul class="ul list-dash compact">
<li class="li ul-li list-dash-li compact-li" style="margin-bottom:1ex">We either use manual memory management (C, C++, Rust) and we get 
the best performance but at a significant programming burden,
</li>
<li class="li ul-li list-dash-li compact-li" style="margin-bottom:1ex">Or, we use garbage collection (OCaml, C#, Java, Go, etc.) but
but now we need a runtime system and pay a price in performance,
memory usage, and unpredictable latencies.
</li></ul>

<p class="p noindent"><img src="data:image/png;base64,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" alt="perceus-perf" data-path="images/perceus-perf-bw.png" data-linkid="perceus-perf" style="border:1px solid #AAA;width:40%;float:right;margin:0em 0em 0.25em 1em">
</p>
<p class="p indent">With Perceus, we hope to cross this gap and our goal is to 
be within 2x of the performance of C/C++. Initial benchmarks are
encouraging and show Koka to be close to C performance on various
memory intensive benchmarks.
</p>
<p class="p learn button noindent"><a href="https://github.com/koka-lang/koka#Benchmarks">See benchmarks</a></p>
<p class="p learn button indent"><a href="https://www.microsoft.com/en-us/research/publication/perceus-garbage-free-reference-counting-with-reuse/" data-linkid="perceus">Read the Perceus technical report</a></p><h2 id="why-fbip" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#why-fbip" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">2.5</span>.&#8194;</span>Reuse Analysis</h2>
<p class="p noindent">Perceus also performs <em class="em-low1">reuse analysis</em> as part of reference
counting analysis. This pairs pattern matches with constructors of the
same size and reuses them <em class="em-low1">in-place</em> if possible. Take for example,
the <code class="koka">map</code> function over lists:
</p><pre class="koka source unchecked"><span class="plaincode">fun map( xs : list&lt;a&gt;, f : a -&gt; e b ) : e list&lt;b&gt; {
  match(xs) {
    Cons(x,xx) -&gt; Cons( f(x), map(xx,f) )
    Nil        -&gt; Nil
  }
}
</span><span class="nicecode"><span class="kw">fun</span> map( xs <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span>, f <span class="tp kw op">:</span> <span class="tp tv">a</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span> ) <span class="tp kw op">:</span> <span class="tp tv">e</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> {
  <span class="kw">match</span>(xs) {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(x,xx) <span class="kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>( f(x), map(xx,f) )
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>        <span class="kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
  }
}
</span></pre>



<p class="p noindent">Here the matched <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code> can be reused by the new <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code>
in the branch. This means if we map over a list that is not shared, 
like <code class="koka">list(<span class="number">1</span>,<span class="number">100000</span>)<span class="kw op">.</span>map(sqr)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#sum">sum<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sum: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">int</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code>,
then the list is updated <em class="em-low1">in-place</em> without any extra allocation.
This is very effective for many functional style programs.
</p><!--
The corresponding C code that is generated for the fast path becomes similar to:

````cpp
list_t map( list_t xs, function_t f) {
  if (is_Cons(xs)) {
    if (is_unique(xs)) {
      xs->head = apply(dup(f),xs->head);
      xs->tail = map(xs->tail,f);
      return xs;
    }
    else { ... }
  }
  else {
    return Nil;
  }
}
````
-->


<pre class="para-block aside pre-fenced pre-fenced4 language-cpp lang-cpp cpp colorized" style="display:block"><code><span style="color:teal">void</span> map( list_t xs, function_t f, list_t* res) {
  <span style="color:blue">while</span> (is_Cons(xs)) {
    <span style="color:blue">if</span> (is_unique(xs)) {  <span style="color:darkgreen">// if xs is not shared..</span>
      box_t y = apply(dup(f),xs-&gt;head);      
      <span style="color:blue">if</span> (yielding()) { ... } <span style="color:darkgreen">// if f yielded an effect operation..</span>
      <span style="color:blue">else</span> {
        xs-&gt;head = y;      
        *res = xs;          <span style="color:darkgreen">// update previous node in-place</span>
        res = &amp;xs-&gt;tail;    <span style="color:darkgreen">// set the result address for the next node</span>
        xs = xs-&gt;tail;      <span style="color:darkgreen">// .. and continue with the next node</span>
      }
    }
    <span style="color:blue">else</span> { ... }          <span style="color:darkgreen">// slow path allocates fresh nodes</span>
  }
  *res = <span style="color:teal">Nil</span>;  
}</code></pre>
<p class="p noindent para-continued">Moreover, the Koka compiler also implements <em class="em-low1">tail-recursion modulo cons</em> (TRMC)
and instead of using a recursive call, the function is eventually optimized 
into an in-place updating loop for the fast path, similar to 
the C code example on the right. 
</p>
<p class="p indent">Importantly, the reuse optimization is guaranteed
and a programmer can see when the optimization applies.
This leads to a new programming technique we call FBIP:
<em class="em-low1">functional but in-place</em>. Just like tail-recursion allows us
to express loops with regular function calls, reuse analysis 
allows us to express many imperative algorithms in a purely
functional style. 
</p>
<p class="p learn button indent"><a href="book.html#sec-fbip">Learn more about FBIP <span class="fa fa-angle-double-down"></span></a></p>
<p class="p learn button indent"><a href="https://www.microsoft.com/en-us/research/publication/perceus-garbage-free-reference-counting-with-reuse/" data-linkid="perceus">Read the Perceus report on reuse analysis</a></p>
<div class="mathdefs input-mathdefs"></div><h1 id="tour" class="h1" data-heading-depth="1" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#tour" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3</span>.&#8194;</span>A Tour of Koka</h1>
<p class="p noindent">This is a short introduction to the Koka programming language.
</p>
<p class="p indent">Koka is a <em class="em-low1">function-oriented</em> language that separates pure values from
side-effecting computations (The word &#8216;k&#333;ka&#8217; (or &#x52B9;&#x679C;) means
&#8220;effect&#8221; or &#8220;effective&#8221; in Japanese). Koka is also
flexible and <code class="koka"><span class="kw">fun</span></code>: Koka has many features that help programmers to easily
change their data types and code organization correctly even in large-scale
programs, while having a small strongly-typed language core with a familiar
brace syntax.
</p><h2 id="sec-basics" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-basics" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.1</span>.&#8194;</span>Basics</h2><h3 id="sec-hello-world" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-hello-world" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.1.1</span>.&#8194;</span>Hello world</h3>
<p class="p noindent">As usual, we start with the familiar <em class="em-low1">Hello world</em> program:<span id=`examplemain`></span>
</p><pre class="koka source"><span class="plaincode">fun main() {
  println("Hello world!") // println output
}
</span><span class="nicecode"><span class="decl-fun" id="main"><span class="kw">fun</span> <a class="pp" href="#main">main<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>main: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"Hello world!"</span>) <span class="comment">// println output
</span></span>}
</span></pre>


<p class="p noindent">Koka uses familiar curly-braces syntax where <code class="koka"></code> starts a line
comment. Functions are declared using the <code class="koka"><span class="kw">fun</span></code> keyword (and anonymous functions with <code class="koka"><span class="kw">fn</span></code>).
</p>
<p class="p indent">Here is another short example program that encodes a string using the
<em class="em-low1">Caesar cipher</em>, where each lower-case letter in a string is replaced by the letter
three places up in the alphabet:
</p><pre class="koka source"><span class="plaincode">fun main() { println(caesar("koka is fun")) }

fun encode( s : string, shift : int )
{
  fun encode-char(c) {
    if (c &lt; 'a' || c &gt; 'z') return c
    val base = (c - 'a').int
    val rot  = (base + shift) % 26
    (rot.char + 'a')
  }
  s.map(encode-char)
}

fun caesar( s : string ) : string {
  s.encode( 3 )
}
</span><span class="nicecode"><span class="decl-fun" id="encode"><span class="kw">fun</span> <a class="pp" href="#encode">encode<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">shift<span class="pc">shift: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> )
{
  <span class="decl-fun" id="encode_char"><span class="kw">fun</span> <a class="pp">encode-char<span class="pc">encode<span class="dash">-</span>char: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">char</span></span></a>(<a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a>) {
    <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_lt_">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;): <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">,</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="st">'a'</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_gt_">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;): <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">,</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="st">'z'</span>) <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">char</span></span></a> <a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a>
    <span class="kw">val</span> <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a> <span class="kw">=</span> (<a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash__4">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.4</span>: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">char</span></span></a> <span class="st">'a'</span>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#int">int<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
    <span class="kw">val</span> <a class="pp">rot<span class="pc">rot: <span class="tp">int</span></span></a>  <span class="kw">=</span> (<a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">shift<span class="pc">shift: <span class="tp">int</span></span></a>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">26</span>
    (<a class="pp">rot<span class="pc">rot: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#char">char<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>char: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__4">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.4</span>: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">char</span></span></a> <span class="st">'a'</span>)
  </span>}
  <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#map_6">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.6</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">string</span></span></a>(<a class="pp">encode-char<span class="pc">encode<span class="dash">-</span>char: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">char</span></span></a>)
</span>}

<span class="decl-fun" id="caesar"><span class="kw">fun</span> <a class="pp" href="#caesar">caesar<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>caesar: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
  <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="#encode">encode<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <span class="number">3</span> )
</span>}
</span></pre>



<p class="p noindent">In this example, we declare a local function <code class="koka">encode<span class="dash">-</span>char</code> which encodes a
single character <code class="koka">c</code>. The final statement <code class="koka">s<span class="kw op">.</span>map(encode<span class="dash">-</span>char)</code> applies the
<code class="koka">encode<span class="dash">-</span>char</code> function to each character in the string <code class="koka">s</code>, returning a
new string where each character is Caesar encoded. The result of the final
statement in a function is also the return value of that function, and you can
generally leave out an explicit <code class="koka"><span class="kw">return</span></code> keyword.
</p><h3 id="sec-dot" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-dot" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.1.2</span>.&#8194;</span>Dot selection</h3>
<p class="p noindent">Koka is a <em class="em-low1">function-oriented</em> language where <em class="em-low1">functions</em> and <em class="em-low1">data</em> form the
core of the language (in contrast to objects for example). In particular, the
expression <code class="koka">s<span class="kw op">.</span><a class="pp" href="#encode">encode<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a>(<span class="number">3</span>)</code> does <em class="em-low1">not</em> select the <code class="koka"><a class="pp" href="#encode">encode<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a></code> method from the
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a></code> object, but it is simply syntactic sugar for the function call
<code class="koka"><a class="pp" href="#encode">encode<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a>(s,<span class="number">3</span>)</code> where <code class="koka">s</code> becomes the first argument. Similarly, <code class="koka">c<span class="kw op">.</span>int</code>
converts a character to an integer by calling <code class="koka">int(c)</code> (and both expressions
are equivalent). The dot notation is intu&#239;tive and quite convenient to
chain multiple calls together, as in:
</p><pre class="koka source"><span class="plaincode">fun showit( s : string ) { s.encode(3).count.println }
</span><span class="nicecode"><span class="decl-fun" id="showit"><span class="kw">fun</span> <a class="pp" href="#showit">showit<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>showit: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) { <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="#encode">encode<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<span class="number">3</span>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#count_1">count<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>count<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println_1">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> </span>}
</span></pre>



<p class="p noindent">for example (where the body desugars as <code class="koka">println(length(<a class="pp" href="#encode">encode<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a>(s,<span class="number">3</span>)))</code>). An
advantage of the dot notation as syntactic sugar for function calls is that it
is easy to extend the &#8216;primitive&#8217; methods of any data type: just write a new
function that takes that type as its first argument. In most object-oriented
languages one would need to add that method to the class definition itself
which is not always possible if such class came as a library for example.
</p><h3 id="sec-type-inference" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-type-inference" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.1.3</span>.&#8194;</span>Type Inference</h3>
<p class="p noindent">Koka is also strongly typed. It uses a powerful type inference engine to
infer most types, and types generally do not get in the way. In
particular, you can always leave out the types of any local variables.
This is the case for example for <code class="code code2">base</code> and <code class="code code2">rot</code> values in the
previous example; hover with the mouse over the example to see the types
that were inferred by Koka. Generally, it is good practice though to
write type annotations for function parameters and the function result
since it both helps with type inference, and it provides useful
documentation with better feedback from the compiler.
</p>
<p class="p indent">For the <code class="koka"><a class="pp" href="#encode">encode<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a></code> function it is actually essential to give the type of
the <code class="koka">s</code> parameter: since the <code class="koka">map</code> function is defined for both <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-&gt;</span> <span class="tp">V</span></span></a></code>
and <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a></code> types and the program is ambiguous without an annotation.
Try to load the example in the editor and remove the annotation to see
what error Koka produces.
</p><h3 id="sec-anon" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-anon" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.1.4</span>.&#8194;</span>Anonymous Functions and Trailing Lambdas</h3>
<p class="p noindent">Koka also allows for anonymous function expressions using the <code class="koka"><span class="kw">fn</span></code> keyword.
For example, instead of
declaring the <code class="koka">encode<span class="dash">-</span>char</code> function, we can also pass it directly to
the <code class="koka">map</code> function as a function expression:
</p><pre class="koka source"><span class="plaincode">fun encode2( s : string, shift : int )
{
  s.map( fn(c) {
    if (c &lt; 'a' || c &gt; 'z') return c
    val base = (c - 'a').int
    val rot  = (base + shift) % 26
    (rot.char + 'a')
  });
}
</span><span class="nicecode"><span class="decl-fun" id="encode2"><span class="kw">fun</span> <a class="pp" href="#encode2">encode2<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>encode2: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">shift<span class="pc">shift: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> )
{
  <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#map_6">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.6</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">string</span></span></a>( <span class="kw">fn</span>(<a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a>) {
    <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_lt_">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;): <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">,</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="st">'a'</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_gt_">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;): <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">,</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="st">'z'</span>) <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">char</span></span></a> <a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a>
    <span class="kw">val</span> <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a> <span class="kw">=</span> (<a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash__4">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.4</span>: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">char</span></span></a> <span class="st">'a'</span>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#int">int<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
    <span class="kw">val</span> <a class="pp">rot<span class="pc">rot: <span class="tp">int</span></span></a>  <span class="kw">=</span> (<a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">shift<span class="pc">shift: <span class="tp">int</span></span></a>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">26</span>
    (<a class="pp">rot<span class="pc">rot: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#char">char<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>char: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__4">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.4</span>: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">char</span></span></a> <span class="st">'a'</span>)
  });
</span>}
</span></pre>



<p class="p noindent">It is a bit annoying we had to put the final right-parenthesis after the last
brace in the previous example. As a convenience, Koka allows anonymous functions to <em class="em-low1">follow</em>
the function call instead &#8211; this is also known as <em class="em-low1">trailing lambdas</em>. 
For example, here is how we can print the numbers
<code class="code code2">1</code> to <code class="code code2">10</code>:
</p><pre class="koka source"><span class="plaincode">fun main() { print10() }

fun print10()
{
  for(1,10) fn(i) {
    println(i)
  }
}
</span><span class="nicecode"><span class="decl-fun" id="print10"><span class="kw">fun</span> <a class="pp" href="#print10">print10<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>print10: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>()
{
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#for">for<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>for: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">end</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="number">1</span>,<span class="number">10</span>) <span class="kw">fn</span>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>) {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println_1">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>)
  }
</span>}
</span></pre>



<p class="p noindent">which is desugared to <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#for">for<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>for: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">end</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( <span class="number">1</span>, <span class="number">10</span>, <span class="kw">fn</span>(i){ println(i) } )</code>. (In fact, since we
pass the <code class="koka">i</code> argument directly to <code class="koka">println</code>, we could have also passed the function itself
directly, and write <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#for">for<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>for: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">end</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="number">1</span>,<span class="number">10</span>,println)</code>.)
</p>
<p class="p indent">Anonymous functions without any arguments can be shortened further by leaving
out the <code class="koka"><span class="kw">fn</span></code> keyword as well and just use braces directly. Here is an example using
the <code class="koka">repeat</code> function:
</p><pre class="koka source"><span class="plaincode">fun main() { printhi10() }

fun printhi10()
{
  repeat(10) {
    println("hi")
  }
}
</span><span class="nicecode"><span class="decl-fun" id="printhi10"><span class="kw">fun</span> <a class="pp" href="#printhi10">printhi10<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>printhi10: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>()
{
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#repeat_1">repeat<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>repeat<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="number">10</span>) {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"hi"</span>)
  }
</span>}
</span></pre>



<p class="p noindent">where the body desugars to <code class="koka">repeat( <span class="number">10</span>, <span class="kw">fn</span>(){println(</code><code class="koka">hi</code><code class="koka">)} )</code>. The is
especially convenient for the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> loop since this is not a built-in
control flow construct but just a regular function:
</p><pre class="koka source"><span class="plaincode">fun main() { print11() }

fun print11() {
  var i := 10
  while { i &gt;= 0 } {
    println(i)
    i := i - 1
  }
}
</span><span class="nicecode"><span class="decl-fun" id="print11"><span class="kw">fun</span> <a class="pp" href="#print11">print11<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>print11: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_scope">i<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>scope: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a> <span class="kw op">:=</span> <span class="number">10</span>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> { <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_gt__eq__1">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">0</span> } {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println_1">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>)
    <a class="pp">i<span class="pc">i: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">2691</span>,int<span class="op">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span>
  }
</span>}
</span></pre>



<p class="p noindent">Note how the first argument to <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> is in braces instead of the usual
parenthesis. In Koka, an expression between <em class="em-low1">parenthesis</em> is always evaluated
before a function call, whereas an expression between <em class="em-low1">braces</em> (ah,
<em class="em-low1">suspenders</em>!) is suspended and may be never evaluated or more than once
(as in our example). 
</p><h3 id="sec-with" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-with" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.1.5</span>.&#8194;</span>With Statements</h3>
<p class="p noindent">To the best of our knowledge, Koka was the first language to have
generalized <em class="em-low1">trailing lambdas</em>. It was also one of the first languages
to have <em class="em-low1">dot notation</em> (This was independently developed but it turns out
the D language has a similar feature (called&nbsp;<a href="https://tour.dlang.org/tour/en/gems/uniform-function-call-syntax-ufcs">UFCS</a>) which predates dot-notation). Another novel 
syntactical feature is the <code class="koka"><span class="kw">with</span></code> statement.
With the ease of passing a function block as a parameter, these
often become nested. For example:
</p><pre class="koka source"><span class="plaincode">fun twice(f) {
  f()
  f()
}

fun test-twice() {
  twice( fn(){
    twice( fn(){
      println("hi")
    })
  })
}
</span><span class="nicecode"><span class="decl-fun" id="twice"><span class="kw">fun</span> <a class="pp" href="#twice">twice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>twice: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>(<a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;3075</span> <span class="tp tv">&#95;3076</span></span></a>) {
  <a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;3075</span> <span class="tp tv">&#95;3076</span></span></a>()
  <a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;3075</span> <span class="tp tv">&#95;3076</span></span></a>()
</span>}

<span class="decl-fun" id="test_twice"><span class="kw">fun</span> <a class="pp" href="#test_twice">test-twice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>test<span class="dash">-</span>twice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <a class="pp" href="#twice">twice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>twice: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>( <span class="kw">fn</span>(){
    <a class="pp" href="#twice">twice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>twice: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>( <span class="kw">fn</span>(){
      <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"hi"</span>)
    })
  })
</span>}
</span></pre>


<p class="p noindent">where <code class="koka"><span class="st">&#34;hi&#34;</span></code> is printed four times. Using the <code class="koka"><span class="kw">with</span></code> statement 
we can write this more concisely as:
</p><pre class="koka source"><span class="plaincode">public fun test-with1() {
  with twice
  with twice
  println("hi")
}
</span><span class="nicecode"><span class="decl-fun" id="test_with1"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="#test_with1">test-with1<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>test<span class="dash">-</span>with1: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <span class="kw">with</span> <a class="pp" href="#twice">twice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>twice: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>
  <span class="kw">with</span> <a class="pp" href="#twice">twice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>twice: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"hi"</span>)
</span>}
</span></pre>



<p class="p noindent">The <code class="koka"><span class="kw">with</span></code> statement essentially puts all statements that follow it into 
an anynomous function block and passes that as the last parameter. In general:
</p>
<div class="translate" style="border:1px solid #AAA;padding:0em 1em;margin:1em 0em">
<p class="p boxed-label noindent" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">translation</p>
<div class="translate-row"><pre class="koka source unchecked"><span class="plaincode">with f(e1,...,eN)
&lt;body&gt;
</span><span class="nicecode"><span class="kw">with</span> f(e1,<span class="op">...</span>,eN)
<span class="op">&lt;</span>body<span class="op">&gt;</span>
</span></pre>


<p class="p noindent"><span class="mapsto" style="padding:0ex 1em;align-self:center;font-size:125%"><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.4371em;width:1.0890em" viewBox='34.67 57.872 10.371 4.163'><desc>$\mathpre{\rightsquigarrow}$</desc><g id='math-f156e3'><use x='34.869' y='61.836' xlink:href='#g4-32'/></g></svg></span>
</p><pre class="koka source unchecked"><span class="plaincode">f(e1,...,eN, fn(){ &lt;body&gt; })
</span><span class="nicecode">f(e1,<span class="op">...</span>,eN, <span class="kw">fn</span>(){ <span class="op">&lt;</span>body<span class="op">&gt;</span> })
</span></pre>
</div></div>
<p class="p noindent">Moreover, a <code class="koka"><span class="kw">with</span></code> statement can also bind a variable parameter as:
</p>
<div class="translate" style="border:1px solid #AAA;padding:0em 1em;margin:1em 0em">
<p class="p boxed-label noindent" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">translation</p>
<div class="translate-row"><pre class="koka source unchecked"><span class="plaincode">with x = f(e1,...,eN)
&lt;body&gt;
</span><span class="nicecode"><span class="kw">with</span> x <span class="kw">=</span> f(e1,<span class="op">...</span>,eN)
<span class="op">&lt;</span>body<span class="op">&gt;</span>
</span></pre>


<p class="p noindent"><span class="mapsto" style="padding:0ex 1em;align-self:center;font-size:125%"><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.4371em;width:1.0890em" viewBox='34.67 57.872 10.371 4.163'><desc>$\mathpre{\rightsquigarrow}$</desc><g id='math-f156e3'><use x='34.869' y='61.836' xlink:href='#g4-32'/></g></svg></span>
</p><pre class="koka source unchecked"><span class="plaincode">f(e1,...,eN, fn(x){ &lt;body&gt; })
</span><span class="nicecode">f(e1,<span class="op">...</span>,eN, <span class="kw">fn</span>(x){ <span class="op">&lt;</span>body<span class="op">&gt;</span> })
</span></pre>
</div></div>
<p class="p noindent">Here is an example using <code class="koka">foreach</code> to span over the rest of the function body:
</p><pre class="koka source"><span class="plaincode">public fun test-with2() {
  with x = list(1,10).foreach
  println(x)
}
</span><span class="nicecode"><span class="decl-fun" id="test_with2"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="#test_with2">test-with2<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>test<span class="dash">-</span>with2: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <span class="kw">with</span> <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#list">list<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp sp">(</span><span class="tp tpp">lo</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">hi</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>(<span class="number">1</span>,<span class="number">10</span>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#foreach">foreach<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>foreach: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println_1">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>)
</span>}
</span></pre>



<p class="p noindent">which desugars to <code class="koka">list(<span class="number">1</span>,<span class="number">10</span>)<span class="kw op">.</span>foreach( <span class="kw">fn</span>(x){ println(x) } )</code>. 
This is a bit reminiscent of Haskell <code class="code code2">do</code> notation. 
Using the <code class="koka"><span class="kw">with</span></code> statement this way may look a bit strange at first
but is very convenient in practice &#8211; it helps thinking of <code class="koka"><span class="kw">with</span></code> as
a closure over the rest of the lexical scope. 
</p><h4 id="sec-with-finally" class="h4" data-heading-depth="4" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">With Finally</h4>
<p class="p noindent">As another example, the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#finally">finally<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>finally: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">fin</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a></code> function takes as it first argument a
function that is run when exiting the scope &#8211; either normally, 
or through an &#8220;exception&#8221; (i.e. when an effect operation does not resume).
Again, <code class="koka"><span class="kw">with</span></code> is a natural fit:
</p><pre class="koka source"><span class="plaincode">fun test-finally() {
  with finally{ println("exiting..") }
  println("entering..")
  throw("oops") + 42
}
</span><span class="nicecode"><span class="decl-fun" id="test_finally"><span class="kw">fun</span> <a class="pp" href="#test_finally">test-finally<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>test<span class="dash">-</span>finally: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">&gt;</span> <span class="tp">int</span></span></a>() {
  <span class="kw">with</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#finally">finally<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>finally: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fin</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>{ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"exiting.."</span>) }
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"entering.."</span>)
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#throw">throw<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>throw: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">message</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">info</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">exception<span class="dash">-</span>info</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp tv">a</span></span></a>(<span class="st">"oops"</span>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">42</span>
</span>}
</span></pre>


<p class="p noindent">which desugars to <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#finally">finally<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>finally: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">fin</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>(<span class="kw">fn</span>(){ println<span class="op">...</span> }, <span class="kw">fn</span>(){ println(<span class="st">&#34;entering&#34;</span>); throw(<span class="st">&#34;oops&#34;</span>) <span class="op">+</span> <span class="number">42</span> })</code>,
and prints:
</p>
<pre class="para-block pre-fenced pre-fenced4" style="display:block"><code>entering..
exiting..
uncaught exception: oops</code></pre>
<p class="p noindent para-continued">This is another example of the <em class="em-low1">min-gen</em> principle: many languages have
have special built-in support for this kind of pattern, like a <code class="code code2">defer</code> statement, but in Koka
it is all just function applications with minimal syntactic sugar.
</p>
<p class="p indent"><a href="#sec-resource" class="learn button localref">Read more about initially and finally handlers <span class="fa fa-angle-double-down"></span></a>
</p><h4 id="sec-with-handlers" class="h4" data-heading-depth="4" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">With Handlers</h4>
<p class="p noindent">The <code class="koka"><span class="kw">with</span></code> statement is especially useful in combination with 
effect handlers. Generally, a <code class="koka"><span class="kw">handler</span>{ <span class="op">&#60;</span>ops<span class="op">&#62;</span> }</code> expression takes 
as its last argument a function block so it can be used directly with <code class="koka"><span class="kw">with</span></code>. 
Here is an example of an effect handler for emitting messages:
</p><pre class="koka source"><span class="plaincode">effect fun emit(msg : string) : ()

fun hello() {
  emit("hello world!")
}

public fun emit-console1() {
  with handler{ fun emit(msg){ println(msg) } }
  hello()
}
</span><span class="nicecode"><span class="decl-type" id="type_space_emit"><span class="tp kw">effect</span> <span class="kw">fun</span> <span class="decl-fun" id="emit"><a class="pp" href="#emit">emit<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></span></span>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a>

<span class="decl-fun" id="hello"><span class="kw">fun</span> <a class="pp" href="#hello">hello<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>hello: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <a class="pp" href="#emit">emit<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"hello world!"</span>)
</span>}

<span class="decl-fun" id="emit_console1"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="#emit_console1">emit-console1<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit<span class="dash">-</span>console1: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <span class="kw">with</span> <a class="pp"><span class="kw">handler</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp sp">,</span><span class="tp">console</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>{ <span class="kw">fun</span> <a class="pp">emit<span class="pc">emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>) } }
  <a class="pp" href="#hello">hello<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>hello: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>()
</span>}
</span></pre>


<p class="p noindent">In this example, the <code class="koka"><span class="kw">with</span></code> desugars to <code class="koka">(<span class="kw">handler</span>{ <span class="kw">fun</span> emit(msg){ println(msg) } })( <span class="kw">fn</span>(){ <a class="pp" href="#hello">hello<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>hello: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() } )</code>.
</p>
<p class="p indent">Moreover, as a convenience, we can leave out the <code class="koka"><span class="kw">handler</span></code> keyword 
for effects that define just one operation (like <code class="koka"><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a></code>):
</p>
<div class="translate" style="border:1px solid #AAA;padding:0em 1em;margin:1em 0em">
<p class="p boxed-label noindent" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">translation</p>
<div class="translate-row"><pre class="koka source unchecked"><span class="plaincode">with val op = &lt;expr&gt; 
with fun op(x){ &lt;body&gt; }
with except op(x){ &lt;body&gt; }
with control op(x){ &lt;body&gt; }
</span><span class="nicecode"><span class="kw">with</span> <span class="kw">val</span> op <span class="kw">=</span> <span class="op">&lt;</span>expr<span class="op">&gt;</span> 
<span class="kw">with</span> <span class="kw">fun</span> op(x){ <span class="op">&lt;</span>body<span class="op">&gt;</span> }
<span class="kw">with</span> <span class="kw">except</span> op(x){ <span class="op">&lt;</span>body<span class="op">&gt;</span> }
<span class="kw">with</span> <span class="kw">control</span> op(x){ <span class="op">&lt;</span>body<span class="op">&gt;</span> }
</span></pre>


<p class="p noindent"><span class="mapsto" style="padding:0ex 1em;align-self:center;font-size:125%"><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.4371em;width:1.0890em" viewBox='34.67 57.872 10.371 4.163'><desc>$\mathpre{\rightsquigarrow}$</desc><g id='math-f156e3'><use x='34.869' y='61.836' xlink:href='#g4-32'/></g></svg></span>
</p><pre class="koka source unchecked"><span class="plaincode">with handler{ val op = &lt;expr&gt; }
with handler{ fun op(x){ &lt;body&gt; } }
with handler{ except op(x){ &lt;body&gt; } }
with handler{ control op(x){ &lt;body&gt; } }
</span><span class="nicecode"><span class="kw">with</span> <span class="kw">handler</span>{ <span class="kw">val</span> op <span class="kw">=</span> <span class="op">&lt;</span>expr<span class="op">&gt;</span> }
<span class="kw">with</span> <span class="kw">handler</span>{ <span class="kw">fun</span> op(x){ <span class="op">&lt;</span>body<span class="op">&gt;</span> } }
<span class="kw">with</span> <span class="kw">handler</span>{ <span class="kw">except</span> op(x){ <span class="op">&lt;</span>body<span class="op">&gt;</span> } }
<span class="kw">with</span> <span class="kw">handler</span>{ <span class="kw">control</span> op(x){ <span class="op">&lt;</span>body<span class="op">&gt;</span> } }
</span></pre>
</div></div>
<p class="p noindent">Using this, we can write the previous example in a more concise and natural way as:
</p><pre class="koka source"><span class="plaincode">public fun emit-console2() {
  with fun emit(msg){ println(msg) }
  hello()
}
</span><span class="nicecode"><span class="decl-fun" id="emit_console2"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="#emit_console2">emit-console2<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit<span class="dash">-</span>console2: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp sp">,</span><span class="tp">console</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <span class="kw">fun</span> <a class="pp">emit<span class="pc">emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>) }
  <a class="pp" href="#hello">hello<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>hello: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">Intuitively, we can view the handler <code class="koka"><span class="kw">with</span> <span class="kw">fun</span> emit</code> as a dynamic binding of the function <code class="koka">emit</code>
over the rest of the scope.
</p>
<p class="p learn button indent"><a href="#sec-handlers" title="3.4.&#8194;Effect Handlers" class="localref" style="target-element:h2">Read more about effect handlers <span class="fa fa-angle-double-down"></span></a></p>
<p class="p learn button indent"><a href="#sec-opval" title="Value Operations" class="localref" style="target-element:h4">Read more about <code class="koka"><span class="kw">val</span></code> operations <span class="fa fa-angle-double-down"></span></a></p><h3 id="sec-default" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-default" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.1.6</span>.&#8194;</span>Optional and Named Parameters</h3>
<p class="p noindent">Being a function-oriented language, Koka has powerful support for function
calls where it supports both optional and named parameters. For example, the
function <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#replace_all">replace<span class="dash">-</span>all<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>replace<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">pattern</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">repl</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a></code> takes a string, a pattern (named <code class="code code2">pattern</code>), and
a replacement string (named <code class="code code2">repl</code>):
</p><pre class="koka source"><span class="plaincode">fun main() { println(world()) }

fun world() {
  replace-all("hi there", "there", "world")  // returns "hi world"
}
</span><span class="nicecode"><span class="decl-fun" id="world"><span class="kw">fun</span> <a class="pp" href="#world">world<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>world: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>() {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#replace_all">replace-all<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>replace<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">pattern</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">repl</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<span class="st">"hi there"</span>, <span class="st">"there"</span>, <span class="st">"world"</span>)  <span class="comment">// returns "hi world"
</span></span>}
</span></pre>



<p class="p noindent">Using named parameters, we can also write the function call as:
</p><pre class="koka source"><span class="plaincode">fun main() { println(world2()) }

fun world2() {
  "hi there".replace-all( repl="world", pattern="there" )
}
</span><span class="nicecode"><span class="decl-fun" id="world2"><span class="kw">fun</span> <a class="pp" href="#world2">world2<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>world2: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>() {
  <span class="st">"hi there"</span><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#replace_all">replace-all<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>replace<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">pattern</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">repl</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( repl<span class="kw">=</span><span class="st">"world"</span>, pattern<span class="kw">=</span><span class="st">"there"</span> )
</span>}
</span></pre>



<p class="p noindent">Optional parameters let you specify default values for parameters that do not
need to be provided at a call-site.  As an example, let&#39;s define a function
<code class="koka"><a class="pp" href="#sublist">sublist<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>sublist: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">len</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code> that takes a list, a <code class="code code2">start</code> position, and the length <code class="code code2">len</code> of the desired
sublist.  We can make the <code class="code code2">len</code> parameter optional and by default return all
elements following the <code class="code code2">start</code> position by picking the length of the input list by
default:
</p><pre class="koka source"><span class="plaincode">fun main() { println( ['a','b','c'].sublist(1).string ) }

fun sublist( xs : list&lt;a&gt;, start : int, len : int = xs.length ) : list&lt;a&gt; {
  if (start &lt;= 0) return xs.take(len)
  match(xs) {
    Nil        -&gt; Nil
    Cons(&#95;,xx) -&gt; xx.sublist(start - 1, len)
  }
}
</span><span class="nicecode"><span class="decl-fun" id="sublist"><span class="kw">fun</span> <a class="pp" href="#sublist">sublist<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>sublist: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">len</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">7168</span><span class="op">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">len<span class="pc">len: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">7168</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#length_1">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>length<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">0</span>) <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">7168</span><span class="op">&gt;</span></span></a> <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">7168</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#take">take<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>take: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">len<span class="pc">len: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
  <span class="kw">match</span>(<a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">7168</span><span class="op">&gt;</span></span></a>) {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>        <span class="kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(&#95;,<a class="pp">xx<span class="pc">xx: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">7168</span><span class="op">&gt;</span></span></a>) <span class="kw op">-></span> <a class="pp">xx<span class="pc">xx: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">7168</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#sublist">sublist<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>sublist: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">len</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span>, <a class="pp">len<span class="pc">len: <span class="tp">int</span></span></a>)
  }
</span>}
</span></pre>



<p class="p noindent">Hover over the <code class="koka"><a class="pp" href="#sublist">sublist<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>sublist: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">len</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code> identifier to see its full type, where the <code class="code code2">len</code>
parameter has gotten an optional <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code> type signified by the question mark:
<code class="koka"><span class="op">:?</span>int</code>.
</p><h3 id="sec-a-larger-example--cracking-caesar-encoding" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-a-larger-example--cracking-caesar-encoding" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.1.7</span>.&#8194;</span>A larger example: cracking Caesar encoding</h3><pre class="koka source"><span class="plaincode">fun main() { test-uncaesar() }

fun encode( s : string, shift : int )
{
  function encode-char(c) {
    if (c &lt; 'a' || c &gt; 'z') return c
    val base = (c - 'a').int
    val rot  = (base + shift) % 26
    (rot.char + 'a')
  }

  s.map(encode-char)
}

// The letter frequency table for English
val english = [8.2,1.5,2.8,4.3,12.7,2.2,
               2.0,6.1,7.0,0.2,0.8,4.0,2.4,
               6.7,7.5,1.9,0.1, 6.0,6.3,9.1,
               2.8,1.0,2.4,0.2,2.0,0.1]

// Small helper functions
fun percent( n : int, m : int ) {
  100.0 &#42; (n.double / m.double)
}

fun rotate( xs, n ) {
  xs.drop(n) ++ xs.take(n)
}

// Calculate a frequency table for a string
fun freqs( s : string ) : list&lt;double&gt; {
  val lowers = list('a','z')
  val occurs = lowers.map( fn(c){ s.count(c.string) })
  val total  = occurs.sum
  occurs.map( fn(i){ percent(i,total) } )
}

// Calculate how well two frequency tables match according
// to the &#95;chi-square&#95; statistic.
fun chisqr( xs : list&lt;double&gt;, ys : list&lt;double&gt; ) : double {
  zipwith(xs,ys, fn(x,y){ ((x - y)^2.0)/y } ).foldr(0.0,(+))
}

// Crack a Caesar encoded string
fun uncaesar( s : string ) : string {
  val table  = freqs(s)                   // build a frequency table for &#96;s&#96;
  val chitab = list(0,25).map( fn(n) {    // build a list of chisqr numbers for each shift between 0 and 25
                  chisqr( table.rotate(n), english )
               })
  val min    = chitab.minimum()           // find the mininal element
  val shift  = chitab.index-of( fn(f){ f == min } ).negate  // and use its position as our shift
  s.encode( shift )
}

fun test-uncaesar() {
  println( uncaesar( "nrnd lv d ixq odqjxdjh" ) )
}
</span><span class="nicecode"><span class="comment">// The letter frequency table for English
</span><span class="decl-val" id="english"><span class="kw">val</span> <a class="pp" href="#english">english<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>english: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a><span class="number">8.2</span>,<span class="number">1.5</span>,<span class="number">2.8</span>,<span class="number">4.3</span>,<span class="number">12.7</span>,<span class="number">2.2</span>,
               <span class="number">2.0</span>,<span class="number">6.1</span>,<span class="number">7.0</span>,<span class="number">0.2</span>,<span class="number">0.8</span>,<span class="number">4.0</span>,<span class="number">2.4</span>,
               <span class="number">6.7</span>,<span class="number">7.5</span>,<span class="number">1.9</span>,<span class="number">0.1</span>, <span class="number">6.0</span>,<span class="number">6.3</span>,<span class="number">9.1</span>,
               <span class="number">2.8</span>,<span class="number">1.0</span>,<span class="number">2.4</span>,<span class="number">0.2</span>,<span class="number">2.0</span>,<span class="number">0.1</span></span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">]</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>

<span class="comment">// Small helper functions
</span><span class="decl-fun" id="percent"><span class="kw">fun</span> <a class="pp" href="#percent">percent<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>percent: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">m<span class="pc">m: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) {
  <span class="number">100.0</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> (<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">m<span class="pc">m: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>)
</span>}

<span class="decl-fun" id="rotate"><span class="kw">fun</span> <a class="pp" href="#rotate">rotate<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>rotate: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2853</span><span class="tp sp">&gt;</span></span></a>, <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> ) {
  <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2853</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#drop">drop<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>drop: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__plus_">++<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(++): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">ys</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2853</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#take">take<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>take: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>)
</span>}

<span class="comment">// Calculate a frequency table for a string
</span><span class="decl-fun" id="freqs"><span class="kw">fun</span> <a class="pp" href="#freqs">freqs<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>freqs: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <span class="kw">val</span> <a class="pp">lowers<span class="pc">lowers: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#list_2">list<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">lo</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">,</span> <span class="tp tpp">hi</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a>(<span class="st">'a'</span>,<span class="st">'z'</span>)
  <span class="kw">val</span> <a class="pp">occurs<span class="pc">occurs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp">lowers<span class="pc">lowers: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#map_5">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.5</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>( <span class="kw">fn</span>(<a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a>){ <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#count">count<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>count: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">pattern</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#string">string<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>) })
  <span class="kw">val</span> <a class="pp">total<span class="pc">total: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp">occurs<span class="pc">occurs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#sum">sum<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sum: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
  <a class="pp">occurs<span class="pc">occurs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#map_5">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.5</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>( <span class="kw">fn</span>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>){ <a class="pp" href="#percent">percent<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>percent: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>,<a class="pp">total<span class="pc">total: <span class="tp">int</span></span></a>) } )
</span>}

<span class="comment">// Calculate how well two frequency tables match according
</span><span class="comment">// to the &#95;chi-square&#95; statistic.
</span><span class="decl-fun" id="chisqr"><span class="kw">fun</span> <a class="pp" href="#chisqr">chisqr<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>chisqr: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">ys</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">ys<span class="pc">ys: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#zipwith">zipwith<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zipwith: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">c</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">ys</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">c</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">c</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>,<a class="pp">ys<span class="pc">ys: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>, <span class="kw">fn</span>(<a class="pp">x<span class="pc">x: <span class="tp">double</span></span></a>,<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>){ ((<a class="pp">x<span class="pc">x: <span class="tp">double</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash__3">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>)<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_hat_">^<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(^): <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">2.0</span>)<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> } )<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#foldr">foldr<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>foldr: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">z</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span></span></a>(<span class="number">0.0</span>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__3">(+)<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>)
</span>}

<span class="comment">// Crack a Caesar encoded string
</span><span class="decl-fun" id="uncaesar"><span class="kw">fun</span> <a class="pp" href="#uncaesar">uncaesar<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>uncaesar: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">table<span class="pc">table: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>  <span class="kw">=</span> <a class="pp" href="#freqs">freqs<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>freqs: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a>)                   <span class="comment">// build a frequency table for &#96;s&#96;
</span>  <span class="kw">val</span> <a class="pp">chitab<span class="pc">chitab: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#list">list<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp sp">(</span><span class="tp tpp">lo</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">hi</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>(<span class="number">0</span>,<span class="number">25</span>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#map_5">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.5</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>( <span class="kw">fn</span>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>) {    <span class="comment">// build a list of chisqr numbers for each shift between 0 and 25
</span>                  <a class="pp" href="#chisqr">chisqr<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>chisqr: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">ys</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp">table<span class="pc">table: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#rotate">rotate<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>rotate: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>), <a class="pp" href="#english">english<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>english: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> )
               })
  <span class="kw">val</span> <a class="pp">min<span class="pc">min: <span class="tp">double</span></span></a>    <span class="kw">=</span> <a class="pp">chitab<span class="pc">chitab: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#minimum_1">minimum<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>minimum<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>()           <span class="comment">// find the mininal element
</span>  <span class="kw">val</span> <a class="pp">shift<span class="pc">shift: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp">chitab<span class="pc">chitab: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#index_of">index-of<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>index<span class="dash">-</span>of: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">pred</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <span class="kw">fn</span>(<a class="pp">f<span class="pc">f: <span class="tp">double</span></span></a>){ <a class="pp">f<span class="pc">f: <span class="tp">double</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_eq__eq__2">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">min<span class="pc">min: <span class="tp">double</span></span></a> } )<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#negate">negate<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>negate: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>  <span class="comment">// and use its position as our shift
</span>  <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="#encode">encode<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <a class="pp">shift<span class="pc">shift: <span class="tp">int</span></span></a> )
</span>}

<span class="decl-fun" id="test_uncaesar"><span class="kw">fun</span> <a class="pp" href="#test_uncaesar">test-uncaesar<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>test<span class="dash">-</span>uncaesar: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( <a class="pp" href="#uncaesar">uncaesar<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>uncaesar: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <span class="st">"nrnd lv d ixq odqjxdjh"</span> ) )
</span>}
</span></pre>



<p class="p noindent">The <code class="koka"><span class="kw">val</span></code> keyword declares a static value. In the example, the value <code class="koka"><a class="pp" href="#english">english<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>english: <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">double</span><span class="tp sp">&#62;</span></span></a></code>
is a list of floating point numbers (of type <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a></code>) denoting the average
frequency for each letter. The function <code class="koka"><a class="pp" href="#freqs">freqs<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>freqs: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">double</span><span class="tp sp">&#62;</span></span></a></code> builds a frequency table for a
specific string, while the function <code class="koka"><a class="pp" href="#chisqr">chisqr<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>chisqr: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">double</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">ys</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">double</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">double</span></span></a></code> calculates how well two frequency
tables match. In the function <code class="koka">crack</code> these functions are used to find a
<code class="koka">shift</code> value that results in a string whose frequency table matches the
<code class="koka"><a class="pp" href="#english">english<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>english: <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">double</span><span class="tp sp">&#62;</span></span></a></code> one the closest &#8211; and we use that to decode the string. 
You can try out this example directly in the interactive environment:
</p>
<pre class="para-block pre-fenced pre-fenced4" style="display:block"><code>&gt; :l samples/basic/caesar.kk</code></pre><h2 id="sec-effect-types" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-effect-types" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.2</span>.&#8194;</span>Effect types</h2>
<p class="p noindent">A novel part about Koka is that it automatically infers all the <em class="em-low1">side effects</em>
that occur in a function. The absence of any effect is denoted as <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a></code> (or
<code class="koka"><span class="op">&#60;</span><span class="op">&#62;</span></code>) and corresponds to pure mathematical functions. If a function can raise
an exception the effect is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a></code>, and if a function may not terminate the
effect is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a></code> (for divergence). The combination of <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a></code> and <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a></code> is
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a></code> and corresponds directly to Haskell&#39;s notion of purity. Non-
deterministic functions get the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a></code> effect. The &#8216;worst&#8217; effect is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp">io</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a></code>
and means that a program can raise exceptions, not terminate, be non-
deterministic, read and write to the heap, and do any input/output operations.
Here are some examples of effectful functions:
</p><pre class="koka source"><span class="plaincode">fun square1( x : int ) : total int   { x&#42;x }
fun square2( x : int ) : console int { println( "a not so secret side-effect" ); x&#42;x }
fun square3( x : int ) : div int     { x &#42; square3( x ) }
fun square4( x : int ) : exn int     { throw( "oops" ); x&#42;x }
</span><span class="nicecode"><span class="decl-fun" id="square1"><span class="kw">fun</span> <a class="pp" href="#square1">square1<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>square1: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp"><span class="effect">total</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>   { <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> </span>}
<span class="decl-fun" id="square2"><span class="kw">fun</span> <a class="pp" href="#square2">square2<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>square2: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_console"><span class="tp"><span class="effect">console</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>console: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> { <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( <span class="st">"a not so secret side-effect"</span> ); <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> </span>}
<span class="decl-fun" id="square3"><span class="kw">fun</span> <a class="pp" href="#square3">square3<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>square3: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>     { <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="#square3">square3<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>square3: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> ) </span>}
<span class="decl-fun" id="square4"><span class="kw">fun</span> <a class="pp" href="#square4">square4<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>square4: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>     { <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#throw">throw<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>throw: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">message</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">info</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">exception<span class="dash">-</span>info</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp tv">a</span></span></a>( <span class="st">"oops"</span> ); <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> </span>}
</span></pre>



<p class="p noindent">When the effect is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a></code> we usually leave it out in the type annotation.
For example, when we write:
</p><pre class="koka source"><span class="plaincode">fun square5( x : int ) : int { x&#42;x }
</span><span class="nicecode"><span class="decl-fun" id="square5"><span class="kw">fun</span> <a class="pp" href="#square5">square5<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>square5: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> { <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> </span>}
</span></pre>



<p class="p noindent">the assumed effect is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a></code>. Sometimes, we write an effectful
function, but are not interested in explicitly writing down its effect type.
In that case, we can use a <em class="em-low1">wildcard type</em> which stands for some inferred
type. A wildcard type is denoted by writing an identifier prefixed with an
underscore, or even just an underscore by itself:
</p><pre class="koka source"><span class="plaincode">fun square6( x : int ) : &#95;e int {
  println("I did not want to write down the \"console\" effect")
  x&#42;x
}
</span><span class="nicecode"><span class="decl-fun" id="square6"><span class="kw">fun</span> <a class="pp" href="#square6">square6<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>square6: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp"><span class="tp tv"><span class="effect">&#95;e</span></span><span class="pc">&#95;e: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"I did not want to write down the \"console\" effect"</span>)
  <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>
</span>}
</span></pre>



<p class="p noindent">Hover over <code class="koka"><a class="pp" href="#square6">square6<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>square6: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">console</span> <span class="tp">int</span></span></a></code> to see the inferred effect for <code class="koka"><span class="tp tv">&#95;e</span></code>
</p><h3 id="sec-semantics-of-effects" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-semantics-of-effects" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.2.1</span>.&#8194;</span>Semantics of effects</h3>
<p class="p noindent">The inferred effects are not just considered as some extra type information on
functions. On the contrary, through the inference of effects, Koka has a very
strong connection to its denotational semantics. In particular, <em class="em-low1">the full type
of a Koka functions corresponds directly to the type signature of the
mathematical function that describes its denotational semantics</em>. For example,
using &#x301A;<code class="koka"><span class="tp tv">t</span></code>&#x301B; to translate a type <code class="koka"><span class="tp tv">t</span></code> into its corresponding
mathematical type signature, we have:
</p><table class="madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1">&#x301A;<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> <span class="tp kw op">-&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code>&#x301B;        </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> =&#160;&#160; </td><td class="tbody tr-odd tr-first col col-odd col-last" data-row="1" data-col="3"> <svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.7625em;width:3.2973em" viewBox='88.468 54.773 31.403 7.262'><desc>$\mathpre{\mathbb{Z}~\rightarrow \mathbb{Z}}$</desc><g id='math-d1ac51'><use x='88.667' y='61.836' xlink:href='#g3-90'/><use x='100.29' y='61.836' xlink:href='#g5-33'/><use x='113.02' y='61.836' xlink:href='#g3-90'/></g></svg>                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">&#x301A;<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> <span class="tp kw op">-&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code>&#x301B;          </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> =             </td><td class="tbody tr-even col col-odd col-last" data-row="2" data-col="3"> <svg  class="math-inline math-render-svg math" style="vertical-align:-0.2930em;height:1.0879em;width:6.3775em" viewBox='34.67 54.164 60.738 10.361'><desc>$\mathpre{\mathbb{Z}~\rightarrow (\mathbb{Z}~+~1)}$</desc><g id='math-2018f2'><use x='34.869' y='61.836' xlink:href='#g3-90'/><use x='46.492' y='61.836' xlink:href='#g5-33'/><use x='59.222' y='61.836' xlink:href='#g9-40'/><use x='63.097' y='61.836' xlink:href='#g3-90'/><use x='74.166' y='61.836' xlink:href='#g9-43'/><use x='86.343' y='61.836' xlink:href='#g9-49'/><use x='91.324' y='61.836' xlink:href='#g9-41'/></g></svg> </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1">&#x301A;<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> <span class="tp kw op">-&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code>&#x301B;         </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> =             </td><td class="tbody tr-odd col col-odd col-last" data-row="3" data-col="3"> <svg  class="math-inline math-render-svg math" style="vertical-align:-0.2930em;height:1.0879em;width:7.0835em" viewBox='88.468 54.164 67.462 10.361'><desc>$\mathpre{\mathbb{Z}~\rightarrow (\mathbb{Z}~+~1)_\bot}$</desc><g id='math-a0a446'><use x='88.667' y='61.836' xlink:href='#g3-90'/><use x='100.29' y='61.836' xlink:href='#g5-33'/><use x='113.02' y='61.836' xlink:href='#g9-40'/><use x='116.895' y='61.836' xlink:href='#g3-90'/><use x='127.964' y='61.836' xlink:href='#g9-43'/><use x='140.141' y='61.836' xlink:href='#g9-49'/><use x='145.122' y='61.836' xlink:href='#g9-41'/><use x='148.997' y='63.33' xlink:href='#g6-63'/></g></svg> </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="4" data-col="1">&#x301A;<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">E</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a><span class="tp sp">&#62;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code>&#x301B; </td><td class="tbody tr-even tr-last col col-even" data-row="4" data-col="2"> =             </td><td class="tbody tr-even tr-last col col-odd col-last" data-row="4" data-col="3"> <svg  class="math-inline math-render-svg math" style="vertical-align:-0.2930em;height:1.0879em;width:13.3600em" viewBox='34.67 54.164 127.238 10.361'><desc>$\mathpre{(\mathbb{Z}~\times \mathbb{H})~\rightarrow ((\mathbb{Z}~+~1)~\times \mathbb{H})_\bot}$</desc><g id='math-8962c2'><use x='34.869' y='61.836' xlink:href='#g9-40'/><use x='38.744' y='61.836' xlink:href='#g3-90'/><use x='49.813' y='61.836' xlink:href='#g5-2'/><use x='59.776' y='61.836' xlink:href='#g3-72'/><use x='67.524' y='61.836' xlink:href='#g9-41'/><use x='76.38' y='61.836' xlink:href='#g5-33'/><use x='89.11' y='61.836' xlink:href='#g9-40'/><use x='92.984' y='61.836' xlink:href='#g9-40'/><use x='96.859' y='61.836' xlink:href='#g3-90'/><use x='107.928' y='61.836' xlink:href='#g9-43'/><use x='120.105' y='61.836' xlink:href='#g9-49'/><use x='125.086' y='61.836' xlink:href='#g9-41'/><use x='133.388' y='61.836' xlink:href='#g5-2'/><use x='143.351' y='61.836' xlink:href='#g3-72'/><use x='151.1' y='61.836' xlink:href='#g9-41'/><use x='154.974' y='63.33' xlink:href='#g6-63'/></g></svg> </td></tr></tbody></table>
<p class="p noindent">In the above translation, we use <svg  class="math-inline math-render-svg math" style="vertical-align:-0.1130em;height:0.8031em;width:2.8851em" viewBox='88.468 55.216 27.477 7.649'><desc>$\mathpre{1~+~\tau}$</desc><g id='math-9d8190'><use x='88.667' y='61.836' xlink:href='#g9-49'/><use x='98.077' y='61.836' xlink:href='#g9-43'/><use x='110.253' y='61.836' xlink:href='#g7-28'/></g></svg> as a sum
where we have either a unit <svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.7160em;width:0.5659em" viewBox='88.468 55.216 5.39 6.819'><desc>$\mathpre{1}$</desc><g id='math-957e81'><use x='88.667' y='61.836' xlink:href='#g9-49'/></g></svg> (i.e. exception) or a type <svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.4922em;width:0.6186em" viewBox='88.468 57.347 5.891 4.688'><desc>$\mathpre{\tau}$</desc><g id='math-96ac5d'><use x='88.667' y='61.836' xlink:href='#g7-28'/></g></svg>, and we use
<svg  class="math-inline math-render-svg math" style="vertical-align:-0.1127em;height:0.8497em;width:2.7108em" viewBox='34.67 54.773 25.817 8.092'><desc>$\mathpre{\mathbb{H}\times \tau}$</desc><g id='math-fce135'><use x='34.869' y='61.836' xlink:href='#g3-72'/><use x='44.832' y='61.836' xlink:href='#g5-2'/><use x='54.794' y='61.836' xlink:href='#g7-28'/></g></svg> for a product consisting of a pair of a
heap and a type <svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.4922em;width:0.6186em" viewBox='88.468 57.347 5.891 4.688'><desc>$\mathpre{\tau}$</desc><g id='math-96ac5d'><use x='88.667' y='61.836' xlink:href='#g7-28'/></g></svg>. From the above correspondence, we can immediately see that
a <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a></code> function is truly total in the mathematical sense, while a stateful
function (<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">E</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code>) that can raise exceptions or not terminate (<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a></code>)
takes an implicit heap parameter, and either does not terminate (<svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.7683em;width:0.8565em" viewBox='34.67 54.718 8.157 7.317'><desc>$\mathpre{\bot}$</desc><g id='math-175c02'><use x='34.869' y='61.836' xlink:href='#g5-63'/></g></svg>) or
returns an updated heap together with either a value or an exception (<svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.7160em;width:0.5659em" viewBox='88.468 55.216 5.39 6.819'><desc>$\mathpre{1}$</desc><g id='math-957e81'><use x='88.667' y='61.836' xlink:href='#g9-49'/></g></svg>).
</p>
<p class="p indent">We believe that this semantic correspondence is the true power of full effect
types and it enables effective equational reasoning about the code by a
programmer. For almost all other existing programming languages, even the most
basic semantics immediately include complex effects like heap manipulation and
divergence. In contrast, Koka allows a layered semantics where we can easily
separate out nicely behaved parts, which is essential for many domains, like
safe LINQ queries, parallel tasks, tier-splitting, sand-boxed mobile code,
etc.
</p><h3 id="sec-combining-effects" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-combining-effects" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.2.2</span>.&#8194;</span>Combining effects</h3>
<p class="p noindent">Often, a function contains multiple effects, for example:
</p><pre class="koka source"><span class="plaincode">fun combine-effects() {
  val i = srandom-int() // non-deterministic
  throw("oops")         // exception raising
  combine-effects()     // and non-terminating
}
</span><span class="nicecode"><span class="decl-fun" id="combine_effects"><span class="kw">fun</span> <a class="pp" href="#combine_effects">combine-effects<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>combine<span class="dash">-</span>effects: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">pure</span><span class="tp sp">,</span><span class="tp">ndet</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span></span></a>() {
  <span class="kw">val</span> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_random.html#srandom_int">srandom-int<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>random<span class="fslash last">/</span></span>srandom<span class="dash">-</span>int: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ndet</span> <span class="tp">int</span></span></a>() <span class="comment">// non-deterministic
</span>  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#throw">throw<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>throw: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">message</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">info</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">exception<span class="dash">-</span>info</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp tv">a</span></span></a>(<span class="st">"oops"</span>)         <span class="comment">// exception raising
</span>  <a class="pp" href="#combine_effects">combine-effects<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>combine<span class="dash">-</span>effects: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">ndet</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">&gt;</span> <span class="tp tv">&#95;4514</span></span></a>()     <span class="comment">// and non-terminating
</span></span>}
</span></pre>



<p class="p noindent">The effect assigned to <code class="koka"><a class="pp" href="#combine_effects">combine<span class="dash">-</span>effects<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>combine<span class="dash">-</span>effects: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">pure</span><span class="tp sp">,</span><span class="tp">ndet</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span></span></a></code> are <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a></code>, <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a></code>, and <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a></code>. We
can write such combination as a <em class="em-low1">row</em> of effects as <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a><span class="tp sp">&#62;</span></code>. When
you hover over the <code class="koka"><a class="pp" href="#combine_effects">combine<span class="dash">-</span>effects<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>combine<span class="dash">-</span>effects: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">pure</span><span class="tp sp">,</span><span class="tp">ndet</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span></span></a></code> identifiers, you will see that the type
inferred is really <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a><span class="tp sp">&#62;</span></code> where <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a></code> is a type alias defined as
</p><pre class="koka source unchecked"><span class="plaincode">alias pure = &lt;div,exn&gt;
</span><span class="nicecode"><span class="tp kw">alias</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a> <span class="tp kw">=</span> <span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span>
</span></pre>



<h3 id="sec-polymorphic-effects" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-polymorphic-effects" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.2.3</span>.&#8194;</span>Polymorphic effects</h3>
<p class="p noindent">Many functions are polymorphic in their effect. For example, the
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#map">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">b</span><span class="tp sp">&#62;</span></span></a></code> function
applies a function <code class="koka">f</code> to each element of a (finite) list. As such, the effect
depends on the effect of <code class="koka">f</code>, and the type of <code class="koka">map</code> becomes:
</p><pre class="koka source unchecked"><span class="plaincode">map : (xs : list&lt;a&gt;, f : (a) -&gt; e b) -&gt; e list&lt;b&gt;
</span><span class="nicecode">map <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span>
</span></pre>



<p class="p noindent">We use single letters (possibly followed by digits) for polymorphic types.
Here, the <code class="koka">map</code> functions takes a list with elements of some type <code class="koka"><span class="tp tv">a</span></code>, and a
function <code class="code code2">f</code> that takes an element of type <code class="koka"><span class="tp tv">a</span></code> and returns a new element of
type <code class="koka"><span class="tp tv">b</span></code>. The final result is a list with elements of type <code class="koka"><span class="tp tv">b</span></code>. Moreover,
the effect of the applied function <code class="koka"><span class="tp tv">e</span></code> is also the effect of the <code class="koka">map</code>
function itself; indeed, this function has no other effect by itself since it
does not diverge, nor raises exceptions.
</p>
<p class="p indent">We can use the notation <code class="koka"><span class="tp sp">&#60;</span><span class="tp tv">l</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span></code> to extend an effect <code class="koka"><span class="tp tv">e</span></code> with another effect
<code class="koka"><span class="tp tv">l</span></code>. This is used for example in the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> function which has type:
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span> <span class="tp tpp">pred</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></code>.
The <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> function takes a
predicate function and an action to perform, both with effect <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span></code>.
Indeed, since while may diverge depending on the predicate its effect must
include divergence.
</p>
<p class="p indent">The reader may be worried that the type of <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> forces the predicate and
action to have exactly the same effect <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span></code>, which even includes
divergence. However, when effects are inferred at the call-site, both the
effects of predicate and action are extended automatically until they match.
This ensures we take the union of the effects in the predicate and action.
Take for example the following loop
</p><pre class="koka source"><span class="plaincode">fun looptest() {
  while { is-odd(srandom-int()) } {
    throw("odd")
  }
}
</span><span class="nicecode"><span class="decl-fun" id="looptest"><span class="kw">fun</span> <a class="pp" href="#looptest">looptest<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>looptest: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">pure</span><span class="tp sp">,</span><span class="tp">ndet</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> { <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#is_odd">is-odd<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>odd: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_random.html#srandom_int">srandom-int<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>random<span class="fslash last">/</span></span>srandom<span class="dash">-</span>int: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ndet</span> <span class="tp">int</span></span></a>()) } {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#throw">throw<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>throw: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">message</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">info</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">exception<span class="dash">-</span>info</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp tv">a</span></span></a>(<span class="st">"odd"</span>)
  }
</span>}
</span></pre>



<p class="p noindent">Koka infers that the predicate <code class="code code2">odd(srandom-int())</code> has
effect <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e1</span><span class="tp sp">&#62;</span></code> while the action has effect <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp kw op">|</span><span class="tp tv">e2</span><span class="tp sp">&#62;</span></code> for some <code class="koka"><span class="tp tv">e1</span></code> and <code class="koka"><span class="tp tv">e2</span></code>.
When applying <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code>, those
effects are unified to the type <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e3</span><span class="tp sp">&#62;</span></code> for some <code class="koka"><span class="tp tv">e3</span></code>.
</p><h3 id="sec-var" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-var" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.2.4</span>.&#8194;</span>Local Mutable Variables</h3>
<p class="p noindent">The Fibonacci numbers are a sequence where each subsequent Fibonacci number is
the sum of the previous two, where <code class="koka"><a class="pp" href="#fib">fib<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>fib: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">div</span> <span class="tp">int</span></span></a>(<span class="number">0</span>) <span class="op">==</span> <span class="number">0</span></code> and <code class="koka"><a class="pp" href="#fib">fib<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>fib: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">div</span> <span class="tp">int</span></span></a>(<span class="number">1</span>) <span class="op">==</span> <span class="number">1</span></code>. We can
easily calculate Fibonacci numbers using a recursive function:
</p><pre class="koka source"><span class="plaincode">fun main() { println(fib(10)) }

fun fib(n : int) : div int {
  if (n &lt;= 0)   then 0
  elif (n == 1) then 1
  else fib(n - 1) + fib(n - 2)
}
</span><span class="nicecode"><span class="decl-fun" id="fib"><span class="kw">fun</span> <a class="pp" href="#fib">fib<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>fib: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">int</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">0</span>)   <span class="kw">then</span> <span class="number">0</span>
  <span class="kw">elif</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">1</span>) <span class="kw">then</span> <span class="number">1</span>
  <span class="kw">else</span> <a class="pp" href="#fib">fib<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>fib: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">int</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="#fib">fib<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>fib: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">int</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">2</span>)
</span>}
</span></pre>



<p class="p noindent">Note that the type inference engine is currently not powerful enough to
prove that this recursive function always terminates, which leads to
inclusion of the divergence effect <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a></code> in the result type.
</p>
<p class="p indent">Here is another version of the Fibonacci function but this time
implemented using local mutable variables. 
We use the <code class="koka">repeat</code> function to iterate <code class="koka">n</code> times:
</p><pre class="koka source"><span class="plaincode">fun main() { println(fib2(10)) }

fun fib2(n) {
  var x := 0
  var y := 1
  repeat(n) {
    val y0 = y
    y := x+y
    x := y0
  }
  x
}
</span><span class="nicecode"><span class="decl-fun" id="fib2"><span class="kw">fun</span> <a class="pp" href="#fib2">fib2<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>fib2: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>) {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_scope">x<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>scope: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a> <span class="kw op">:=</span> <span class="number">0</span>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">2008</span>,int<span class="op">&gt;</span></span></a> <span class="kw op">:=</span> <span class="number">1</span>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#repeat_1">repeat<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>repeat<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>) {
    <span class="kw">val</span> <a class="pp">y0<span class="pc">y0: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>
    <a class="pp">y<span class="pc">y: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">2008</span>,int<span class="op">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>
    <a class="pp">x<span class="pc">x: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">2008</span>,int<span class="op">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp">y0<span class="pc">y0: <span class="tp">int</span></span></a>
  }
  <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>
</span>}
</span></pre>


<p class="p noindent">In contrast to a <code class="koka"><span class="kw">val</span></code> declaration that binds an immutable value (as in <code class="koka"><span class="kw">val</span> y0 <span class="kw">=</span> y</code>),
a <code class="koka"><span class="kw">var</span></code> declaration declares a <em class="em-low1">mutable</em> variable, where the <code class="koka"><span class="op">(:=)</span></code> operator 
can assign a new value to the variable. Internally, the <code class="koka"><span class="kw">var</span></code> declarations use 
a <em class="em-low1">state</em> effect handler which ensures
that the state has the proper semantics even if resuming multiple times.
</p>
<p class="p indent">However, that also means that mutable local variables are not quite first-class
and we cannot pass them as parameters to other functions for example (as they
are always dereferenced). The lifetime of mutable local variable cannot exceed
its lexical scope. For example, you get a type error if a local variable
escapes through a function expression:
</p><pre class="koka source unchecked"><span class="plaincode">fun wrong() : (() -&gt; console ()) {
  var x := 1
  (fn(){ x := x + 1; println(x) })
}
</span><span class="nicecode"><span class="kw">fun</span> wrong() <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_console"><span class="tp">console</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>console: <span class="tp">X</span></span></a> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> {
  <span class="kw">var</span> x <span class="kw op">:=</span> <span class="number">1</span>
  (<span class="kw">fn</span>(){ x <span class="kw op">:=</span> x <span class="op">+</span> <span class="number">1</span>; println(x) })
}
</span></pre>


<p class="p noindent">This restriction allows for a clean semantics but also for (future) optimizations
that are not possible for general mutable reference cells.
</p>
<p class="p learn button indent"><a href="#sec-multi-resume" title="3.4.10.&#8194;Resuming more than once" class="localref" style="target-element:h3">Read more about state and multiple resumptions <span class="fa fa-angle-double-down"></span></a></p><h3 id="sec-runst" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-runst" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.2.5</span>.&#8194;</span>Reference Cells and Isolated state</h3>
<p class="p noindent">Koka also has first-class heap allocated mutable reference cells. 
A reference to an
integer is allocated using <code class="koka"><span class="kw">val</span> r <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#ref">ref<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">(</span><span class="tp">alloc</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp">ref</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a>(<span class="number">0</span>)</code> (since the reference itself is
actually a value!), and can be dereferenced using the bang operator, as <code class="code code2">!r</code>.
We can write the Fibonacci function using reference cells as:
</p><pre class="koka source"><span class="plaincode">fun main() { println(fib3(10)) }

fun fib3(n) {
  val x = ref(0)
  val y = ref(1)
  repeat(n) {
    val y0 = !y
    y := !x + !y
    x := y0
  }
  return !x
}
</span><span class="nicecode"><span class="decl-fun" id="fib3"><span class="kw">fun</span> <a class="pp" href="#fib3">fib3<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>fib3: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>) {
  <span class="kw">val</span> <a class="pp">x<span class="pc">x: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2163</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#ref">ref<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<span class="number">0</span>)
  <span class="kw">val</span> <a class="pp">y<span class="pc">y: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2163</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#ref">ref<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<span class="number">1</span>)
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#repeat_1">repeat<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>repeat<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>) {
    <span class="kw">val</span> <a class="pp">y0<span class="pc">y0: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(!): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a><a class="pp">y<span class="pc">y: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2163</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>
    <a class="pp">y<span class="pc">y: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2163</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(!): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2163</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(!): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a><a class="pp">y<span class="pc">y: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2163</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>
    <a class="pp">x<span class="pc">x: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2163</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp">y0<span class="pc">y0: <span class="tp">int</span></span></a>
  }
  <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(!): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2163</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>
</span>}
</span></pre>



<p class="p noindent">As we can see, using <code class="koka"><span class="kw">var</span></code> declarations are generally preferred as these 
behave better under multiple resumptions, but also are syntactically more
concise as they do not need a dereferencing operator. (Nevertheless, we 
still need reference cells as those are first-class while <code class="koka"><span class="kw">var</span></code> variables
cannot be passed to other functions.)
</p>
<p class="p indent">When we look at the types inferred for the references, we see that <code class="koka">x</code> and <code class="koka">y</code>
have type <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ref"><span class="tp">ref</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp sp">(</span><span class="tp">H</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">V</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&#62;</span></code> which stands for a reference to a mutable value of
type <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code> in some heap <code class="koka"><span class="tp tv">h</span></code>. The effects on heaps are allocation as
<code class="koka"><span class="tp">heap</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code>, reading from a heap as <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">X</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code> and writing to a heap as
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_write"><span class="tp">write</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>write: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">X</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code>. The combination of these effects is called stateful and denoted
with the alias <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">E</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code>.
</p>
<p class="p indent">Clearly, the effect of the body of <code class="koka"><a class="pp" href="#fib3">fib3<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>fib3: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">E</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code>; but when we hover over
<code class="koka"><a class="pp" href="#fib3">fib3<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>fib3: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code>, we see the type inferred is actually the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a></code> effect: <code class="koka"><span class="tp sp">(</span><span class="tp tpp">n</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code>.
Indeed, even though <code class="koka"><a class="pp" href="#fib3">fib3<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>fib3: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> is stateful inside, its side-effects can
never be observed. It turns out that we can safely discard the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">E</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code>
effect whenever the heap type <code class="koka"><span class="tp tv">h</span></code> cannot be referenced outside this function,
i.e. it is not part of an argument or return type. More formally, the Koka
compiler proves this by showing that a function is fully polymorphic in the
heap type <code class="koka"><span class="tp tv">h</span></code> and applies the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#run">run<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>run: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">alloc</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span><span class="tp sp">,</span><span class="tp">write</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a></code> function (corresponding to <code class="code code2">runST</code> in
Haskell) to discard the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">E</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code> effect.
</p>
<p class="p indent">The Garsia-Wachs algorithm is nice example where side-effects are used
internally across function definitions and data structures, but where the
final algorithm itself behaves like a pure function, see the
<a href="https://github.com/koka-lang/koka/tree/master/samples/basic/garsia-wachs.kk" data-linkid="garsia-wachs" target="_top"><code class="code code2">samples/basic/garsia-wachs.kk</code></a>.
</p><h2 id="sec-data-types" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-data-types" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.3</span>.&#8194;</span>Data Types</h2><h3 id="sec-structs" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-structs" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.3.1</span>.&#8194;</span>Structs</h3>
<p class="p noindent">An important aspect of a function-oriented language is to be able to define
rich data types over which the functions work. A common data type is that of a
<em class="em-low1">struct</em> or <em class="em-low1">record</em>. Here is an example of a struct that contains information
about a person:
</p><pre class="koka source"><span class="plaincode">struct person { 
  age : int
  name : string
  realname : string = name
}

val brian = Person( 29, "Brian" )
</span><span class="nicecode"><span class="decl-type" id="type_space_person"><span class="tp kw">struct</span> <span class="decl-con" id="con_space_Person"><a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a> { 
  <span class="decl-fun" id="age"><a class="pp">age<span class="pc">age: <span class="tp">int</span></span></a></span> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>
  <span class="decl-fun" id="name"><a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a></span> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>
  <span class="decl-fun" id="realname"><a class="pp">realname<span class="pc">realname: <span class="tp">string</span></span></a></span> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a>
</span></span>}

<span class="decl-val" id="brian"><span class="kw">val</span> <a class="pp" href="#brian">brian<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>brian: <span class="tp">person</span></span></a> <span class="kw">=</span> <a class="pp" href="#con_space_Person"><span class="co">Person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Person: <span class="tp sp">(</span><span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">realname</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">person</span></span></a>( <span class="number">29</span>, <span class="st">"Brian"</span> </span>)
</span></pre>



<p class="p noindent">Every <code class="koka"><span class="tp kw">struct</span></code> (and other data types) come with constructor functions to
create instances, as in <code class="koka"><a class="pp" href="#con_space_Person"><span class="co">Person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Person: <span class="tp sp">(</span><span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">realname</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">person</span></span></a>(<span class="number">19</span>,<span class="st">&#34;Brian&#34;</span>)</code>. Moreover, these
constructors can use named arguments so we can also call the constructor
as <code class="koka"><a class="pp" href="#con_space_Person"><span class="co">Person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Person: <span class="tp sp">(</span><span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">realname</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">person</span></span></a>( <a class="pp" href="#name">name<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a> <span class="kw">=</span> <span class="st">&#34;Brian&#34;</span>, <a class="pp" href="#age">age<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a> <span class="kw">=</span> <span class="number">19</span>, <a class="pp" href="#realname">realname<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>realname: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a> <span class="kw">=</span> <span class="st">&#34;Brian H. Griffin&#34;</span> )</code>
which is quite close to regular record syntax but without any special rules;
it is just functions all the way down!
</p>
<p class="p indent">Also, Koka automatically generates accessor functions for each field in a
struct (or other data type), and we can access the <code class="koka"><a class="pp" href="#age">age<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> of a <code class="koka"><a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a></code> as
<code class="koka"><a class="pp" href="#brian">brian<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>brian: <span class="tp">person</span></span></a><span class="kw op">.</span><a class="pp" href="#age">age<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> (which is of course just syntactic sugar for <code class="koka"><a class="pp" href="#age">age<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a>(<a class="pp" href="#brian">brian<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>brian: <span class="tp">person</span></span></a>)</code>).
</p><h3 id="sec-copying" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-copying" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.3.2</span>.&#8194;</span>Copying</h3>
<p class="p noindent">By default, all structs (and other data types) are <em class="em-low1">immutable</em>. Instead of
directly mutating a field in a struct, we usually return a new struct where
the fields are updated. For example, here is a <code class="koka"><a class="pp" href="#birthday">birthday<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>birthday: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">person</span></span></a></code> function that
increments the <code class="koka"><a class="pp" href="#age">age<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> field:
</p><pre class="koka source"><span class="plaincode">fun main() { println( brian.birthday.age ) }

struct person { 
  age : int
  name : string
  realname : string = name 
}

val brian = Person( 29, "Brian" )

fun birthday( p : person ) : person {
  p( age = p.age + 1 )
}
</span><span class="nicecode"><span class="decl-fun" id="birthday"><span class="kw">fun</span> <a class="pp" href="#birthday">birthday<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>birthday: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">person</span></span></a>( <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a> {
  <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a>( age <span class="kw">=</span> <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a><span class="kw op">.</span><a class="pp" href="#age">age<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span> )
</span>}
</span></pre>



<p class="p noindent">Here, <code class="koka"><a class="pp" href="#birthday">birthday<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>birthday: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">person</span></span></a></code> returns a fresh <code class="koka"><a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a></code> which is equal to <code class="koka">p</code> but with the
<code class="koka"><a class="pp" href="#age">age<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> incremented. The syntax <code class="code code2">p(...)</code> is syntactic sugar for calling the copy constructor of
a <code class="koka"><a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a></code>. This constructor is also automatically generated for each data
type, and is internally generated as:
</p><pre class="koka source"><span class="plaincode">fun main() { println( brian.copy().age ) }

struct person( age : int, name : string, realname : string = name )

val brian = Person( 29, "Brian" )

fun copy( p, age = p.age, name = p.name, realname = p.realname ) {
  return Person(age, name, realname)
}
</span><span class="nicecode"><span class="decl-fun" id="copy"><span class="kw">fun</span> <a class="pp" href="#copy">copy<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>copy: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">,</span> <span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">realname</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">person</span></span></a>( <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a>, <a class="pp">age<span class="pc">age: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a><span class="kw op">.</span><a class="pp" href="#age">age<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">name<span class="pc">name: <span class="tp op">?</span><span class="tp">string</span></span></a> <span class="kw">=</span> <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a><span class="kw op">.</span><a class="pp" href="#name">name<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>, <a class="pp">realname<span class="pc">realname: <span class="tp op">?</span><span class="tp">string</span></span></a> <span class="kw">=</span> <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a><span class="kw op">.</span><a class="pp" href="#realname">realname<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>realname: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> ) {
  <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">person</span></span></a> <a class="pp" href="#con_space_Person"><span class="co">Person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Person: <span class="tp sp">(</span><span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">realname</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">person</span></span></a>(<a class="pp">age<span class="pc">age: <span class="tp">int</span></span></a>, <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a>, <a class="pp">realname<span class="pc">realname: <span class="tp">string</span></span></a>)
</span>}
</span></pre>



<p class="p noindent">When arguments follow a data value, as in <code class="code code2">p( age = age + 1)</code>, it is expanded to call this
copy function, as in <code class="koka">p<span class="kw op">.</span><a class="pp" href="#copy">copy<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>copy: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">,</span> <span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">realname</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">person</span></span></a>( <a class="pp" href="#age">age<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a> <span class="kw">=</span> p<span class="kw op">.</span><a class="pp" href="#age">age<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a><span class="op">+</span><span class="number">1</span> )</code>. In adherence with the <em class="em-low1">min-gen</em> principle,
there are no special rules for record updates but using plain function calls with optional
and named parameters.
</p><h3 id="sec-union" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-union" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.3.3</span>.&#8194;</span>Alternatives (or Unions)</h3>
<p class="p noindent">Koka also supports algebraic data types where there are multiple alternatives.
For example, here is an enumeration:
</p><pre class="koka source unchecked"><span class="plaincode">type color {
  Red
  Green
  Blue
}
</span><span class="nicecode"><span class="tp kw">type</span> <span class="tp">color</span> {
  <span class="co">Red</span>
  <span class="co">Green</span>
  <span class="co">Blue</span>
}
</span></pre>



<p class="p noindent">Special cases of these enumerated types are the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_void"><span class="tp">void</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>void: <span class="tp">V</span></span></a></code> type which has no
alternatives (and therefore there exists no value with this type), the unit
type <code class="koka"><a class="doc link" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space__lp__rp_"><span class="tp">()</span></a></code> which has just one constructor, also written as <code class="koka">()</code> (and
therefore, there exists only one value with the type <code class="koka"><a class="doc link" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space__lp__rp_"><span class="tp">()</span></a></code>, namely <code class="koka">()</code>), and
finally the boolean type <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a></code> with two constructors <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></code> and <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a></code>.
</p><pre class="koka source unchecked"><span class="plaincode">type void
type () {
  ()
}
type bool {
  False
  True
}
</span><span class="nicecode"><span class="tp kw">type</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_void"><span class="tp">void</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>void: <span class="tp">V</span></span></a>
<span class="tp kw">type</span> <span class="tp sp">(</span><span class="tp sp">)</span> {
  ()
}
<span class="tp kw">type</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>
}
</span></pre>



<p class="p noindent">Constructors can have parameters. For example, here is how to create a
<code class="koka"><span class="tp">number</span></code> type which is either an integer or the infinity value:
</p><pre class="koka source unchecked"><span class="plaincode">type number {
  Infinity
  Integer( i : int )
}
</span><span class="nicecode"><span class="tp kw">type</span> <span class="tp">number</span> {
  <span class="co">Infinity</span>
  <span class="co">Integer</span>( i <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> )
}
</span></pre>



<p class="p noindent">We can create such number by writing <code class="koka"><span class="co">Integer</span>(<span class="number">1</span>)</code> or <code class="koka"><span class="co">Infinity</span></code>. Moreover,
data types can be polymorphic and recursive. Here is the definition of the
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-&gt;</span> <span class="tp">V</span></span></a></code> type which is either empty (<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code>) or is a head element followed by a
tail list (<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code>):
</p><pre class="koka source unchecked"><span class="plaincode">type list&lt;a&gt; {
  Nil
  Cons{ head : a; tail : list&lt;a&gt; }
}
</span><span class="nicecode"><span class="tp kw">type</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>{ head <span class="tp kw op">:</span> <span class="tp tv">a</span>; tail <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> }
}
</span></pre>



<p class="p noindent">Koka automatically generates accessor functions for each named parameter. For
lists for example, we can access the head of a list as <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a>(<span class="number">1</span>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a>)<span class="kw op">.</span>head</code>.
</p>
<p class="p indent">We can now also see that <code class="koka"><span class="tp kw">struct</span></code> types are just syntactic sugar for regular a
<code class="koka"><span class="tp kw">type</span></code> with a single constructor of the same name as the type:
</p>
<div class="translate" style="border:1px solid #AAA;padding:0em 1em;margin:1em 0em">
<p class="p boxed-label noindent" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">translation</p>
<div class="translate-row"><pre class="koka source unchecked"><span class="plaincode">struct tp { &lt;fields&gt; }
</span><span class="nicecode"><span class="tp kw">struct</span> <span class="tp">tp</span> { <span class="op">&lt;</span>fields<span class="op">&gt;</span> }
</span></pre>


<p class="p noindent"><span class="mapsto" style="padding:0ex 1em;align-self:center;font-size:125%"><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.4371em;width:1.0890em" viewBox='34.67 57.872 10.371 4.163'><desc>$\mathpre{\rightsquigarrow}$</desc><g id='math-f156e3'><use x='34.869' y='61.836' xlink:href='#g4-32'/></g></svg></span>
</p><pre class="koka source unchecked"><span class="plaincode">type tp { 
  con Tp { &lt;fields&gt; }
}
</span><span class="nicecode"><span class="tp kw">type</span> <span class="tp">tp</span> { 
  <span class="kw">con</span> <span class="co">Tp</span> { <span class="op">&lt;</span>fields<span class="op">&gt;</span> }
}
</span></pre>
</div></div>
<p class="p noindent">For example,
our earlier <code class="koka"><a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a></code> struct, defined as
</p><pre class="koka source unchecked"><span class="plaincode">struct person{ age : int; name : string; realname : string = name }
</span><span class="nicecode"><span class="tp kw">struct</span> <a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a>{ <a class="pp" href="#age">age<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>; <a class="pp" href="#name">name<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>; <a class="pp" href="#realname">realname<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>realname: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#name">name<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> }
</span></pre>



<p class="p noindent">desugars to:
</p><pre class="koka source unchecked"><span class="plaincode">type person {
  Person{ age : int; name : string; realname : string = name }
}
</span><span class="nicecode"><span class="tp kw">type</span> <a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a> {
  <a class="pp" href="#con_space_Person"><span class="co">Person</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Person: <span class="tp sp">(</span><span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">realname</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">person</span></span></a>{ <a class="pp" href="#age">age<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>; <a class="pp" href="#name">name<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>; <a class="pp" href="#realname">realname<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>realname: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#name">name<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> }
}
</span></pre>


<h3 id="sec-matching" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-matching" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.3.4</span>.&#8194;</span>Matching</h3>
<p class="p noindent">Todo
</p><h3 id="sec-extensible-data-types" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-extensible-data-types" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.3.5</span>.&#8194;</span>Extensible Data Types</h3>
<p class="p noindent">Todo
</p><h3 id="sec-inductive-co-inductive-and-recursive-types" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-inductive-co-inductive-and-recursive-types" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.3.6</span>.&#8194;</span>Inductive, Co-inductive, and Recursive Types</h3>
<p class="p noindent">For the purposes of equational reasoning and termination checking, a <code class="koka"><span class="tp kw">type</span></code>
declaration is limited to finite inductive types. There are two more
declarations, namely <code class="koka">co <span class="tp kw">type</span></code> and <code class="koka">rec <span class="tp kw">type</span></code> that allow for co-inductive types,
and arbitrary recursive types respectively.
</p><h3 id="sec-value-types" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-value-types" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.3.7</span>.&#8194;</span>Value Types</h3>
<p class="p noindent">Value types are (non-recursive) data types that are not heap allocated
but passed on the stack as a value. Since data types are immutable, semantically
these types are equivalent but value types can be more efficient as they
avoid heap allocation and reference counting (or more expensive as they need copying 
instead of sharing a reference). 
</p>
<p class="p indent">By default, any non-recursive inductive datatype of a size upto 3 machine words (= 24 bytes 
on a 64-bit platform) is treated as a value type. For example, tuples and 3-tuples
are passed and returned by value. Usually, that means that such tuples are for
example returned in registers when compiling with optimization.
</p>
<p class="p indent">We can also force a type to be compiled as a value type by using the <code class="koka">value</code> keyword
in front of a <code class="koka"><span class="tp kw">type</span></code> or <code class="koka"><span class="tp kw">struct</span></code> declaration:
</p><pre class="koka source"><span class="plaincode">value struct argb{ alpha: int; color-red: int; color-green: int; color-blue: int }
</span><span class="nicecode">value <span class="decl-type" id="type_space_argb"><span class="tp kw">struct</span> <span class="decl-con" id="con_space_Argb"><a class="pp" href="#type_space_argb"><span class="tp">argb</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>argb: <span class="tp">V</span></span></a>{ <span class="decl-fun" id="alpha"><a class="pp">alpha<span class="pc">alpha: <span class="tp">int</span></span></a></span><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>; <span class="decl-fun" id="color_red"><a class="pp">color-red<span class="pc">color<span class="dash">-</span>red: <span class="tp">int</span></span></a></span><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>; <span class="decl-fun" id="color_green"><a class="pp">color-green<span class="pc">color<span class="dash">-</span>green: <span class="tp">int</span></span></a></span><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>; <span class="decl-fun" id="color_blue"><a class="pp">color-blue<span class="pc">color<span class="dash">-</span>blue: <span class="tp">int</span></span></a></span><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> </span></span>}
</span></pre>



<div class="advanced" style="border-left:1px solid #AAA;padding:0em 0em 0em 1em;margin:1em 0em">
<p class="p noindent"><span class="boxed-label" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">advanced</span>
</p><h4 id="sec-boxing" class="h4" data-heading-depth="4" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">Boxing</h4>
<p class="p noindent">To support generic polymorphism, sometimes value types are <em class="em-low1">boxed</em>. For example, a list
is polymorpic in its elements. That means that if we construct a list of tuples, like
<code class="koka">[(<span class="number">1</span>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>)]</code>, that the element <code class="koka">(<span class="number">1</span>,<span class="number">2</span>)</code> will be boxed and heap allocated &#8211; essentially 
the compiler transforms this expression into <code class="koka">[<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_Box"><span class="co">Box</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Box: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">unbox</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">box</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a>((<span class="number">1</span>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>)]</code> internally.
</p>
<p class="p indent">Note that for regular data types and <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code>&#39;s boxing is free (as in isomorphic). Moreover, value types
up to 63 bits (on a 64-bit platform) are boxed in-place and do not require heap allocation
(like <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int32"><span class="tp">int32</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int32: <span class="tp">V</span></span></a></code>). The <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a></code> type is also specialized; by default the Koka compiler
only heap allocates doubles when their absolute value is
outside the range 2<sup>-511</sup> up to 2<sup>512</sup> (excluding infinity and NaN)).
</p>
<p class="p indent">For performance sensitive code we may specialize certain polymorphic datatypes to
reduce allocations due to boxing. For example:
</p><pre class="koka source"><span class="plaincode">type mylist{ 
  con MyCons{ head1: int; head2: bool; mytail: mylist }
  con MyNil
}
</span><span class="nicecode"><span class="decl-type" id="type_space_mylist"><span class="tp kw">type</span> <a class="pp" href="#type_space_mylist"><span class="tp">mylist</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>mylist: <span class="tp">V</span></span></a>{ 
  <span class="decl-con" id="con_space_MyCons"><span class="kw">con</span> <span class="decl-fun" id="is_myCons"><a class="pp">MyCons<span class="pc">mylist: <span class="tp">mylist</span></span></a></span>{ <a class="pp">head1<span class="pc">head1: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>; <a class="pp">head2<span class="pc">head2: <span class="tp">bool</span></span></a><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a>; <a class="pp">mytail<span class="pc">mytail: <span class="tp">mylist</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_mylist"><span class="tp">mylist</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>mylist: <span class="tp">V</span></span></a> </span>}
  <span class="decl-con" id="con_space_MyNil"><span class="kw">con</span> <span class="decl-fun" id="is_myNil"><a class="pp">MyNil<span class="pc">mylist: <span class="tp">mylist</span></span></a></span></span>
</span>}
</span></pre>



<p class="p noindent">Our previous example becomes <code class="koka"><a class="pp" href="#con_space_MyCons"><span class="co">MyCons</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>MyCons: <span class="tp sp">(</span><span class="tp tpp">head1</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">head2</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">mytail</span> <span class="tp kw op">:</span> <span class="tp">mylist</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">mylist</span></span></a>(<span class="number">1</span>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>,<a class="pp" href="#con_space_MyNil"><span class="co">MyNil</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>MyNil: <span class="tp">mylist</span></span></a>)</code> now and is more efficient as it only needs
one allocation for the <code class="koka"><a class="pp" href="#con_space_MyCons"><span class="co">MyCons</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>MyCons: <span class="tp sp">(</span><span class="tp tpp">head1</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">head2</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">mytail</span> <span class="tp kw op">:</span> <span class="tp">mylist</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">mylist</span></span></a></code> without an indirection to a tuple.
In the future we hope to extend Koka to perform specialization automatically or by
using special directives.
</p></div><h2 id="sec-handlers" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-handlers" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4</span>.&#8194;</span>Effect Handlers</h2>
<p class="p noindent">Effect handlers&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#leijen:algeff" title="Type Directed Compilation of Row-typed Algebraic Effects
Leijen, 2017" class="bibref localref" style="target-element:bibitem"><span class="cite-number">8</span></a>, <a href="#pretnar:handlers" title="Handlers of Algebraic Effects
Plotkin and Pretnar, 2009" class="bibref localref" style="target-element:bibitem"><span class="cite-number">14</span></a>]</span> are a novel way to 
define control-flow abstractions and dynamic binding as user defined 
handlers &#8211; no need anymore to add special compiler extensions for
exceptions, iterators, async-await, probabilistic programming, etc. 
Moreover, these handlers can be composed freely so the interaction between,
say, async-await and exceptions as well-defined. 
</p><h3 id="sec-handling" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-handling" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4.1</span>.&#8194;</span>Handling</h3>
<p class="p noindent">Let&#39;s start with defining an exception effect of our own. The <code class="koka"><span class="tp kw">effect</span></code>
declaration defines a new type together with <em class="em-low1">operations</em>, for now
we use a <code class="koka"><span class="kw">control</span></code> operation:
</p><pre class="koka source"><span class="plaincode">effect raise {
  control raise( msg : string ) : a
}
</span><span class="nicecode"><span class="decl-type" id="type_space_raise"><span class="tp kw">effect</span> <span class="decl-con" id="con_space_Raise"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></span></span> {
  <span class="kw">control</span> <span class="decl-fun" id="raise"><a class="pp" href="#raise">raise<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">raise</span> <span class="tp tv">a</span></span></a></span>( <a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a>
}
</span></pre>



<p class="p noindent">This defines an effect type <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code> together with an operation
<code class="koka">raise</code> of type <code class="koka"><span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a> <span class="tp tv">a</span></code>. With the effect signature 
declared, we can already use the operations:
</p><pre class="koka source"><span class="plaincode">fun safe-divide( x : int, y : int ) : raise int {
  if (y==0) then raise("div-by-zero") else x / y
}
</span><span class="nicecode"><span class="decl-fun" id="safe_divide"><span class="kw">fun</span> <a class="pp" href="#safe_divide">safe-divide<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>safe<span class="dash">-</span>divide: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">raise</span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><span class="number">0</span>) <span class="kw">then</span> <a class="pp" href="#raise">raise<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">raise</span> <span class="tp tv">a</span></span></a>(<span class="st">"div-by-zero"</span>) <span class="kw">else</span> <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>
</span>}
</span></pre>


<p class="p noindent">where we see that the <code class="koka"><a class="pp" href="#safe_divide">safe<span class="dash">-</span>divide<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>safe<span class="dash">-</span>divide: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">raise</span> <span class="tp">int</span></span></a></code> function gets the <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code> effect
(since we use the <code class="koka">raise</code> operation in the body). Such an effect
type means that we can only evaluate the function in a context
where <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code> is <em class="em-low1">handled</em> (in other words, where it is &#8220;dynamically bound&#8221;, or
where we &#8220;have the <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code> capability&#8221;).
</p>
<p class="p indent">We can <em class="em-low1">handle</em> the effect by giving a concrete definition for the <code class="koka">raise</code> operation.
For example, we may always return a default value:
</p><pre class="koka source"><span class="plaincode">fun raise-const() : int {
  with handler {
    control raise(msg){ 42 }
  } 
  8 + safe-divide(1,0)
}
</span><span class="nicecode"><span class="decl-fun" id="raise_const"><span class="kw">fun</span> <a class="pp" href="#raise_const">raise-const<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise<span class="dash">-</span>const: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <span class="kw">with</span> <a class="pp"><span class="kw">handler</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">raise</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> {
    <span class="kw">control</span> <a class="pp">raise<span class="pc">raise: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">resume</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">&#95;6762</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;6761</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;6761</span> <span class="tp">int</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <span class="number">42</span> }
  } 
  <span class="number">8</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="#safe_divide">safe-divide<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>safe<span class="dash">-</span>divide: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">raise</span> <span class="tp">int</span></span></a>(<span class="number">1</span>,<span class="number">0</span>)
</span>}
</span></pre>


<p class="p noindent">The call <code class="koka"><a class="pp" href="#raise_const">raise<span class="dash">-</span>const<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise<span class="dash">-</span>const: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a>()</code> evaluates to <code class="koka"><span class="number">42</span></code> (not <code class="koka"><span class="number">50</span></code>).
When a <code class="koka">raise</code> is called (in <code class="koka"><a class="pp" href="#safe_divide">safe<span class="dash">-</span>divide<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>safe<span class="dash">-</span>divide: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">raise</span> <span class="tp">int</span></span></a></code>), it will <em class="em-low1">yield</em> to its innermost handler, unwind
the stack, and only then evaluate the operation definition &#8211; in this case just directly
returning <code class="koka"><span class="number">42</span></code> from the point where the handler is defined. 
Now we can see why it is called a <em class="em-low1">control</em>
operation as <code class="koka">raise</code> changes the regular linear control-flow and yields right 
back to its innermost handler from the original call site. 
Also note that <code class="koka"><a class="pp" href="#raise_const">raise<span class="dash">-</span>const<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise<span class="dash">-</span>const: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a></code> again and the handler discharged the
<code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code> effect.
</p>
<p class="p indent">The <code class="koka"><span class="kw">handler</span>{ <span class="op">&#60;</span>ops<span class="op">&#62;</span> }</code> expression is a function that itself expects a function 
argument over which the handler is scoped, as in <code class="koka">(<span class="kw">handler</span>{ <span class="op">&#60;</span>ops<span class="op">&#62;</span> })(action)</code>.
This works well in combination with the <code class="koka"><span class="kw">with</span></code> statement of course.
As a syntactic convenience, for single operations we can leave out the <code class="koka"><span class="kw">handler</span></code> keyword 
which is translated as:
</p>
<div class="translate" style="border:1px solid #AAA;padding:0em 1em;margin:1em 0em">
<p class="p boxed-label noindent" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">translation</p>
<div class="translate-row"><pre class="koka source unchecked"><span class="plaincode">with control op(&lt;args&gt;){ &lt;body&gt; }
</span><span class="nicecode"><span class="kw">with</span> <span class="kw">control</span> op(<span class="op">&lt;</span>args<span class="op">&gt;</span>){ <span class="op">&lt;</span>body<span class="op">&gt;</span> }
</span></pre>


<p class="p noindent"><span class="mapsto" style="padding:0ex 1em;align-self:center;font-size:125%"><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.4371em;width:1.0890em" viewBox='34.67 57.872 10.371 4.163'><desc>$\mathpre{\rightsquigarrow}$</desc><g id='math-f156e3'><use x='34.869' y='61.836' xlink:href='#g4-32'/></g></svg></span>
</p><pre class="koka source unchecked"><span class="plaincode">with handler { 
  control op(&lt;args&gt;){ &lt;body&gt; }
}
</span><span class="nicecode"><span class="kw">with</span> <span class="kw">handler</span> { 
  <span class="kw">control</span> op(<span class="op">&lt;</span>args<span class="op">&gt;</span>){ <span class="op">&lt;</span>body<span class="op">&gt;</span> }
}
</span></pre>
</div></div>
<p class="p noindent">With this translation, we can write the previous example more concisely as:
</p><pre class="koka source"><span class="plaincode">fun raise-const1() : int {
  with control raise(msg){ 42 }
  8 + safe-divide(1,0)
}
</span><span class="nicecode"><span class="decl-fun" id="raise_const1"><span class="kw">fun</span> <a class="pp" href="#raise_const1">raise-const1<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise<span class="dash">-</span>const1: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">raise</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="kw">control</span> <a class="pp">raise<span class="pc">raise: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">resume</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">&#95;6822</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;6821</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;6821</span> <span class="tp">int</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <span class="number">42</span> }
  <span class="number">8</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="#safe_divide">safe-divide<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>safe<span class="dash">-</span>divide: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">raise</span> <span class="tp">int</span></span></a>(<span class="number">1</span>,<span class="number">0</span>)
</span>}
</span></pre>



<p class="p noindent">which eventually expands to <code class="koka">(<span class="kw">handler</span>{ <span class="kw">control</span> raise(msg){ <span class="number">42</span> } })(<span class="kw">fn</span>(){ <span class="number">8</span> <span class="op">+</span> <a class="pp" href="#safe_divide">safe<span class="dash">-</span>divide<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>safe<span class="dash">-</span>divide: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">raise</span> <span class="tp">int</span></span></a>(<span class="number">1</span>,<span class="number">0</span>) })</code>.
</p>
<p class="p indent">We have a similar syntactic convenience for effects with one operation where the 
name of the effect and operation are the same. We can define such an effect by just declaring 
its operation which implicitly declares an effect type of the same name:
</p>
<div class="translate" style="border:1px solid #AAA;padding:0em 1em;margin:1em 0em">
<p class="p boxed-label noindent" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">translation</p>
<div class="translate-row"><pre class="koka source unchecked"><span class="plaincode">effect control op(&lt;parameters&gt;) : &lt;result-type&gt;
</span><span class="nicecode"><span class="tp kw">effect</span> <span class="kw">control</span> op(<span class="op">&lt;</span>parameters<span class="op">&gt;</span>) <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><span class="tp">result<span class="dash">-</span>type</span><span class="tp sp">&gt;</span>
</span></pre>


<p class="p noindent"><span class="mapsto" style="padding:0ex 1em;align-self:center;font-size:125%"><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.4371em;width:1.0890em" viewBox='34.67 57.872 10.371 4.163'><desc>$\mathpre{\rightsquigarrow}$</desc><g id='math-f156e3'><use x='34.869' y='61.836' xlink:href='#g4-32'/></g></svg></span>
</p><pre class="koka source unchecked"><span class="plaincode">effect op {
  control op(&lt;parameters&gt;) : &lt;result-type&gt;
}
</span><span class="nicecode"><span class="tp kw">effect</span> <span class="tp">op</span> {
  <span class="kw">control</span> op(<span class="op">&lt;</span>parameters<span class="op">&gt;</span>) <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><span class="tp">result<span class="dash">-</span>type</span><span class="tp sp">&gt;</span>
}
</span></pre>
</div></div>
<p class="p noindent">That means we can declare our <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code> effect signature also more concisely as:
</p><pre class="koka source unchecked"><span class="plaincode">effect control raise( msg : string ) : a
</span><span class="nicecode"><span class="tp kw">effect</span> <span class="kw">control</span> raise( msg <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <span class="tp tv">a</span>
</span></pre>



<p class="p noindent"><span style="display:block;margin-bottom:2em"></span>
</p>
<p class="p learn button indent"><a href="#sec-with" title="3.1.5.&#8194;With Statements" class="localref" style="target-element:h3">Read more about the <code class="koka"><span class="kw">with</span></code> statement <span class="fa fa-angle-double-up"></span></a></p><h3 id="sec-resume" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-resume" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4.2</span>.&#8194;</span>Resuming</h3>
<p class="p noindent">The power of effect handlers is not just that we can <em class="em-low1">yield</em> to the innermost
handler, but that we can also <em class="em-low1">resume</em> back to the call site with a result.
</p>
<p class="p indent">Let&#39;s define a <code class="koka"><a class="pp" href="#type_space_ask"><span class="tp">ask</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask: <span class="tp">V</span> <span class="tp kw op">-&gt;</span> <span class="tp">HX</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></code> effect that allows us to get a contextual value of type <code class="koka"><span class="tp tv">a</span></code>:
</p><pre class="koka source"><span class="plaincode">effect ask&lt;a&gt; {                  // or: effect&lt;a&gt; control ask() : a
  control ask() : a
}

fun add-twice() : ask&lt;int&gt; int {
  ask() + ask()
}
</span><span class="nicecode"><span class="decl-type" id="type_space_ask"><span class="tp kw">effect</span> <span class="decl-con" id="con_space_Ask"><a class="pp" href="#type_space_ask"><span class="tp">ask</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">HX</span></span></a></span></span><span class="tp sp">&lt;</span><a class="pp"><span class="tp">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {                  <span class="comment">// or: effect&lt;a&gt; control ask() : a
</span>  <span class="kw">control</span> <span class="decl-fun" id="ask"><a class="pp" href="#ask">ask<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">ask</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp tv">a</span></span></a></span>() <span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a>
}

<span class="decl-fun" id="add_twice"><span class="kw">fun</span> <a class="pp" href="#add_twice">add-twice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>add<span class="dash">-</span>twice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">ask</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">int</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="#type_space_ask"><span class="tp">ask</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">HX</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <a class="pp" href="#ask">ask<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">ask</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp tv">a</span></span></a>() <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="#ask">ask<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">ask</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp tv">a</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">The <code class="koka"><a class="pp" href="#add_twice">add<span class="dash">-</span>twice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>add<span class="dash">-</span>twice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">(</span><span class="tp">ask</span><span class="tp sp">&#60;</span><span class="tp">int</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp">int</span></span></a></code> function can ask for numbers but it is unaware of how these
are provided &#8211; the effect signature just specifies an contextual API.
We can handle it by always resuming with a constant for example:
</p><pre class="koka source"><span class="plaincode">fun ask-const() : int {
  with control ask(){ resume(21) }
  add-twice()
}
</span><span class="nicecode"><span class="decl-fun" id="ask_const"><span class="kw">fun</span> <a class="pp" href="#ask_const">ask-const<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask<span class="dash">-</span>const: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">ask</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="kw">control</span> <a class="pp">ask<span class="pc">ask: <span class="tp sp">(</span><span class="tp tpp">resume</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(){ <a class="pp">resume<span class="pc">resume: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">21</span>) }
  <a class="pp" href="#add_twice">add-twice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>add<span class="dash">-</span>twice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">ask</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">int</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">where <code class="koka"><a class="pp" href="#ask_const">ask<span class="dash">-</span>const<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask<span class="dash">-</span>const: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a>()</code> evaluates to <code class="koka"><span class="number">42</span></code>. Or by returning random values, like:
</p><pre class="koka source"><span class="plaincode">fun ask-random() : random int {
  with control ask(){ resume(random-int()) }
  add-twice()
}
</span><span class="nicecode"><span class="decl-fun" id="ask_random"><span class="kw">fun</span> <a class="pp" href="#ask_random">ask-random<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask<span class="dash">-</span>random: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">random</span> <span class="tp">int</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_random.html#type_space_random"><span class="tp">random</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>random<span class="fslash last">/</span></span>random: <span class="tp">HX</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">ask</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">random</span><span class="tp sp">&gt;</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">random</span> <span class="tp">int</span></span></a> <span class="kw">control</span> <a class="pp">ask<span class="pc">ask: <span class="tp sp">(</span><span class="tp tpp">resume</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">random</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">random</span> <span class="tp">int</span></span></a>(){ <a class="pp">resume<span class="pc">resume: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">random</span> <span class="tp">int</span></span></a>(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_random.html#random_int">random-int<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>random<span class="fslash last">/</span></span>random<span class="dash">-</span>int: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">random</span> <span class="tp">int</span></span></a>()) }
  <a class="pp" href="#add_twice">add-twice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>add<span class="dash">-</span>twice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">ask</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">int</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">where <code class="koka"><a class="pp" href="#ask_random">ask<span class="dash">-</span>random<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask<span class="dash">-</span>random: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">random</span> <span class="tp">int</span></span></a>()</code> now handled the <code class="koka"><a class="pp" href="#type_space_ask"><span class="tp">ask</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask: <span class="tp">V</span> <span class="tp kw op">-&gt;</span> <span class="tp">HX</span></span></a><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&#62;</span></code> effect, but itself now has
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_random.html#type_space_random"><span class="tp">random</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>random<span class="fslash last">/</span></span>random: <span class="tp">HX</span></span></a></code> effect (see <code class="koka"><a class="doc link" href="https://koka-lang.github.io/koka/doc/std_num_random.html"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>random</span></a></code>).
The <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#resume">resume<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>resume: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">resume<span class="dash">-</span>context</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">b</span></span></a></code> function is implicitly bound by a <code class="koka"><span class="kw">control</span></code> operation and resumes
back to the call-site with the given result. 
</p>
<p class="p indent">As we saw in the exception example, we do
not need to call <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#resume">resume<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>resume: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">resume<span class="dash">-</span>context</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">b</span></span></a></code> and can also directly return into our handler scope. For example, we 
may only want to handle a <code class="koka">ask</code> once, but after that give up:
</p><pre class="koka source"><span class="plaincode">fun ask-once() : int {
  var count := 0
  with control ask() { 
    count := count + 1
    if (count &lt;= 1) then resume(42) else 0 
  }
  add-twice()
}
</span><span class="nicecode"><span class="decl-fun" id="ask_once"><span class="kw">fun</span> <a class="pp" href="#ask_once">ask-once<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask<span class="dash">-</span>once: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_scope">count<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>scope: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a> <span class="kw op">:=</span> <span class="number">0</span>
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">ask</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">3411</span><span class="op">&gt;</span><span class="op">&gt;</span> int) <span class="kw op">-></span> (local<span class="op">&lt;$</span><span class="number">3411</span><span class="op">&gt;</span>) int</span></a> <span class="kw">control</span> <a class="pp">ask<span class="pc">ask: <span class="tp sp">(</span><span class="tp tpp">resume</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">3411</span><span class="op">&gt;</span>) int) <span class="kw op">-></span> (local<span class="op">&lt;$</span><span class="number">3411</span><span class="op">&gt;</span>) int</span></a>() { 
    <a class="pp">count<span class="pc">count: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">3411</span>,int<span class="op">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp">count<span class="pc">count: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span>
    <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">count<span class="pc">count: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">1</span>) <span class="kw">then</span> <a class="pp">resume<span class="pc">resume: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">3411</span><span class="op">&gt;</span>) int</span></a>(<span class="number">42</span>) <span class="kw">else</span> <span class="number">0</span> 
  }
  <a class="pp" href="#add_twice">add-twice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>add<span class="dash">-</span>twice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">ask</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">int</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">Here <code class="koka"><a class="pp" href="#ask_once">ask<span class="dash">-</span>once<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask<span class="dash">-</span>once: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a>()</code> evaluates to <code class="koka"><span class="number">0</span></code> since the second call to <code class="koka">ask</code> does not resume,
(and returns directly <code class="koka"><span class="number">0</span></code> in the <code class="koka"><a class="pp" href="#ask_once">ask<span class="dash">-</span>once<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask<span class="dash">-</span>once: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> context). This pattern can for example
be used to implement the concept of <em class="em-low1">fuel</em> in a setting where a computation is 
only allowed to take a limited amount of steps.
</p>
<p class="p learn button indent"><a href="#sec-var" title="3.2.4.&#8194;Local Mutable Variables" class="localref" style="target-element:h3">Read more about <code class="koka"><span class="kw">var</span></code> mutable variables <span class="fa fa-angle-double-up"></span></a></p><h3 id="sec-opfun" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-opfun" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4.3</span>.&#8194;</span>Tail-Resumptive Operations</h3>
<p class="p noindent">A <code class="koka"><span class="kw">control</span></code> operation is one of the most general ways to define operations since
we get a first-class <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#resume">resume<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>resume: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">resume<span class="dash">-</span>context</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">b</span></span></a></code> function. However, almost all operations in practice turn out
to be <em class="em-low1">tail-resumptive</em>: that is, they resume exactly <em class="em-low1">once</em> with their final result
value. To make this more convenient, we can declare <code class="koka"><span class="kw">fun</span></code> operations that do this
by construction, i.e.
</p>
<div class="translate" style="border:1px solid #AAA;padding:0em 1em;margin:1em 0em">
<p class="p boxed-label noindent" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">translation</p>
<div class="translate-row"><pre class="koka source unchecked"><span class="plaincode">with fun op(&lt;args&gt;){ &lt;body&gt; }
</span><span class="nicecode"><span class="kw">with</span> <span class="kw">fun</span> op(<span class="op">&lt;</span>args<span class="op">&gt;</span>){ <span class="op">&lt;</span>body<span class="op">&gt;</span> }
</span></pre>


<p class="p noindent"><span class="mapsto" style="padding:0ex 1em;align-self:center;font-size:125%"><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.4371em;width:1.0890em" viewBox='34.67 57.872 10.371 4.163'><desc>$\mathpre{\rightsquigarrow}$</desc><g id='math-f156e3'><use x='34.869' y='61.836' xlink:href='#g4-32'/></g></svg></span>
</p><pre class="koka source unchecked"><span class="plaincode">with control op(&lt;args&gt;){ val f = fn(){ &lt;body&gt; }; resume( f() ) }
</span><span class="nicecode"><span class="kw">with</span> <span class="kw">control</span> op(<span class="op">&lt;</span>args<span class="op">&gt;</span>){ <span class="kw">val</span> f <span class="kw">=</span> <span class="kw">fn</span>(){ <span class="op">&lt;</span>body<span class="op">&gt;</span> }; <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#resume">resume<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>resume: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">resume<span class="dash">-</span>context</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span></span></a>( f() ) }
</span></pre>
</div></div>
<p class="p noindent">(The translation is defined via an intermediate function <code class="koka">f</code> so <code class="koka"><span class="kw">return</span></code> works as expected).
</p>
<p class="p indent">With this syntactic sugar, we can write our earlier <code class="koka"><a class="pp" href="#ask_const">ask<span class="dash">-</span>const<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask<span class="dash">-</span>const: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> example 
using a <code class="koka"><span class="kw">fun</span></code> operation instead:
</p><pre class="koka source"><span class="plaincode">fun ask-const2() : int {
  with fun ask(){ 21 }
  add-twice()
}
</span><span class="nicecode"><span class="decl-fun" id="ask_const2"><span class="kw">fun</span> <a class="pp" href="#ask_const2">ask-const2<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask<span class="dash">-</span>const2: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">ask</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="kw">fun</span> <a class="pp">ask<span class="pc">ask: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(){ <span class="number">21</span> }
  <a class="pp" href="#add_twice">add-twice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>add<span class="dash">-</span>twice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">ask</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">int</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">This also conveys better that even though <code class="koka">ask</code> is dynamically bound, it behaves
just like a regular function without changing the control-flow. 
</p>
<p class="p indent">Moreover, operations declared as <code class="koka"><span class="kw">fun</span></code> are much more efficient than general
<code class="koka"><span class="kw">control</span></code> operations. The Koka compiler uses (generalized) <em class="em-low1">evidence passing</em>&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#xie:evidently" title="Effect Handlers, Evidently
Xie, Brachthuser, Schuster, Hillerstrm, and Leijen, 2020" class="bibref localref" style="target-element:bibitem"><span class="cite-number">16</span></a>, <a href="#xie:evidence-tr" title="Generalized Evidence Passing for Effect Handlers
Xie and Leijen, 2021" class="bibref localref" style="target-element:bibitem"><span class="cite-number">17</span></a>]</span>
to pass down handler information to each call-site. At the call to <code class="koka">ask</code> in <code class="koka"><a class="pp" href="#add_twice">add<span class="dash">-</span>twice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>add<span class="dash">-</span>twice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">(</span><span class="tp">ask</span><span class="tp sp">&#60;</span><span class="tp">int</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp">int</span></span></a></code>,
it selects the handler from the evidence vector and when the operation is
a tail-resumptive <code class="koka"><span class="kw">fun</span></code>, it calls it directly as a regular function (except with an adjucted evidence
vector for its context). Unlike a general <code class="koka"><span class="kw">control</span></code> operation, there is no need to yield upward
to the handler, capture the stack, and eventually resume again. 
This gives <code class="koka"><span class="kw">fun</span></code> (and <code class="koka"><span class="kw">val</span></code>) operations a performance cost very similar to <em class="em-low1">virtual method calls</em> 
which can be very efficient.
</p>
<p class="p indent">For even a bit more performance, you can also declare upfront that any operation
definition must be tail-resumptive, as:
</p><pre class="koka source unchecked"><span class="plaincode">effect ask&lt;a&gt; {
  fun ask() : a
}
</span><span class="nicecode"><span class="tp kw">effect</span> <a class="pp" href="#type_space_ask"><span class="tp">ask</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">HX</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> {
  <span class="kw">fun</span> ask() <span class="tp kw op">:</span> <span class="tp tv">a</span>
}
</span></pre>



<p class="p noindent">This restricts all handler definitions for the <code class="koka"><a class="pp" href="#type_space_ask"><span class="tp">ask</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ask: <span class="tp">V</span> <span class="tp kw op">-&gt;</span> <span class="tp">HX</span></span></a></code> effect to use <code class="koka"><span class="kw">fun</span></code> definitions
for the <code class="koka">ask</code> operation. However, it increases the ability to reason about the code,
and the compiler can optimize such calls a bit more as it no longer needs to check at
run-time if the handler happens to define the operation as tail-resumptive.
</p><h4 id="sec-opval" class="h4" data-heading-depth="4" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">Value Operations</h4>
<p class="p noindent">A common subset of operations always tail-resume with a single value; these are
essentially dynamically bound variables (but statically typed!). Such operations
can be declared as a <code class="koka"><span class="kw">val</span></code> with the following translation:
</p>
<div class="translate" style="border:1px solid #AAA;padding:0em 1em;margin:1em 0em">
<p class="p boxed-label noindent" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">translation</p>
<div class="translate-row"><pre class="koka source unchecked"><span class="plaincode">with val v = &lt;expr&gt;
</span><span class="nicecode"><span class="kw">with</span> <span class="kw">val</span> v <span class="kw">=</span> <span class="op">&lt;</span>expr<span class="op">&gt;</span>
</span></pre>


<p class="p noindent"><span class="mapsto" style="padding:0ex 1em;align-self:center;font-size:125%"><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.4371em;width:1.0890em" viewBox='34.67 57.872 10.371 4.163'><desc>$\mathpre{\rightsquigarrow}$</desc><g id='math-f156e3'><use x='34.869' y='61.836' xlink:href='#g4-32'/></g></svg></span>
</p><pre class="koka source unchecked"><span class="plaincode">val x = &lt;expr&gt;
with fun v(){ x }
</span><span class="nicecode"><span class="kw">val</span> x <span class="kw">=</span> <span class="op">&lt;</span>expr<span class="op">&gt;</span>
<span class="kw">with</span> <span class="kw">fun</span> v(){ x }
</span></pre>


<p class="p noindent"><span class="mapsto" style="padding:0ex 1em;align-self:center;font-size:125%"><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.4371em;width:1.0890em" viewBox='34.67 57.872 10.371 4.163'><desc>$\mathpre{\rightsquigarrow}$</desc><g id='math-f156e3'><use x='34.869' y='61.836' xlink:href='#g4-32'/></g></svg></span>
</p><pre class="koka source unchecked"><span class="plaincode">val x = &lt;expr&gt;
with control v(){ resume(x) }
</span><span class="nicecode"><span class="kw">val</span> x <span class="kw">=</span> <span class="op">&lt;</span>expr<span class="op">&gt;</span>
<span class="kw">with</span> <span class="kw">control</span> v(){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#resume">resume<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>resume: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">resume<span class="dash">-</span>context</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span></span></a>(x) }
</span></pre>
</div></div>
<p class="p noindent">For an example of the use of value operations, consider a 
pretty printer that produces pretty strings from documents:
</p><pre class="koka source unchecked"><span class="plaincode">fun pretty( d : doc ) : string
</span><span class="nicecode"><span class="kw">fun</span> <a class="pp" href="#pretty">pretty<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pretty: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">doc</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">width</span> <span class="tp">string</span></span></a>( d <span class="tp kw op">:</span> <a class="pp" href="#type_space_doc"><span class="tp">doc</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>doc: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>
</span></pre>



<p class="p noindent">Unfortunately, it has a hard-coded maximum display width of <code class="koka"><span class="number">40</span></code> deep
down in the code of <code class="koka"><a class="pp" href="#pretty">pretty<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pretty: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">doc</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">width</span> <span class="tp">string</span></span></a></code>:
</p><pre class="koka source unchecked"><span class="plaincode">fun pretty-internal( line : string ) : string {
  line.truncate(40)
}
</span><span class="nicecode"><span class="kw">fun</span> <a class="pp" href="#pretty_internal">pretty<span class="dash">-</span>internal<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pretty<span class="dash">-</span>internal: <span class="tp sp">(</span><span class="tp tpp">line</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">width</span> <span class="tp">string</span></span></a>( line <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
  line<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#truncate">truncate<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>truncate: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">count</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<span class="number">40</span>)
}
</span></pre>



<p class="p noindent">To abstract over the width we have a couple of choices: we 
could make the width a regular parameter but now we need to 
explicitly add the parameter to all functions in the library
and manually thread them around. Another option is a global
mutable variable but that leaks side-effects and is non-modular.
</p>
<p class="p indent">Or, we can define it as a value operation instead:
</p><pre class="koka source"><span class="plaincode">effect val width : int
</span><span class="nicecode"><span class="decl-type" id="type_space_width"><span class="tp kw">effect</span> <span class="kw">val</span> <span class="decl-con" id="con_space_Width"><a class="pp" href="#width">width<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>width: <span class="tp">value</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a></span></span> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>
</span></pre>



<p class="p noindent">This also allows us to refer to the <code class="koka">width</code> operation as if is a 
regular value (even though internally it invokes the operation).
So, the check for the width in the pretty printer can be written as:
</p><pre class="koka source"><span class="plaincode">fun pretty-internal( line : string ) : width string {
  line.truncate(width)
}
</span><span class="nicecode"><span class="decl-fun" id="pretty_internal"><span class="kw">fun</span> <a class="pp" href="#pretty_internal">pretty-internal<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pretty<span class="dash">-</span>internal: <span class="tp sp">(</span><span class="tp tpp">line</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">width</span> <span class="tp">string</span></span></a>( <a class="pp">line<span class="pc">line: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_width"><span class="tp">width</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>width: <span class="tp">HX1</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
  <a class="pp">line<span class="pc">line: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#truncate">truncate<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>truncate: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">count</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<a class="pp" href="#width">width<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>width: <span class="tp">value</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>)
</span>}
</span></pre>



<p class="p noindent">When using the pretty printer we can bind the <code class="koka">width</code> as a
regular effect handler:
</p><pre class="koka source"><span class="plaincode">fun pretty-thin(d : doc) : string {
  with val width = 40
  pretty(d)
}
</span><span class="nicecode"><span class="decl-fun" id="pretty_thin"><span class="kw">fun</span> <a class="pp" href="#pretty_thin">pretty-thin<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pretty<span class="dash">-</span>thin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">doc</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<a class="pp">d<span class="pc">d: <span class="tp">doc</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_doc"><span class="tp">doc</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>doc: <span class="tp">V</span></span></a>) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">width</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="kw">val</span> <a class="pp">width<span class="pc">width: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="kw">=</span> <span class="number">40</span>
  <a class="pp" href="#pretty">pretty<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pretty: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">doc</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">width</span> <span class="tp">string</span></span></a>(<a class="pp">d<span class="pc">d: <span class="tp">doc</span></span></a>)
</span>}
</span></pre>



<p class="p noindent">Note that we did not need to change the structure of the 
original library functions. However the types of the functions
still change to include the <code class="koka"><a class="pp" href="#type_space_width"><span class="tp">width</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>width: <span class="tp">HX1</span></span></a></code> effect as these now
require the <code class="koka">width</code> value to be handled at some point.
For example, the type of <code class="koka"><a class="pp" href="#pretty">pretty<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pretty: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">doc</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">width</span> <span class="tp">string</span></span></a></code> becomes:
</p><pre class="koka source unchecked"><span class="plaincode">fun pretty( d : doc ) : width string
</span><span class="nicecode"><span class="kw">fun</span> <a class="pp" href="#pretty">pretty<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pretty: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">doc</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">width</span> <span class="tp">string</span></span></a>( d <span class="tp kw op">:</span> <a class="pp" href="#type_space_doc"><span class="tp">doc</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>doc: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_width"><span class="tp">width</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>width: <span class="tp">HX1</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>
</span></pre>


<p class="p noindent">as is requires the <code class="koka"><a class="pp" href="#type_space_width"><span class="tp">width</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>width: <span class="tp">HX1</span></span></a></code> effect to be handled (aka,
the &quot;dynamic binding for <code class="koka">width <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code> to be defined&#8220;, 
aka, the &#8221;<code class="koka"><a class="pp" href="#type_space_width"><span class="tp">width</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>width: <span class="tp">HX1</span></span></a></code> capability&quot;).
</p><h3 id="sec-abstracting-handlers" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-abstracting-handlers" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4.4</span>.&#8194;</span>Abstracting Handlers</h3>
<p class="p noindent">As another example, a <em class="em-low1">writer</em> effect is quite common where
values are collected by a handler. For example, we can
define an <code class="koka"><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a></code> effect to emit messages:
</p><pre class="koka source unchecked"><span class="plaincode">effect fun emit( msg : string ) : ()
</span><span class="nicecode"><span class="tp kw">effect</span> <span class="kw">fun</span> emit( msg <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span>
</span></pre>


<pre class="koka source"><span class="plaincode">fun ehello() : emit () {
  emit("hello")
  emit("world")
}
</span><span class="nicecode"><span class="decl-fun" id="ehello"><span class="kw">fun</span> <a class="pp" href="#ehello">ehello<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ehello: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a> {
  <a class="pp" href="#emit">emit<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"hello"</span>)
  <a class="pp" href="#emit">emit<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"world"</span>)
</span>}
</span></pre>



<p class="p noindent">We can define for example a handler that prints the 
emitted messages directly to the console:
</p><pre class="koka source"><span class="plaincode">fun ehello-console() : console () {
  with fun emit(msg){ println(msg) }
  ehello()
}
</span><span class="nicecode"><span class="decl-fun" id="ehello_console"><span class="kw">fun</span> <a class="pp" href="#ehello_console">ehello-console<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ehello<span class="dash">-</span>console: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_console"><span class="tp"><span class="effect">console</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>console: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a> {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp sp">,</span><span class="tp">console</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <span class="kw">fun</span> <a class="pp">emit<span class="pc">emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>) }
  <a class="pp" href="#ehello">ehello<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ehello: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">Here the handler is define directly, but we can also abstract the handler for
emitting to the console into a separate function:
</p><pre class="koka source"><span class="plaincode">fun emit-console( action ) {
  with fun emit(msg){ println(msg) }
  action()
} 
</span><span class="nicecode"><span class="decl-fun" id="emit_console"><span class="kw">fun</span> <a class="pp" href="#emit_console">emit-console<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit<span class="dash">-</span>console: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span></span></a>( <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">&#95;5091</span><span class="tp sp">&gt;</span> <span class="tp tv">&#95;5054</span></span></a> ) {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp sp">,</span><span class="tp">console</span><span class="tp kw op">|</span><span class="tp tv">&#95;5091</span><span class="tp sp">&gt;</span> <span class="tp tv">&#95;5054</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp kw op">|</span><span class="tp tv">&#95;5091</span><span class="tp sp">&gt;</span> <span class="tp tv">&#95;5054</span></span></a> <span class="kw">fun</span> <a class="pp">emit<span class="pc">emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp kw op">|</span><span class="tp tv">&#95;5091</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>) }
  <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">&#95;5091</span><span class="tp sp">&gt;</span> <span class="tp tv">&#95;5054</span></span></a>()
</span>} 
</span></pre>



<p class="p noindent">where <code class="koka"><a class="pp" href="#emit_console">emit<span class="dash">-</span>console<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit<span class="dash">-</span>console: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">console</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span></span></a></code> has the inferred type <code class="koka"><span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_console"><span class="tp">console</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>console: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_console"><span class="tp">console</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>console: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span></code> (hover 
over the source to see the inferred types) where
the action can have use the effects <code class="koka"><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a></code>, <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_console"><span class="tp">console</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>console: <span class="tp">X</span></span></a></code>, and any other effects <code class="koka"><span class="tp tv">e</span></code>, 
and where the final effect is just <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_console"><span class="tp">console</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>console: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span></code> as the <code class="koka"><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a></code> effect
is discharged by the handler.
</p>
<p class="p indent">Note, we could have written the above too as:
</p><pre class="koka source"><span class="plaincode">val emit-console2 = handler {
  fun emit(msg){ println(msg) }
}
</span><span class="nicecode"><span class="decl-val" id="emit_console2_1"><span class="kw">val</span> <a class="pp" href="#emit_console2_1">emit-console2<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit<span class="dash">-</span>console2<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span></span></a> <span class="kw">=</span> <a class="pp"><span class="kw">handler</span><span class="pc">handler: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span></span></a> {
  <span class="kw">fun</span> <a class="pp">emit<span class="pc">emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp kw op">|</span><span class="tp tv">&#95;5304</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>) }
</span>}
</span></pre>


<p class="p noindent">since a <code class="koka"><span class="kw">handler</span>{ <span class="op">...</span> }</code> expression is a function itself (and thus a <em class="em-low1">value</em>). 
Generally we prefer the earlier definition though as it allows further parameters
like an initial state.
</p>
<p class="p indent">Since <code class="koka"><span class="kw">with</span></code> works generally, we can use the abstracted handlers just like
regular handlers, and our earlier example can be written as:
</p><pre class="koka source"><span class="plaincode">fun ehello-console2() : console () {
  with emit-console
  ehello()
}
</span><span class="nicecode"><span class="decl-fun" id="ehello_console2"><span class="kw">fun</span> <a class="pp" href="#ehello_console2">ehello-console2<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ehello<span class="dash">-</span>console2: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_console"><span class="tp"><span class="effect">console</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>console: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a> {
  <span class="kw">with</span> <a class="pp" href="#emit_console">emit-console<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit<span class="dash">-</span>console: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span></span></a>
  <a class="pp" href="#ehello">ehello<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ehello: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>()
</span>}
</span></pre>


<p class="p noindent">(which expands to <code class="koka"><a class="pp" href="#emit_console">emit<span class="dash">-</span>console<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit<span class="dash">-</span>console: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">console</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span></span></a>( <span class="kw">fn</span>(){ <a class="pp" href="#ehello">ehello<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ehello: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() } )</code>).
Another useful handler may collect all emitted messages as a list of lines:
</p><pre class="koka source"><span class="plaincode">fun emit-collect( action : () -&gt; &lt;emit|e&gt; () ) : e string {
  var lines := []
  with handler {
    return(x){ lines.reverse.join("\n") }
    fun emit(msg){ lines := Cons(msg,lines) }
  }
  action()
}

fun ehello-commit() : string {
  with emit-collect
  ehello()
}
</span><span class="nicecode"><span class="decl-fun" id="emit_collect"><span class="kw">fun</span> <a class="pp" href="#emit_collect">emit-collect<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit<span class="dash">-</span>collect: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">string</span></span></a>( <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp op">|$</span><span class="number">4733</span><span class="op">&gt;</span> ()</span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_scope">lines<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>scope: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a> <span class="kw op">:=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">]</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
  <span class="kw">with</span> <a class="pp"><span class="kw">handler</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">4737</span><span class="op">&gt;|$</span><span class="number">4733</span><span class="op">&gt;</span> ()) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;$</span><span class="number">4737</span><span class="op">&gt;|$</span><span class="number">4733</span><span class="op">&gt;</span> string</span></a> {
    <span class="kw">return</span>(<a class="pp">x<span class="pc">x: <span class="tp tv">&#95;4746</span></span></a>){ <a class="pp">lines<span class="pc">lines: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#reverse">reverse<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>reverse: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#join_3">join<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>join<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">sep</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<span class="st">"\n"</span>) }
    <span class="kw">fun</span> <a class="pp">emit<span class="pc">emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">4737</span><span class="op">&gt;|$</span><span class="number">4733</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <a class="pp">lines<span class="pc">lines: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">4737</span>,list<span class="op">&lt;</span>string<span class="op">&gt;</span><span class="op">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>,<a class="pp">lines<span class="pc">lines: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a>) }
  }
  <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp op">|$</span><span class="number">4733</span><span class="op">&gt;</span> ()</span></a>()
</span>}

<span class="decl-fun" id="ehello_commit"><span class="kw">fun</span> <a class="pp" href="#ehello_commit">ehello-commit<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ehello<span class="dash">-</span>commit: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
  <span class="kw">with</span> <a class="pp" href="#emit_collect">emit-collect<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit<span class="dash">-</span>collect: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">string</span></span></a>
  <a class="pp" href="#ehello">ehello<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ehello: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">This is a total handler and only discharges the <code class="koka"><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a></code> effect.
</p>
<p class="p learn button indent"><a href="#sec-with" title="3.1.5.&#8194;With Statements" class="localref" style="target-element:h3">Read more about the <code class="koka"><span class="kw">with</span></code> statement <span class="fa fa-angle-double-up"></span></a></p>
<p class="p learn button indent"><a href="#sec-var" title="3.2.4.&#8194;Local Mutable Variables" class="localref" style="target-element:h3">Read more about <code class="koka"><span class="kw">var</span></code> mutable variables <span class="fa fa-angle-double-up"></span></a></p>
<p class="p indent">As another example, consider a generic <code class="koka">catch</code> handler that
applies an handling function when <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code> is called on our
exception example:
</p><pre class="koka source"><span class="plaincode">fun catch( hnd : (string) -&gt; e a, action : () -&gt; &lt;raise|e&gt; a ) : e a {
  with control raise(msg){ hnd(msg) }
  action()
}
</span><span class="nicecode"><span class="decl-fun" id="catch"><span class="kw">fun</span> <a class="pp" href="#catch">catch<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>catch: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">hnd</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>( <a class="pp">hnd<span class="pc">hnd: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp op">$</span><span class="number">3751</span> <span class="op">$</span><span class="number">3750</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a>, <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp op">|$</span><span class="number">3751</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">3750</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a> {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp op">|$</span><span class="number">3751</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">3750</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">3751</span> <span class="op">$</span><span class="number">3750</span></span></a> <span class="kw">control</span> <a class="pp">raise<span class="pc">raise: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">resume</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">&#95;3756</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp op">$</span><span class="number">3751</span> <span class="op">$</span><span class="number">3750</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">3751</span> <span class="op">$</span><span class="number">3750</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <a class="pp">hnd<span class="pc">hnd: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp op">$</span><span class="number">3751</span> <span class="op">$</span><span class="number">3750</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>) }
  <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp op">|$</span><span class="number">3751</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">3750</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">We can use it now conveniently with a <code class="koka"><span class="kw">with</span></code> statement to handle
exceptional situations:
</p><pre class="koka source"><span class="plaincode">fun catch-example() {
  with catch fn(msg){ println("error: " ++ msg); 42 }
  safe-divide(1,0)
}
</span><span class="nicecode"><span class="decl-fun" id="catch_example"><span class="kw">fun</span> <a class="pp" href="#catch_example">catch-example<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>catch<span class="dash">-</span>example: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp">int</span></span></a>() {
  <span class="kw">with</span> <a class="pp" href="#catch">catch<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>catch: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">hnd</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a> <span class="kw">fn</span>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"error: "</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__plus__1">++<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(++)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>); <span class="number">42</span> }
  <a class="pp" href="#safe_divide">safe-divide<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>safe<span class="dash">-</span>divide: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">raise</span> <span class="tp">int</span></span></a>(<span class="number">1</span>,<span class="number">0</span>)
</span>}
</span></pre>



<div class="advanced" style="border-left:1px solid #AAA;padding:0em 0em 0em 1em;margin:1em 0em">
<p class="p noindent"><span class="boxed-label" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">advanced</span>The <code class="koka">catch</code> handler has an interesting type where the action can
have a <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code> effect (<code class="koka"><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span></code>) and maybe further effects <code class="koka"><span class="tp tv">e</span></code>,
while the handling function <code class="koka">hnd</code> only has effect <code class="koka"><span class="tp tv">e</span></code>. Now consider
supplying a handing function that itself calls <code class="koka">raise</code>: in that case, the 
type of <code class="koka">catch</code> would be instantiated to: <code class="koka"><span class="tp sp">(</span><span class="tp tpp">hnd</span><span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a><span class="tp sp">,</span> <a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a><span class="tp sp">&#62;</span> <span class="tp tv">a</span> <span class="tp sp">)</span> <span class="tp kw op">:</span> <span class="tp sp">&#60;</span><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a><span class="tp sp">&#62;</span> <span class="tp tv">a</span></code>.
This is correct: the (outer) <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code> effect of <code class="koka">action</code> is handled and discharged, but since
the handling function <code class="koka">hnd</code> can still cause <code class="koka">raise</code> to be called, the final effect still contains <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code>.
</p>
<p class="p indent">Here we see that Koka allows <em class="em-low1">duplicate</em> effect labels&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#leijen:scopedlabels" title="Extensible records with scoped labels
Leijen, 2005" class="bibref localref" style="target-element:bibitem"><span class="cite-number">7</span></a>]</span> where <code class="koka">action</code> has
an instantiated <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a><span class="tp sp">,</span><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a><span class="tp sp">&#62;</span></code> effect type.
These kind of types occur naturally in the presence of polymorphic effects, and there is a natural correspondence
to the structure of the evidence vectors at runtime (with entries for each nested effect handler). 
Intuitively, the <code class="koka">action</code> effect expresses that 
its outer (left-most) <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code> is handled, but that there may be other exceptions that are not handled &#8211; in this 
case from the handling function <code class="koka">hnd</code>, but they can also be <em class="em-low1">masked</em> exceptions (as described in Section&nbsp;<a href="#sec-mask" title="3.4.7.&#8194;Masking Effects" class="localref" style="target-element:h3"><span class="heading-label">3.4.7</span></a>).</p></div><h3 id="sec-return" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-return" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4.5</span>.&#8194;</span>Return Operations</h3>
<p class="p noindent">In the previous <code class="koka"><a class="pp" href="#emit_collect">emit<span class="dash">-</span>collect<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit<span class="dash">-</span>collect: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp">string</span></span></a></code> example we saw the use of 
a <code class="koka"><span class="kw">return</span></code> operation. Such operation changes the final
result of the action of a handler. 
For example, consider our earlier used-defined exception effect <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code>.
We can define a general handler that transforms any exceptional
action into one that returns a <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-&gt;</span> <span class="tp">V</span></span></a></code> type:
</p><pre class="koka source"><span class="plaincode">fun raise-maybe( action : () -&gt; &lt;raise|e&gt; a ) : e maybe&lt;a&gt; {
  with handler {
    return(x){ Just(x) }           // normal return: wrap in Just
    control raise(msg){ Nothing }  // exception: return Nothing directly
  }
  action()
}

fun div42() {
  (raise-maybe{ safe-divide(1,0) }).default(42)
}
</span><span class="nicecode"><span class="decl-fun" id="raise_maybe"><span class="kw">fun</span> <a class="pp" href="#raise_maybe">raise-maybe<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise<span class="dash">-</span>maybe: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp op">|$</span><span class="number">4590</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">4589</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <span class="kw">with</span> <a class="pp"><span class="kw">handler</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp op">|$</span><span class="number">4590</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">4589</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">4590</span> maybe<span class="op">&lt;$</span><span class="number">4589</span><span class="op">&gt;</span></span></a> {
    <span class="kw">return</span>(<a class="pp">x<span class="pc">x: <span class="tp tv">&#95;4593</span></span></a>){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp tv">&#95;4593</span></span></a>) }           <span class="comment">// normal return: wrap in Just
</span>    <span class="kw">control</span> <a class="pp">raise<span class="pc">raise: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">resume</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">&#95;4602</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;4601</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;4593</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;4601</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;4593</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> }  <span class="comment">// exception: return Nothing directly
</span>  }
  <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp op">|$</span><span class="number">4590</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">4589</span></span></a>()
</span>}

<span class="decl-fun" id="div42"><span class="kw">fun</span> <a class="pp" href="#div42">div42<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>div42: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>() {
  (<a class="pp" href="#raise_maybe">raise-maybe<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise<span class="dash">-</span>maybe: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>{ <a class="pp" href="#safe_divide">safe-divide<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>safe<span class="dash">-</span>divide: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">raise</span> <span class="tp">int</span></span></a>(<span class="number">1</span>,<span class="number">0</span>) })<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#default">default<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>default: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<span class="number">42</span>)
</span>}
</span></pre>


<p class="p noindent">(where the body of <code class="koka"><a class="pp" href="#div42">div42<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>div42: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> desugars to <code class="koka">default( <a class="pp" href="#raise_maybe">raise<span class="dash">-</span>maybe<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise<span class="dash">-</span>maybe: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">raise</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a>(<span class="kw">fn</span>(){ <a class="pp" href="#safe_divide">safe<span class="dash">-</span>divide<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>safe<span class="dash">-</span>divide: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">raise</span> <span class="tp">int</span></span></a>(<span class="number">1</span>,<span class="number">0</span>) }), <span class="number">42</span> )</code>).
</p>
<p class="p learn button indent"><a href="#sec-anon" title="3.1.4.&#8194;Anonymous Functions and Trailing Lambdas" class="localref" style="target-element:h3">Read more about function block expressions <span class="fa fa-angle-double-up"></span></a></p>
<p class="p learn button indent"><a href="#sec-dot" title="3.1.2.&#8194;Dot selection" class="localref" style="target-element:h3">Read more about <em class="em-low1">dot</em> expressions <span class="fa fa-angle-double-up"></span></a></p><h4 id="sec-state" class="h4" data-heading-depth="4" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">A State Effect</h4>
<p class="p noindent">For more examples of the use of <code class="koka"><span class="kw">return</span></code> operations, we look at a the state effect.
In its most general form it has just a <code class="koka">set</code> and <code class="koka"><a class="pp" href="#get">get<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>get: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">(</span><span class="tp">state</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp tv">a</span></span></a></code> operation:
</p><pre class="koka source"><span class="plaincode">effect state&lt;a&gt; {
  fun get() : a
  fun set( x : a ) : ()
}

fun sumdown( sum : int = 0 ) : &lt;state&lt;int&gt;,div&gt; int {
  val i = get()
  if (i &lt;= 0) then sum else {
    set( i - 1 )
    sumdown( sum + i )
  }
}
</span><span class="nicecode"><span class="decl-type" id="type_space_state"><span class="tp kw">effect</span> <span class="decl-con" id="con_space_State"><a class="pp" href="#type_space_state"><span class="tp">state</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>state: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">HX</span></span></a></span></span><span class="tp sp">&lt;</span><a class="pp"><span class="tp">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <span class="kw">fun</span> <span class="decl-fun" id="get"><a class="pp" href="#get">get<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp tv">a</span></span></a></span>() <span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a>
  <span class="kw">fun</span> <span class="decl-fun" id="set"><a class="pp" href="#set">set<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></span>( <a class="pp">x<span class="pc">x: <span class="tp op">$</span><span class="number">4138</span></span></a> <span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a>
}

<span class="decl-fun" id="sumdown"><span class="kw">fun</span> <a class="pp" href="#sumdown">sumdown<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>sumdown: <span class="tp sp">(</span><span class="tp tpp">sum</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span> <span class="tp">int</span></span></a>( <a class="pp">sum<span class="pc">sum: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0</span> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__gt_"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;&gt;): <span class="tp">E</span></span></a><a class="pp" href="#type_space_state"><span class="tp">state</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>state: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">HX</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="#get">get<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp tv">a</span></span></a>()
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">0</span>) <span class="kw">then</span> <a class="pp">sum<span class="pc">sum: <span class="tp">int</span></span></a> <span class="kw">else</span> {
    <a class="pp" href="#set">set<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span> )
    <a class="pp" href="#sumdown">sumdown<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>sumdown: <span class="tp sp">(</span><span class="tp tpp">sum</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">&gt;</span> <span class="tp">int</span></span></a>( <a class="pp">sum<span class="pc">sum: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> )
  }
</span>}
</span></pre>



<p class="p noindent">We can define a generic state handler most easily by using <code class="koka"><span class="kw">var</span></code> declarations:
</p><pre class="koka source"><span class="plaincode">fun state( init : a, action : () -&gt; &lt;state&lt;a&gt;,div|e&gt; b ) : &lt;div|e&gt; b {
  var st := init
  with handler {
    fun get(){ st }
    fun set(i){ st := i }
  }
  action()
}
</span><span class="nicecode"><span class="decl-fun" id="state"><span class="kw">fun</span> <a class="pp" href="#state">state<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>state: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a>( <a class="pp">init<span class="pc">init: <span class="tp op">$</span><span class="number">6955</span></span></a> <span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a>, <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp op">&lt;$</span><span class="number">6955</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">6957</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6956</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="#type_space_state"><span class="tp">state</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>state: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">HX</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">b</span><span class="pc">b: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">b</span><span class="pc">b: <span class="tp">V</span></span></a> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_scope">st<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>scope: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a> <span class="kw op">:=</span> <a class="pp">init<span class="pc">init: <span class="tp op">$</span><span class="number">6955</span></span></a>
  <span class="kw">with</span> <a class="pp"><span class="kw">handler</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp op">&lt;$</span><span class="number">6955</span><span class="op">&gt;</span>,local<span class="op">&lt;$</span><span class="number">6961</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">6957</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6956</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;$</span><span class="number">6961</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">6957</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6956</span></span></a> {
    <span class="kw">fun</span> <a class="pp">get<span class="pc">get: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">6961</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">6957</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6955</span></span></a>(){ <a class="pp">st<span class="pc">st: <span class="tp op">$</span><span class="number">6955</span></span></a> }
    <span class="kw">fun</span> <a class="pp">set<span class="pc">set: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">6955</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;$</span><span class="number">6961</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">6957</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">i<span class="pc">i: <span class="tp op">$</span><span class="number">6955</span></span></a>){ <a class="pp">st<span class="pc">st: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">6961</span>,<span class="op">$</span><span class="number">6955</span><span class="op">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp">i<span class="pc">i: <span class="tp op">$</span><span class="number">6955</span></span></a> }
  }
  <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp op">&lt;$</span><span class="number">6955</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">6957</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6956</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">where <code class="koka">state(<span class="number">10</span>){ <a class="pp" href="#sumdown">sumdown<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>sumdown: <span class="tp sp">(</span><span class="tp tpp">sum</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">state</span><span class="tp sp">&#60;</span><span class="tp">int</span><span class="tp sp">&#62;</span><span class="tp sp">&#62;</span> <span class="tp">int</span></span></a>() }</code> evaluates to <code class="koka"><span class="number">55</span></code>. 
</p>
<p class="p learn button indent"><a href="#sec-default" title="3.1.6.&#8194;Optional and Named Parameters" class="localref" style="target-element:h3">Read more about default parameters <span class="fa fa-angle-double-up"></span></a></p>
<p class="p learn button indent"><a href="#sec-anon" title="3.1.4.&#8194;Anonymous Functions and Trailing Lambdas" class="localref" style="target-element:h3">Read more about <em class="em-low1">trailing lambdas</em> <span class="fa fa-angle-double-up"></span></a></p>
<p class="p learn button indent"><a href="#sec-var" title="3.2.4.&#8194;Local Mutable Variables" class="localref" style="target-element:h3">Read more about <code class="koka"><span class="kw">var</span></code> mutable variables <span class="fa fa-angle-double-up"></span></a></p>
<p class="p indent">Building on the previous state example, suppose we also like
to return the final state. A nice way to do this is to 
use a return operation again to pair the final result with the final state: 
</p><pre class="koka source"><span class="plaincode">fun pstate( init : a, action : () -&gt; &lt;state&lt;a&gt;,div|e&gt; b ) : &lt;div|e&gt; (b,a) {
  var st := init
  with handler {
    return(x){ (x,st) }      // pair with the final state
    fun get(){ st }
    fun set(i){ st := i }
  }
  action()
}
</span><span class="nicecode"><span class="decl-fun" id="pstate"><span class="kw">fun</span> <a class="pp" href="#pstate">pstate<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pstate: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a>( <a class="pp">init<span class="pc">init: <span class="tp op">$</span><span class="number">4166</span></span></a> <span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a>, <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp op">&lt;$</span><span class="number">4166</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">4168</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">4167</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="#type_space_state"><span class="tp">state</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>state: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">HX</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">b</span><span class="pc">b: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp"><span class="tp tv">b</span><span class="pc">b: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_scope">st<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>scope: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a> <span class="kw op">:=</span> <a class="pp">init<span class="pc">init: <span class="tp op">$</span><span class="number">4166</span></span></a>
  <span class="kw">with</span> <a class="pp"><span class="kw">handler</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp op">&lt;$</span><span class="number">4166</span><span class="op">&gt;</span>,local<span class="op">&lt;$</span><span class="number">4172</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">4168</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">4167</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;$</span><span class="number">4172</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">4168</span><span class="op">&gt;</span> (<span class="op">$</span><span class="number">4167</span>, <span class="op">$</span><span class="number">4166</span>)</span></a> {
    <span class="kw">return</span>(<a class="pp">x<span class="pc">x: <span class="tp tv">&#95;4181</span></span></a>){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">x<span class="pc">x: <span class="tp tv">&#95;4181</span></span></a>,<a class="pp">st<span class="pc">st: <span class="tp op">$</span><span class="number">4166</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> }      <span class="comment">// pair with the final state
</span>    <span class="kw">fun</span> <a class="pp">get<span class="pc">get: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">4172</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">4168</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">4166</span></span></a>(){ <a class="pp">st<span class="pc">st: <span class="tp op">$</span><span class="number">4166</span></span></a> }
    <span class="kw">fun</span> <a class="pp">set<span class="pc">set: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">4166</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;$</span><span class="number">4172</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">4168</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">i<span class="pc">i: <span class="tp op">$</span><span class="number">4166</span></span></a>){ <a class="pp">st<span class="pc">st: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">4172</span>,<span class="op">$</span><span class="number">4166</span><span class="op">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp">i<span class="pc">i: <span class="tp op">$</span><span class="number">4166</span></span></a> }
  }
  <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp op">&lt;$</span><span class="number">4166</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">4168</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">4167</span></span></a>()
</span>}
</span></pre>


<p class="p noindent">where <code class="koka"><a class="pp" href="#pstate">pstate<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pstate: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">state</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a>(<span class="number">10</span>){ <a class="pp" href="#sumdown">sumdown<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>sumdown: <span class="tp sp">(</span><span class="tp tpp">sum</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">state</span><span class="tp sp">&#60;</span><span class="tp">int</span><span class="tp sp">&#62;</span><span class="tp sp">&#62;</span> <span class="tp">int</span></span></a>() }</code> evaluates to <code class="koka">(<span class="number">55</span>,<span class="number">0</span>)</code>.  
</p>
<div class="advanced" style="border-left:1px solid #AAA;padding:0em 0em 0em 1em;margin:1em 0em">
<p class="p noindent"><span class="boxed-label" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">advanced</span>It is even possible to have a handler that only
contains a single <code class="koka"><span class="kw">return</span></code> operation: such handler handles no effect
at all but only transforms the final result of a function.
For example, we can define the previous example also with
a separate <code class="koka"><span class="kw">return</span></code> handler as:
</p><pre class="koka source"><span class="plaincode">fun pstate2( init : a, action : () -&gt; &lt;state&lt;a&gt;,div|e&gt; b ) : &lt;div|e&gt; (b,a) {
  var st := init
  with return(x){ (x,st) }
  with handler {
    fun get(){ st }
    fun set(i){ st := i }
  }
  action()
}
</span><span class="nicecode"><span class="decl-fun" id="pstate2"><span class="kw">fun</span> <a class="pp" href="#pstate2">pstate2<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pstate2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a>( <a class="pp">init<span class="pc">init: <span class="tp op">$</span><span class="number">6552</span></span></a> <span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a>, <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp op">&lt;$</span><span class="number">6552</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">6554</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6553</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="#type_space_state"><span class="tp">state</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>state: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">HX</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">b</span><span class="pc">b: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp"><span class="tp tv">b</span><span class="pc">b: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_scope">st<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>scope: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a> <span class="kw op">:=</span> <a class="pp">init<span class="pc">init: <span class="tp op">$</span><span class="number">6552</span></span></a>
  <span class="kw">with</span> <span class="kw">return</span>(<a class="pp">x<span class="pc">x: <span class="tp op">$</span><span class="number">6553</span></span></a>){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">x<span class="pc">x: <span class="tp op">$</span><span class="number">6553</span></span></a>,<a class="pp">st<span class="pc">st: <span class="tp op">$</span><span class="number">6552</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> }
  <span class="kw">with</span> <a class="pp"><span class="kw">handler</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp op">&lt;$</span><span class="number">6552</span><span class="op">&gt;</span>,local<span class="op">&lt;$</span><span class="number">6558</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">6554</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6553</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;$</span><span class="number">6558</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">6554</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6553</span></span></a> {
    <span class="kw">fun</span> <a class="pp">get<span class="pc">get: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">6558</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">6554</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6552</span></span></a>(){ <a class="pp">st<span class="pc">st: <span class="tp op">$</span><span class="number">6552</span></span></a> }
    <span class="kw">fun</span> <a class="pp">set<span class="pc">set: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">6552</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;$</span><span class="number">6558</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">6554</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">i<span class="pc">i: <span class="tp op">$</span><span class="number">6552</span></span></a>){ <a class="pp">st<span class="pc">st: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">6558</span>,<span class="op">$</span><span class="number">6552</span><span class="op">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp">i<span class="pc">i: <span class="tp op">$</span><span class="number">6552</span></span></a> }
  }
  <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp op">&lt;$</span><span class="number">6552</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">6554</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6553</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">Here it as a bit contrived but it can make certain
programs more concise in their definition, see 
for example&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#lindley:liberate" title="Liberating Effects with Rows and Handlers
Hillerstr&#246;m and Lindley, 2016" class="bibref localref" style="target-element:bibitem"><span class="cite-number">4</span></a>]</span>.</p></div><h3 id="sec-combine" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-combine" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4.6</span>.&#8194;</span>Combining Handlers</h3>
<div class="advanced" style="border-left:1px solid #AAA;padding:0em 0em 0em 1em;margin:1em 0em">
<p class="p noindent"><span class="boxed-label" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">advanced</span>What makes effect handlers a good control-flow abstraction? There are three fundamental advantages 
with regard to other approaches:
</p>
<ol class="ol compact">
<li class="li ol-li compact-li" style="margin-bottom:1ex"><em class="em-low1">Effect handlers can have simple (Hindley-Milner) types</em>. This unlike <code class="koka">shift</code>/<code class="koka">reset</code> for example as that needs 
type rules with <em class="em-low1">answer</em> types (as the type of <code class="koka">shift</code> depends on the context of its matching <code class="koka">reset</code>).
</li>
<li class="li ol-li compact-li" style="margin-bottom:1ex"><em class="em-low1">The scope of an effect handler is delimited</em> by the handler definition. This is just like <code class="koka">shift</code>/<code class="koka">reset</code> 
but unlike <code class="code code2">call/cc</code>. Delimiting the scope of a resumption has various good properties, like efficient
implementation strategies, but also that it allows for modular composition 
(see also Oleg Kiselyov&#39;s&nbsp;<a href="http://okmij.org/ftp/continuations/against-callcc.html">&#8220;against call/cc&#8221;</a>).
</li>
<li class="li ol-li compact-li" style="margin-bottom:1ex"><em class="em-low1">Effect handlers can be composed freely</em>. This is unlike general <em class="em-low1">monads</em> which need monad transformers to 
compose in particular ways. Essentially effect handlers can compose freely because every effect handler
can be expressed eventually as an instance of a <em class="em-low1">free monad</em> which <em class="em-low1">do</em> compose. This also means that
some monads cannot be expressed as an effect handler (namely the non-algebraic ones). A particular example
of this is the continuation monad (which can express <code class="code code2">call/cc</code>).
</li></ol>

<p class="p noindent">The Koka compiler internally uses monads and <code class="koka">shift</code>/<code class="koka">reset</code> to compile effect handlers though, and
it compiles handlers into to an internal free monad based on multi-prompt delimited control&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#gunter:mprompt" title="A Generalization of Exceptions and Control in ML-like Languages
Gunter, R&#233;my, and Riecke, 1995" class="bibref localref" style="target-element:bibitem"><span class="cite-number">3</span></a>, <a href="#xie:evidence-tr" title="Generalized Evidence Passing for Effect Handlers
Xie and Leijen, 2021" class="bibref localref" style="target-element:bibitem"><span class="cite-number">17</span></a>]</span>. 
By inlining the monadic <em class="em-low1">bind</em> we are able to generate efficient C code that only allocates continuations 
in the case one is actually yielding up to a general <code class="koka"><span class="kw">control</span></code> operation.</p></div>
<p class="p noindent">A great property of effect handlers is that they can be freely composed together. 
For example, suppose we have a function 
that calls <code class="koka">raise</code> if the state is an odd number:
</p><pre class="koka source"><span class="plaincode">fun no-odds() : &lt;raise,state&lt;int&gt;&gt; int {
  val i = get()
  if (i.is-odd) then raise("no odds") else {
    set(i / 2)
    i
  }
}
</span><span class="nicecode"><span class="decl-fun" id="no_odds"><span class="kw">fun</span> <a class="pp" href="#no_odds">no-odds<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>no<span class="dash">-</span>odds: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp sp">,</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span> <span class="tp">int</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__gt_"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;&gt;): <span class="tp">E</span></span></a><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a><span class="tp sp">,</span><a class="pp" href="#type_space_state"><span class="tp">state</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>state: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">HX</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="#get">get<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp tv">a</span></span></a>()
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#is_odd">is-odd<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>odd: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp" href="#raise">raise<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">raise</span> <span class="tp tv">a</span></span></a>(<span class="st">"no odds"</span>) <span class="kw">else</span> {
    <a class="pp" href="#set">set<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">2</span>)
    <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>
  }
</span>}
</span></pre>



<p class="p noindent">then we can compose a <code class="koka"><a class="pp" href="#pstate">pstate<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pstate: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">state</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a></code> and <code class="koka"><a class="pp" href="#raise_maybe">raise<span class="dash">-</span>maybe<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise<span class="dash">-</span>maybe: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">raise</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code> handler together
to handle the effects:
</p><pre class="koka source"><span class="plaincode">fun state-raise(init) : div (maybe&lt;int&gt;,int) {
  with pstate(init)  
  with raise-maybe  
  no-odds()
}
</span><span class="nicecode"><span class="decl-fun" id="state_raise"><span class="kw">fun</span> <a class="pp" href="#state_raise">state-raise<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>state<span class="dash">-</span>raise: <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp sp">(</span><span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a>(<a class="pp">init<span class="pc">init: <span class="tp">int</span></span></a>) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> {
  <span class="kw">with</span> <a class="pp" href="#pstate">pstate<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pstate: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a>(<a class="pp">init<span class="pc">init: <span class="tp">int</span></span></a>)  
  <span class="kw">with</span> <a class="pp" href="#raise_maybe">raise-maybe<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise<span class="dash">-</span>maybe: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>  
  <a class="pp" href="#no_odds">no-odds<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>no<span class="dash">-</span>odds: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp sp">,</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span> <span class="tp">int</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">where both the <code class="koka"><a class="pp" href="#type_space_state"><span class="tp">state</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>state: <span class="tp">V</span> <span class="tp kw op">-&gt;</span> <span class="tp">HX</span></span></a><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&#62;</span></code> and <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code> effects are discharged by the respective handlers.
Note the type reflects that we always return a pair with as a first element either
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code> (if <code class="koka">raise</code> was called) or a <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code> with the final result, and as the second element
the final state. This corresponds to how we usually combine state and exceptions where the 
state (or heap) has set to the state at the point the exception happened.
</p>
<p class="p indent">However, if we combine the handlers in the opposite order, we get a form of transactional
state where we either get an exception (and no final state), or we get a pair of the 
result with the final state:
</p><pre class="koka source"><span class="plaincode">fun raise-state(init) : div maybe&lt;(int,int)&gt; {
  with raise-maybe  
  with pstate(init)  
  no-odds()
}
</span><span class="nicecode"><span class="decl-fun" id="raise_state"><span class="kw">fun</span> <a class="pp" href="#raise_state">raise-state<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise<span class="dash">-</span>state: <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">init<span class="pc">init: <span class="tp">int</span></span></a>) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <span class="kw">with</span> <a class="pp" href="#raise_maybe">raise-maybe<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise<span class="dash">-</span>maybe: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>  
  <span class="kw">with</span> <a class="pp" href="#pstate">pstate<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pstate: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a>(<a class="pp">init<span class="pc">init: <span class="tp">int</span></span></a>)  
  <a class="pp" href="#no_odds">no-odds<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>no<span class="dash">-</span>odds: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp sp">,</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span> <span class="tp">int</span></span></a>()
</span>}
</span></pre>


<h3 id="sec-mask" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-mask" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4.7</span>.&#8194;</span>Masking Effects</h3>
<p class="p noindent">Similar to masking signals in Unix, we can mask effects to not be handled by
their innermost effect handler. The expression <code class="koka"><span class="kw">mask</span><span class="op">&#60;</span>eff<span class="op">&#62;</span>(action)</code> modularly masks
any effect operations in <code class="koka"><span class="tp">eff</span></code> inside the <code class="koka">action</code>. For example,
consider two nested handlers for the <code class="koka">emit</code> operation:
</p><pre class="koka source"><span class="plaincode">fun mask-emit() {
  with fun emit(msg){ println("outer:" ++ msg) }
  with fun emit(msg){ println("inner:" ++ msg) }
  emit("hi")
  mask&lt;emit&gt;{ emit("there") }
}
</span><span class="nicecode"><span class="decl-fun" id="mask_emit"><span class="kw">fun</span> <a class="pp" href="#mask_emit">mask-emit<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>mask<span class="dash">-</span>emit: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp sp">,</span><span class="tp">console</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <span class="kw">fun</span> <a class="pp">emit<span class="pc">emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"outer:"</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__plus__1">++<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(++)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>) }
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp sp">,</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <span class="kw">fun</span> <a class="pp">emit<span class="pc">emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"inner:"</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__plus__1">++<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(++)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>) }
  <a class="pp" href="#emit">emit<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"hi"</span>)
  <span class="kw">mask</span><span class="op">&lt;</span><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a><span class="op">&gt;</span>{ <a class="pp" href="#emit">emit<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"there"</span>) }
</span>}
</span></pre>


<p class="p noindent">If we call <code class="koka"><a class="pp" href="#mask_emit">mask<span class="dash">-</span>emit<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>mask<span class="dash">-</span>emit: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>()</code> it prints:
</p>
<pre class="para-block pre-fenced pre-fenced4" style="display:block"><code>inner: hi
outer: there</code></pre>
<p class="p noindent para-continued">The second call to <code class="koka">emit</code> is masked and therefore it skips the innermost
handler and is handled subsequently by the outer handler (i.e. mask only
masks an operation once for its innermost handler). 
</p>
<p class="p indent">The type of <code class="koka"><span class="kw">mask</span><span class="op">&#60;</span>l<span class="op">&#62;</span></code> for some effect label <code class="koka"><span class="tp tv">l</span></code> is <code class="koka"><span class="tp sp">(</span><span class="tp tpp">action</span><span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp tv">l</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span></code>
where it injects the effect <code class="koka"><span class="tp tv">l</span></code> into the final effect result <code class="koka"><span class="tp sp">&#60;</span><span class="tp tv">l</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span></code> (even
thought the <code class="koka"><span class="kw">mask</span></code> itself never
actually performs any operation in <code class="koka"><span class="tp tv">l</span></code> &#8211; it only masks any operations
of <code class="koka"><span class="tp tv">l</span></code> in <code class="koka">action</code>).
</p>
<p class="p indent">This type usually leads to duplicate effect labels, for example,
the effect of <code class="koka"><span class="kw">mask</span><span class="op">&#60;</span>emit<span class="op">&#62;</span>{ emit(<span class="st">&#34;there&#34;</span>) }</code> is <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a><span class="tp sp">,</span><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a><span class="tp sp">&#62;</span></code> signifying
that there need to be two handlers for <code class="koka"><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a></code>: in this case, one to skip 
over, and one to subsequently handle the masked operation.
</p><h4 id="sec-effect-abstraction" class="h4" data-heading-depth="4" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">Effect Abstraction</h4>
<p class="p noindent">The previous example is not very useful, but generally we can 
use <code class="koka"><span class="kw">mask</span></code> to hide internal effect handling from higher-order functions.
For example, consider the following function that needs to handle
internal exceptions:
</p><pre class="koka source"><span class="plaincode">fun mask-print( action : () -&gt; e int ) : e int {
  with control raise(msg){ 42 }
  val x = mask&lt;raise&gt;(action)
  if (x.is-odd) then raise("wrong")   // internal exception
  x
}  
</span><span class="nicecode"><span class="decl-fun" id="mask_print"><span class="kw">fun</span> <a class="pp" href="#mask_print">mask-print<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>mask<span class="dash">-</span>print: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">int</span></span></a>( <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp op">$</span><span class="number">6176</span> int</span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">raise</span><span class="tp op">|$</span><span class="number">6176</span><span class="op">&gt;</span> int) <span class="kw op">-></span> <span class="op">$</span><span class="number">6176</span> int</span></a> <span class="kw">control</span> <a class="pp">raise<span class="pc">raise: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">resume</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">&#95;6181</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;6180</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;6180</span> <span class="tp">int</span></span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <span class="number">42</span> }
  <span class="kw">val</span> <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="kw">=</span> <span class="kw">mask</span><span class="op">&lt;</span><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a><span class="op">&gt;</span>(<a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp op">$</span><span class="number">6176</span> int</span></a>)
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#is_odd">is-odd<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>odd: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp" href="#raise">raise<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">raise</span> <span class="tp tv">a</span></span></a>(<span class="st">"wrong"</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a>   <span class="comment">// internal exception
</span>  <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>
</span>}  
</span></pre>



<p class="p noindent">Here the type of <code class="koka"><a class="pp" href="#mask_print">mask<span class="dash">-</span>print<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>mask<span class="dash">-</span>print: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp">int</span></span></a></code> does not expose at all that we handle the <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code>
effect internally for specific code and it is fully abstract &#8211; even if the action itself would call <code class="koka">raise</code>,
it would neatly skip the internal handler due to the <code class="koka"><span class="kw">mask</span><span class="op">&#60;</span>raise<span class="op">&#62;</span></code> expression.
</p>
<p class="p indent">If we would leave out the <code class="koka"><span class="kw">mask</span></code>, and call <code class="koka">action()</code> directly, then the inferred
type of <code class="koka">action</code> would be <code class="koka"><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code> instead, showing that the <code class="koka"><a class="pp" href="#type_space_raise"><span class="tp">raise</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>raise: <span class="tp">HX</span></span></a></code>
effect would be handled. 
Note that this usually the desired behaviour since in the majority of cases 
we <em class="em-low1">want</em> to handle the effects in a particular way when defining handler abstractions. 
The cases where <code class="koka"><span class="kw">mask</span></code> is needed are much less common in our experience.
</p>
<div class="advanced" style="border-left:1px solid #AAA;padding:0em 0em 0em 1em;margin:1em 0em">
<p class="p noindent"><span class="boxed-label" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">advanced</span>
</p><h4 id="sec-state-as-a-combined-effect" class="h4" data-heading-depth="4" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">State as a Combined Effect</h4>
<p class="p noindent">Another nice use-case for <code class="koka"><span class="kw">mask</span></code> occurs when modeling state directly using
effect handlers without using mutable local variables&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#biernacki:care" title="Handle with Care: Relational Interpretation of Algebraic Effects and Handlers
Biernacki, Pir&#243;g, Polesiuk, and Sieczkowski, 2017" class="bibref localref" style="target-element:bibitem"><span class="cite-number">1</span></a>]</span>. We can do this
using two separate operations <code class="koka">peek</code> and <code class="koka">poke</code>:
</p><pre class="koka source"><span class="plaincode">effect&lt;a&gt; val peek : a                 // get the state
effect&lt;a&gt; control poke( x : a ) : ()   // set the state to x
</span><span class="nicecode"><span class="decl-type" id="type_space_peek"><span class="tp kw">effect</span><span class="tp sp">&lt;</span><a class="pp"><span class="tp">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> <span class="kw">val</span> <span class="decl-con" id="con_space_Peek"><a class="pp" href="#peek">peek<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>peek: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">value</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a></span></span> <span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a>                 <span class="comment">// get the state
</span><span class="decl-type" id="type_space_poke"><span class="tp kw">effect</span><span class="tp sp">&lt;</span><a class="pp"><span class="tp">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> <span class="kw">control</span> <span class="decl-fun" id="poke"><a class="pp" href="#poke">poke<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>poke: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">poke</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></span></span>( <a class="pp">x<span class="pc">x: <span class="tp op">$</span><span class="number">6302</span></span></a> <span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a>   <span class="comment">// set the state to x
</span></span></pre>



<p class="p noindent">We can now define a generic state handler as:
</p><pre class="koka source"><span class="plaincode">fun ppstate( init : a, action : () -&gt; &lt;peek&lt;a&gt;,poke&lt;a&gt;|e&gt; b ) : e b {
  with val peek = init
  with control poke( x ) {
    mask&lt;peek&gt; {
      with val peek = x
      resume(())
    }
  }
  action()
}
</span><span class="nicecode"><span class="decl-fun" id="ppstate"><span class="kw">fun</span> <a class="pp" href="#ppstate">ppstate<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>ppstate: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">peek</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">poke</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span></span></a>( <a class="pp">init<span class="pc">init: <span class="tp op">$</span><span class="number">6330</span></span></a> <span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a>, <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">peek</span><span class="tp op">&lt;$</span><span class="number">6330</span><span class="op">&gt;</span>,poke<span class="op">&lt;$</span><span class="number">6330</span><span class="op">&gt;|$</span><span class="number">6332</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6331</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="#type_space_peek"><span class="tp">peek</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>peek: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">HX1</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="#type_space_poke"><span class="tp">poke</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>poke: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">HX</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">b</span><span class="pc">b: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a> <a class="pp"><span class="tp tv">b</span><span class="pc">b: <span class="tp">V</span></span></a> {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">peek</span><span class="tp op">&lt;$</span><span class="number">6330</span><span class="op">&gt;|$</span><span class="number">6332</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6331</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">6332</span> <span class="op">$</span><span class="number">6331</span></span></a> <span class="kw">val</span> <a class="pp">peek<span class="pc">peek: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp op">$</span><span class="number">6332</span> <span class="op">$</span><span class="number">6330</span></span></a> <span class="kw">=</span> <a class="pp">init<span class="pc">init: <span class="tp op">$</span><span class="number">6330</span></span></a>
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">poke</span><span class="tp op">&lt;$</span><span class="number">6330</span><span class="op">&gt;</span>,peek<span class="op">&lt;$</span><span class="number">6330</span><span class="op">&gt;|$</span><span class="number">6332</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6331</span>) <span class="kw op">-></span> <span class="op">&lt;</span>peek<span class="op">&lt;$</span><span class="number">6330</span><span class="op">&gt;|$</span><span class="number">6332</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6331</span></span></a> <span class="kw">control</span> <a class="pp">poke<span class="pc">poke: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">6330</span>, resume <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">peek</span><span class="tp op">&lt;$</span><span class="number">6330</span><span class="op">&gt;|$</span><span class="number">6332</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6331</span>) <span class="kw op">-></span> <span class="op">&lt;</span>peek<span class="op">&lt;$</span><span class="number">6330</span><span class="op">&gt;|$</span><span class="number">6332</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6331</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp op">$</span><span class="number">6330</span></span></a> ) {
    <a class="pp"><span class="tp">mask</span><span class="pc">&#95;1: <span class="tp">V</span></span></a><span class="op">&lt;</span><a class="pp" href="#type_space_peek"><span class="tp">peek</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>peek: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">HX1</span></span></a><span class="op">&gt;</span> {
      <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">peek</span><span class="tp op">&lt;$</span><span class="number">6330</span><span class="op">&gt;|$</span><span class="number">6332</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6331</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">6332</span> <span class="op">$</span><span class="number">6331</span></span></a> <span class="kw">val</span> <a class="pp">peek<span class="pc">peek: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp op">$</span><span class="number">6332</span> <span class="op">$</span><span class="number">6330</span></span></a> <span class="kw">=</span> <a class="pp">x<span class="pc">x: <span class="tp op">$</span><span class="number">6330</span></span></a>
      <a class="pp">resume<span class="pc">resume: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">peek</span><span class="tp op">&lt;$</span><span class="number">6330</span><span class="op">&gt;|$</span><span class="number">6332</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6331</span></span></a>(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space__lp__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a>)
    }
  }
  <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">peek</span><span class="tp op">&lt;$</span><span class="number">6330</span><span class="op">&gt;</span>,poke<span class="op">&lt;$</span><span class="number">6330</span><span class="op">&gt;|$</span><span class="number">6332</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">6331</span></span></a>()
</span>}
</span></pre>


<p class="p noindent">In the handler for <code class="koka">poke</code> we resume under a fresh handler for <code class="koka">peek</code> that
is bound to the new state. This means though there will be an ever increasing
&#8220;stack&#8221; of handlers for <code class="koka">peek</code>. To keep the type from growing infinitely, we
need to mask out any potential operation to a previous handler of <code class="koka">peek</code> which
is why the <code class="koka"><span class="kw">mask</span></code> is needed. (Another way of looking at this is to just follow
the typing: <code class="koka">action</code> has a <code class="koka"><a class="pp" href="#type_space_peek"><span class="tp">peek</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>peek: <span class="tp">V</span> <span class="tp kw op">-&gt;</span> <span class="tp">HX1</span></span></a></code> effect, and unifies with the effect of
the <code class="koka">poke</code> operation definition. Since it handles its own <code class="koka"><a class="pp" href="#type_space_peek"><span class="tp">peek</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>peek: <span class="tp">V</span> <span class="tp kw op">-&gt;</span> <span class="tp">HX1</span></span></a></code> effect, it needs
to be injected back in with a <code class="koka"><span class="kw">mask</span></code>.)
</p>
<p class="p indent">(Note: since the handler stack grows indefinitely on every <code class="koka">poke</code> this example
is mostly of theoretical interest. However, we are looking into a <em class="em-low1">stack smashing</em>
technique where we detect at runtime that a <code class="koka"><span class="kw">mask</span></code> can discard a handler frame
from the stack.)
</p></div><h3 id="sec-overriding-handlers" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-overriding-handlers" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4.8</span>.&#8194;</span>Overriding Handlers</h3>
<p class="p noindent">A common use for masking is to override handlers. For example, consider
overriding the behavour of <code class="koka">emit</code>:
</p><pre class="koka source"><span class="plaincode">fun emit-quoted1( action : () -&gt; &lt;emit,emit|e&gt; a ) : &lt;emit|e&gt; a {
  with fun emit(msg){ emit("\"" ++ msg ++ "\"" ) }
  action()
}
</span><span class="nicecode"><span class="decl-fun" id="emit_quoted1"><span class="kw">fun</span> <a class="pp" href="#emit_quoted1">emit-quoted1<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit<span class="dash">-</span>quoted1: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span></span></a>( <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp op">|$</span><span class="number">5333</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">5332</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a><span class="tp sp">,</span><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a> {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp op">|$</span><span class="number">5333</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">5332</span>) <span class="kw op">-></span> <span class="op">&lt;</span>emit<span class="op">|$</span><span class="number">5333</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">5332</span></span></a> <span class="kw">fun</span> <a class="pp">emit<span class="pc">emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp op">|$</span><span class="number">5333</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <a class="pp" href="#emit">emit<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"\""</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__plus__1">++<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(++)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__plus__1">++<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(++)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">"\""</span> ) }
  <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp op">|$</span><span class="number">5333</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">5332</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">Here, the handler for <code class="koka">emit</code> calls itself <code class="koka">emit</code> to actually emit the newly
quoted string. The effect type inferred for <code class="koka"><a class="pp" href="#emit_quoted1">emit<span class="dash">-</span>quoted1<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit<span class="dash">-</span>quoted1: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">emit</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span></span></a></code> is <code class="koka"><span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a><span class="tp sp">,</span><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span></code>.
This is not the nicest type as it exposes that <code class="koka">action</code> is evaluated under (at least) two
<code class="koka"><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a></code> handlers (and someone could use <code class="koka"><span class="kw">mask</span></code> inside <code class="koka">action</code> to use the outer <code class="koka"><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a></code> handler).
</p>
<p class="p indent">The <code class="koka"><span class="kw">override</span></code> keyword keeps the type nice and fully overrides the
previous handler which is no longer accessible from <code class="koka">action</code>:
</p><pre class="koka source"><span class="plaincode">fun emit-quoted2( action : () -&gt; &lt;emit|e&gt; a ) : &lt;emit|e&gt; a {
  with override fun emit(msg){ emit("\"" ++ msg ++ "\"" ) }
  action()
}
</span><span class="nicecode"><span class="decl-fun" id="emit_quoted2"><span class="kw">fun</span> <a class="pp" href="#emit_quoted2">emit-quoted2<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit<span class="dash">-</span>quoted2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span></span></a>( <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp op">|$</span><span class="number">5439</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">5438</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="#type_space_emit"><span class="tp">emit</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp">HX</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a> {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp sp">,</span><span class="tp">emit</span><span class="tp op">|$</span><span class="number">5439</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">5438</span>) <span class="kw op">-></span> <span class="op">&lt;</span>emit<span class="op">|$</span><span class="number">5439</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">5438</span></span></a> <span class="kw">override</span> <span class="kw">fun</span> <a class="pp">emit<span class="pc">emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp op">|$</span><span class="number">5439</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a>){ <a class="pp" href="#emit">emit<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>emit: <span class="tp sp">(</span><span class="tp tpp">msg</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">emit</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"\""</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__plus__1">++<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(++)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">msg<span class="pc">msg: <span class="tp">string</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__plus__1">++<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(++)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">"\""</span> ) }
  <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">emit</span><span class="tp op">|$</span><span class="number">5439</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">5438</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">This of course applies to any handler or value, for example,
to temporarily increase the <code class="koka">width</code> while pretty printing, 
we can override the <code class="koka">width</code> as:
</p><pre class="koka source"><span class="plaincode">fun extra-wide( action ) {
  with override val width = 2&#42;width
  action()
}
</span><span class="nicecode"><span class="decl-fun" id="extra_wide"><span class="kw">fun</span> <a class="pp" href="#extra_wide">extra-wide<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>extra<span class="dash">-</span>wide: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">width</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">width</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span></span></a>( <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">width</span><span class="tp kw op">|</span><span class="tp tv">&#95;5572</span><span class="tp sp">&gt;</span> <span class="tp tv">&#95;5557</span></span></a> ) {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">width</span><span class="tp sp">,</span><span class="tp">width</span><span class="tp kw op">|</span><span class="tp tv">&#95;5572</span><span class="tp sp">&gt;</span> <span class="tp tv">&#95;5557</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">width</span><span class="tp kw op">|</span><span class="tp tv">&#95;5572</span><span class="tp sp">&gt;</span> <span class="tp tv">&#95;5557</span></span></a> <span class="kw">override</span> <span class="kw">val</span> <a class="pp">width<span class="pc">width: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">width</span><span class="tp kw op">|</span><span class="tp tv">&#95;5572</span><span class="tp sp">&gt;</span> <span class="tp">int</span></span></a> <span class="kw">=</span> <span class="number">2</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp" href="#width">width<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>width: <span class="tp">value</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>
  <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">width</span><span class="tp kw op">|</span><span class="tp tv">&#95;5572</span><span class="tp sp">&gt;</span> <span class="tp tv">&#95;5557</span></span></a>()
</span>}
</span></pre>




<div class="advanced" style="border-left:1px solid #AAA;padding:0em 0em 0em 1em;margin:1em 0em">
<p class="p noindent"><span class="boxed-label" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">advanced</span>
</p><h4 id="sec-mask-behind" class="h4" data-heading-depth="4" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">Mask Behind</h4>
<p class="p noindent">Unfortunately, we cannot modularly define overriding with just <code class="koka"><span class="kw">mask</span></code>; if we 
add <code class="koka"><span class="kw">mask</span></code> outside of the <code class="koka">emit</code> handler, the <code class="koka">emit</code> call inside the operation 
definition would get masked and skip our intended handler. On the other hand,
if we add <code class="koka"><span class="kw">mask</span></code> just over <code class="koka">action</code> all its <code class="koka">emit</code> calls would be masked for
our intended handler! 
</p>
<p class="p indent">For this situation, there is another primitive that only &#8220;masks the masks&#8221;.
The expression <code class="koka"><span class="kw">mask</span> behind<span class="op">&#60;</span>eff<span class="op">&#62;</span></code> has type <code class="koka"><span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">eff</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">eff</span><span class="tp sp">,</span><span class="tp">eff</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span></code>
and only masks any masked operations but not the direct ones. The <code class="koka"><span class="kw">override</span></code>
keyword is defined in terms of this primitive:
</p>
<div class="translate" style="border:1px solid #AAA;padding:0em 1em;margin:1em 0em">
<p class="p boxed-label noindent" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">translation</p>
<div class="translate-row"><pre class="koka source unchecked"><span class="plaincode">with override handler&lt;eff&gt; { &lt;ops&gt; }
&lt;body&gt;
</span><span class="nicecode"><span class="kw">with</span> <span class="kw">override</span> <span class="kw">handler</span><span class="op">&lt;</span>eff<span class="op">&gt;</span> { <span class="op">&lt;</span>ops<span class="op">&gt;</span> }
<span class="op">&lt;</span>body<span class="op">&gt;</span>
</span></pre>


<p class="p noindent"><span class="mapsto" style="padding:0ex 1em;align-self:center;font-size:125%"><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.4371em;width:1.0890em" viewBox='34.67 57.872 10.371 4.163'><desc>$\mathpre{\rightsquigarrow}$</desc><g id='math-f156e3'><use x='34.869' y='61.836' xlink:href='#g4-32'/></g></svg></span>
</p><pre class="koka source unchecked"><span class="plaincode">(handler&lt;eff&gt; { &lt;ops&gt; })(mask behind&lt;eff&gt;{ &lt;body&gt; })
</span><span class="nicecode">(<span class="kw">handler</span><span class="op">&lt;</span>eff<span class="op">&gt;</span> { <span class="op">&lt;</span>ops<span class="op">&gt;</span> })(<span class="kw">mask</span> behind<span class="op">&lt;</span>eff<span class="op">&gt;</span>{ <span class="op">&lt;</span>body<span class="op">&gt;</span> })
</span></pre>
</div></div>
<p class="p noindent">This ensures any operation calls in <code class="code code2">&lt;body&gt;</code> go the newly defined
handler while any masked operations are masked one more level and skip
both of the two innermost handlers.</p></div><h3 id="sec-isolate" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-isolate" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4.9</span>.&#8194;</span>Side-effect Isolation</h3><h3 id="sec-multi-resume" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-multi-resume" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4.10</span>.&#8194;</span>Resuming more than once</h3>
<p class="p noindent">Since <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#resume">resume<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>resume: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">resume<span class="dash">-</span>context</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">b</span></span></a></code> is a first-class function (well, almost, see&nbsp;<a href="#sec-rcontrol" title="Raw Control" class="localref" style="target-element:h4">raw control</a>),
it is possible to store it in a list for example to implement a scheduler,
but it is also possible to invoke it more than once. This can be used to
implement backtracking or probabilistic programming models. 
</p>
<p class="p indent">A common example of multiple resumptions is the <code class="koka"><a class="pp" href="#type_space_choice"><span class="tp">choice</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice: <span class="tp">HX</span></span></a></code> effect:
</p><pre class="koka source"><span class="plaincode">effect control choice() : bool

fun xor() : choice bool {
  val p = choice()
  val q = choice()
  if (p) then !q else q
}
</span><span class="nicecode"><span class="decl-type" id="type_space_choice"><span class="tp kw">effect</span> <span class="kw">control</span> <span class="decl-fun" id="choice"><a class="pp" href="#choice">choice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">choice</span> <span class="tp">bool</span></span></a></span></span>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a>

<span class="decl-fun" id="xor"><span class="kw">fun</span> <a class="pp" href="#xor">xor<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>xor: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">choice</span> <span class="tp">bool</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="#type_space_choice"><span class="tp">choice</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice: <span class="tp">HX</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">p<span class="pc">p: <span class="tp">bool</span></span></a> <span class="kw">=</span> <a class="pp" href="#choice">choice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">choice</span> <span class="tp">bool</span></span></a>()
  <span class="kw">val</span> <a class="pp">q<span class="pc">q: <span class="tp">bool</span></span></a> <span class="kw">=</span> <a class="pp" href="#choice">choice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">choice</span> <span class="tp">bool</span></span></a>()
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">p<span class="pc">p: <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_excl__1">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(!)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">b</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><a class="pp">q<span class="pc">q: <span class="tp">bool</span></span></a> <span class="kw">else</span> <a class="pp">q<span class="pc">q: <span class="tp">bool</span></span></a>
</span>}
</span></pre>



<p class="p noindent">One possible implementation just uses random numbers:
</p><pre class="koka source"><span class="plaincode">fun choice-random(action : () -&gt; &lt;choice,random|e&gt; a) : &lt;random|e&gt; a {
  with fun choice(){ random-bool() }
  action()
}
</span><span class="nicecode"><span class="decl-fun" id="choice_random"><span class="kw">fun</span> <a class="pp" href="#choice_random">choice-random<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice<span class="dash">-</span>random: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">choice</span><span class="tp sp">,</span><span class="tp">random</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">random</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span></span></a>(<a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">choice</span><span class="tp sp">,</span><span class="tp">random</span><span class="tp op">|$</span><span class="number">4057</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">4056</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="#type_space_choice"><span class="tp">choice</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice: <span class="tp">HX</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_random.html#type_space_random"><span class="tp">random</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>random<span class="fslash last">/</span></span>random: <span class="tp">HX</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a>) <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_random.html#type_space_random"><span class="tp">random</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>random<span class="fslash last">/</span></span>random: <span class="tp">HX</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a> {
  <a class="pp"><span class="kw">with</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">choice</span><span class="tp sp">,</span><span class="tp">random</span><span class="tp op">|$</span><span class="number">4057</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">4056</span>) <span class="kw op">-></span> <span class="op">&lt;</span>random<span class="op">|$</span><span class="number">4057</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">4056</span></span></a> <span class="kw">fun</span> <a class="pp">choice<span class="pc">choice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">random</span><span class="tp op">|$</span><span class="number">4057</span><span class="op">&gt;</span> bool</span></a>(){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_random.html#random_bool">random-bool<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>random<span class="fslash last">/</span></span>random<span class="dash">-</span>bool: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">random</span> <span class="tp">bool</span></span></a>() }
  <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">choice</span><span class="tp sp">,</span><span class="tp">random</span><span class="tp op">|$</span><span class="number">4057</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">4056</span></span></a>()
</span>}
</span></pre>



<p class="p noindent">Where <code class="koka"><a class="pp" href="#choice_random">choice<span class="dash">-</span>random<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice<span class="dash">-</span>random: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">choice</span><span class="tp sp">,</span><span class="tp">random</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">random</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span></span></a>(<a class="pp" href="#xor">xor<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>xor: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">choice</span> <span class="tp">bool</span></span></a>)</code> returns <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></code> and <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a></code> at random.
</p>
<p class="p indent">However, we can also resume multiple times, once with <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a></code> and once with <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></code>,
to return <em class="em-low1">all</em> possible outcomes. This also changes the handler type to return a <em class="em-low1">list</em>
of all results of the action, and we need a&nbsp;<a href="#sec-return" title="3.4.5.&#8194;Return Operations" class="localref" style="target-element:h3">return clause</a> to wrap the result
of the action in a singleton list:
</p><pre class="koka source"><span class="plaincode">fun choice-all(action : () -&gt; &lt;choice|e&gt; a) : e list&lt;a&gt; {
  with handler {
    return(x){ [x] }
    control choice(){ resume(False) ++ resume(True) }
  }
  action()
}
</span><span class="nicecode"><span class="decl-fun" id="choice_all"><span class="kw">fun</span> <a class="pp" href="#choice_all">choice-all<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice<span class="dash">-</span>all: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">choice</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">choice</span><span class="tp op">|$</span><span class="number">3980</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">3979</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="#type_space_choice"><span class="tp">choice</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice: <span class="tp">HX</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__bar__gt_"><span class="tp">|</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;|&gt;): <span class="tp sp">(</span><span class="tp">X</span><span class="tp sp">,</span> <span class="tp">E</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a>) <span class="tp kw op">:</span> <a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <span class="kw">with</span> <a class="pp"><span class="kw">handler</span><span class="pc">handler: <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">choice</span><span class="tp op">|$</span><span class="number">3980</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">3979</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">3980</span> list<span class="op">&lt;$</span><span class="number">3979</span><span class="op">&gt;</span></span></a> {
    <span class="kw">return</span>(<a class="pp">x<span class="pc">x: <span class="tp op">$</span><span class="number">3979</span></span></a>){ <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a><a class="pp">x<span class="pc">x: <span class="tp op">$</span><span class="number">3979</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">]</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> }
    <span class="kw">control</span> <a class="pp">choice<span class="pc">choice: <span class="tp sp">(</span><span class="tp tpp">resume</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp op">$</span><span class="number">3980</span> list<span class="op">&lt;$</span><span class="number">3979</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">3980</span> list<span class="op">&lt;$</span><span class="number">3979</span><span class="op">&gt;</span></span></a>(){ <a class="pp">resume<span class="pc">resume: <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp op">$</span><span class="number">3980</span> list<span class="op">&lt;$</span><span class="number">3979</span><span class="op">&gt;</span></span></a>(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__plus_">++<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(++): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">ys</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <a class="pp">resume<span class="pc">resume: <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp op">$</span><span class="number">3980</span> list<span class="op">&lt;$</span><span class="number">3979</span><span class="op">&gt;</span></span></a>(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>) }
  }
  <a class="pp">action<span class="pc">action: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">choice</span><span class="tp op">|$</span><span class="number">3980</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">3979</span></span></a>()
</span>}
</span></pre>


<p class="p noindent">where <code class="koka"><a class="pp" href="#choice_all">choice<span class="dash">-</span>all<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice<span class="dash">-</span>all: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">choice</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a>(<a class="pp" href="#xor">xor<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>xor: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">choice</span> <span class="tp">bool</span></span></a>)</code> returns <code class="koka">[<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>]</code>.
</p>
<p class="p indent">Resuming more than once interacts in interesting ways with the
state effect. Consider the following example that uses both
<code class="koka"><a class="pp" href="#type_space_choice"><span class="tp">choice</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice: <span class="tp">HX</span></span></a></code> and <code class="koka"><a class="pp" href="#type_space_state"><span class="tp">state</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>state: <span class="tp">V</span> <span class="tp kw op">-&gt;</span> <span class="tp">HX</span></span></a></code>:
</p><pre class="koka source"><span class="plaincode">fun surprising() : &lt;choice,state&lt;int&gt;&gt; bool {
  val p = choice()
  val i = get()
  set(i+1)
  if (i&gt;0 &amp;&amp; p) then xor() else False
}
</span><span class="nicecode"><span class="decl-fun" id="surprising"><span class="kw">fun</span> <a class="pp" href="#surprising">surprising<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>surprising: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">choice</span><span class="tp sp">,</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span> <span class="tp">bool</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lt__gt_"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&lt;&gt;): <span class="tp">E</span></span></a><a class="pp" href="#type_space_choice"><span class="tp">choice</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice: <span class="tp">HX</span></span></a><span class="tp sp">,</span><a class="pp" href="#type_space_state"><span class="tp">state</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>state: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">HX</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">p<span class="pc">p: <span class="tp">bool</span></span></a> <span class="kw">=</span> <a class="pp" href="#choice">choice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">choice</span> <span class="tp">bool</span></span></a>()
  <span class="kw">val</span> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="#get">get<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp tv">a</span></span></a>()
  <a class="pp" href="#set">set<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">1</span>)
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_gt__1">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><span class="number">0</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_amp__amp_">&amp;&amp;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&amp;&amp;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">p<span class="pc">p: <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp" href="#xor">xor<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>xor: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">choice</span> <span class="tp">bool</span></span></a>() <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>
</span>}
</span></pre>



<p class="p noindent">We can combine the handlers in two interesting ways:
</p><pre class="koka source"><span class="plaincode">fun state-choice() : div (list&lt;bool&gt;,int) {
  pstate(0){ choice-all(surprising) }
}

fun choice-state() : div list&lt;(bool,int)&gt; {
  choice-all{ pstate(0,surprising) }
}
</span><span class="nicecode"><span class="decl-fun" id="state_choice"><span class="kw">fun</span> <a class="pp" href="#state_choice">state-choice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>state<span class="dash">-</span>choice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp sp">(</span><span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">bool</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> {
  <a class="pp" href="#pstate">pstate<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pstate: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a>(<span class="number">0</span>){ <a class="pp" href="#choice_all">choice-all<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice<span class="dash">-</span>all: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">choice</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="#surprising">surprising<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>surprising: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">choice</span><span class="tp sp">,</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span> <span class="tp">bool</span></span></a>) }
</span>}

<span class="decl-fun" id="choice_state"><span class="kw">fun</span> <a class="pp" href="#choice_state">choice-state<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice<span class="dash">-</span>state: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span><span class="tp sp">&gt;</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <a class="pp" href="#choice_all">choice-all<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice<span class="dash">-</span>all: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">choice</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>{ <a class="pp" href="#pstate">pstate<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pstate: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a>(<span class="number">0</span>,<a class="pp" href="#surprising">surprising<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>surprising: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">choice</span><span class="tp sp">,</span><span class="tp">state</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span> <span class="tp">bool</span></span></a>) }
</span>}
</span></pre>



<p class="p noindent">In <code class="koka"><a class="pp" href="#state_choice">state<span class="dash">-</span>choice<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>state<span class="dash">-</span>choice: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">div</span> <span class="tp sp">(</span><span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">bool</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a>()</code> the <code class="koka"><a class="pp" href="#pstate">pstate<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pstate: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">state</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a></code> is the outer handler and becomes like a global
state over all resumption strands in <code class="koka"><a class="pp" href="#choice_all">choice<span class="dash">-</span>all<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice<span class="dash">-</span>all: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">choice</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code>, and thus after the first resume
the <code class="koka">i<span class="op">&#62;</span><span class="number">0</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_amp__amp_">(&#38;&#38;)<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&#38;&#38;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">bool</span></span></a> p</code> condition in <code class="koka"><a class="pp" href="#surprising">surprising<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>surprising: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">choice</span><span class="tp sp">,</span><span class="tp">state</span><span class="tp sp">&#60;</span><span class="tp">int</span><span class="tp sp">&#62;</span><span class="tp sp">&#62;</span> <span class="tp">bool</span></span></a></code> is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></code>, and we get <code class="koka">([<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>],<span class="number">2</span>)</code>.
</p>
<p class="p indent">In <code class="koka"><a class="pp" href="#choice_state">choice<span class="dash">-</span>state<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice<span class="dash">-</span>state: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">div</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span><span class="tp sp">&#62;</span></span></a>()</code> the <code class="koka"><a class="pp" href="#pstate">pstate<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>pstate: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">state</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a></code> is the inner handler and becomes like transactional state,
where the state becomes local to each resumption strand in <code class="koka"><a class="pp" href="#choice_all">choice<span class="dash">-</span>all<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>choice<span class="dash">-</span>all: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">choice</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code>.
Now <code class="koka">i</code> is always <code class="koka"><span class="number">0</span></code> at first and thus we get <code class="koka">[(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>,<span class="number">1</span>),(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>,<span class="number">1</span>)]</code>.
</p>
<div class="advanced" style="border-left:1px solid #AAA;padding:0em 0em 0em 1em;margin:1em 0em">
<p class="p noindent"><span class="boxed-label" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">advanced</span>This example also shows how <code class="koka"><span class="kw">var</span></code> state is correctly saved and restored on resumptions
(as part of the stack) and this is essential to the correct composition of effect handlers. 
If <code class="koka"><span class="kw">var</span></code> declarations were instead heap allocated or captured by reference, they would no 
longer be local to their scope and side effects could &#8220;leak&#8221; across different resumptions.</p></div><h3 id="sec-resource" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-resource" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4.11</span>.&#8194;</span>Initially and Finally</h3>
<p class="p noindent">With arbitrary effect handlers we need to be careful when interacting with external
resources like files. Generally, operations can never resume (like exceptions),
resume exactly once (giving the usual linear control flow), or resume more than once.
To robustly handle these different cases, Koka provides the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#finally">finally<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>finally: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">fin</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a></code> and <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#initially">initially<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>initially: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a></code>
functions. Suppose we have the following low-level file operations on file handles:
</p><pre class="koka source unchecked"><span class="plaincode">type fhandle
fun fopen( path : string )   : &lt;exn,filesys&gt; fhandle
fun hreadline( h : fhandle ) : &lt;exn,filesys&gt; string
fun hclose( h : fhandle )    : &lt;exn,filesys&gt; ()
</span><span class="nicecode"><span class="tp kw">type</span> <span class="tp">fhandle</span>
<span class="kw">fun</span> fopen( path <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> )   <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">,</span><span class="tp">filesys</span><span class="tp sp">&gt;</span> <span class="tp">fhandle</span>
<span class="kw">fun</span> hreadline( h <span class="tp kw op">:</span> <span class="tp">fhandle</span> ) <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">,</span><span class="tp">filesys</span><span class="tp sp">&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>
<span class="kw">fun</span> hclose( h <span class="tp kw op">:</span> <span class="tp">fhandle</span> )    <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">,</span><span class="tp">filesys</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span>
</span></pre>



<p class="p noindent">Using these primitives, we can declare a <code class="koka">fread</code> effect to read from a file:
</p><pre class="koka source unchecked"><span class="plaincode">effect fun fread() : string

fun with-file( path : string, action : () -&gt; &lt;fread,exn,filesys|e&gt; a ) : &lt;exn,filesys|e&gt; a {
  val h = fopen(path)
  with handler {
    return(x){ hclose(h); x }
    fun fread(){ hreadline(h) }
  }
  action()
} 
</span><span class="nicecode"><span class="tp kw">effect</span> <span class="kw">fun</span> fread() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>

<span class="kw">fun</span> with<span class="dash">-</span>file( path <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, action <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">fread</span><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">,</span><span class="tp">filesys</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> ) <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">,</span><span class="tp">filesys</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> {
  <span class="kw">val</span> h <span class="kw">=</span> fopen(path)
  <span class="kw">with</span> <span class="kw">handler</span> {
    <span class="kw">return</span>(x){ hclose(h); x }
    <span class="kw">fun</span> fread(){ hreadline(h) }
  }
  action()
} 
</span></pre>



<p class="p noindent">However, as it stands it would fail to close the file handle if an exceptional
effect inside <code class="koka">action</code> is used (i.e. or any operation that never resumes). 
The <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#finally">finally<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>finally: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">fin</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a></code> function handles these situations, and
takes as its first argument a function that is always executed when either returning normally, or
when unwinding for a non-resuming operation. So, a more robust way to write
<code class="koka">with<span class="dash">-</span>file</code> is:
</p><pre class="koka source unchecked"><span class="plaincode">fun with-file( path : string, action : () -&gt; &lt;fread,exn,filesys|e&gt; a ) : &lt;exn,filesys|e&gt; a {
  val h = fopen(path)
  with finally{ hclose(h) }
  with fun fread(){ hreadline(h) }
  action()
} 
</span><span class="nicecode"><span class="kw">fun</span> with<span class="dash">-</span>file( path <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, action <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">fread</span><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">,</span><span class="tp">filesys</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> ) <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">,</span><span class="tp">filesys</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> {
  <span class="kw">val</span> h <span class="kw">=</span> fopen(path)
  <span class="kw">with</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#finally">finally<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>finally: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fin</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>{ hclose(h) }
  <span class="kw">with</span> <span class="kw">fun</span> fread(){ hreadline(h) }
  action()
} 
</span></pre>



<p class="p noindent">The current definition is robust for operations that never resume, or operations that resume once 
&#8211; but there is still trouble when resuming more than once. If someone calls <code class="koka">choice</code> inside 
the <code class="koka">action</code>, the second time it 
resumes the file handle will be closed again which is probably not intended. There is 
active research into using the type system to statically prevent this from happening.
</p>
<p class="p indent">Another way to work with multiple resumptions is to use the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#initially">initially<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>initially: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a></code> function.
This function takes 2 arguments: the first argument is a function that is called 
the first time <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#initially">initially<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>initially: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a></code> is evaluated, and subsequently every time a particular resumption is
resumed more than once. We can use this to implement various strategies to handle
linear resources even for multiple resumptions. For files, it is not clear what is the
best way to handle this, but one way would be to not close the file until all strands
have finished:
</p><pre class="koka source unchecked"><span class="plaincode">fun with-file( path : string, action : () -&gt; &lt;fread,exn,filesys|e&gt; a ) : &lt;exn,filesys|e&gt; a {
  var count := 0
  val h = fopen(path)
  with initially( fn(rcount){ count := count+1 } )
  with finally{ if (count==1) then hclose(h) else count := count - 1 }
  with fun fread(){ hreadline(h) }
  action()
} 
</span><span class="nicecode"><span class="kw">fun</span> with<span class="dash">-</span>file( path <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, action <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">fread</span><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">,</span><span class="tp">filesys</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> ) <span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">,</span><span class="tp">filesys</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> {
  <span class="kw">var</span> count <span class="kw op">:=</span> <span class="number">0</span>
  <span class="kw">val</span> h <span class="kw">=</span> fopen(path)
  <span class="kw">with</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#initially">initially<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>initially: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>( <span class="kw">fn</span>(rcount){ count <span class="kw op">:=</span> count<span class="op">+</span><span class="number">1</span> } )
  <span class="kw">with</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#finally">finally<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>finally: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fin</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>{ <span class="kw">if</span> (count<span class="op">==</span><span class="number">1</span>) <span class="kw">then</span> hclose(h) <span class="kw">else</span> count <span class="kw op">:=</span> count <span class="op"><span class="minus">-</span></span> <span class="number">1</span> }
  <span class="kw">with</span> <span class="kw">fun</span> fread(){ hreadline(h) }
  action()
} 
</span></pre>



<div class="advanced" style="border-left:1px solid #AAA;padding:0em 0em 0em 1em;margin:1em 0em">
<p class="p noindent"><span class="boxed-label" style="margin:0em 0em 0em -1em;display:block;font-size:70%;color:#999">advanced</span>The <code class="koka">rcount</code> parameter is the resume count; it is <code class="koka"><span class="number">0</span></code> on the first evaluation of <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#initially">initially<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>initially: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a></code>, and
<code class="koka"><span class="op">&#62;</span><span class="number">1</span></code> for every resume (for any operation) after the first one.</p></div><h4 id="sec-rcontrol" class="h4" data-heading-depth="4" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">Raw Control</h4>
<div class="todo note" style="display:block;font-style:italic">
<p class="p noindent"><span class="note-before"><strong class="strong-star2"><span class="note-caption">Todo</span></strong>.
</span>Use <code class="koka"><span class="kw">rcontrol</span></code> for raw control operations which do not automatically
finalize; this gives true first-class resumption contexts (as <code class="koka">rcontext</code>) but need
to be used with care. With <code class="koka"><span class="kw">rcontrol</span></code> one can use the implicitly bound
resumption context <code class="koka">rcontext</code> to either resume (as <code class="koka">rcontext<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#resume">resume<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>resume: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">resume<span class="dash">-</span>context</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">b</span></span></a>(x)</code>),
or to finalize a resumption (as <code class="koka">rcontext<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#finalize">finalize<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>finalize: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">resume<span class="dash">-</span>context</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">e1</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">b</span></span></a></code>) which runs all
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#finally">finally<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>finally: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">fin</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a></code> handlers to clean up resources.</p></div><h3 id="sec-linear" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-linear" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4.12</span>.&#8194;</span>Linear Effects</h3>
<div class="todo note" style="display:block;font-style:italic">
<p class="p noindent"><span class="note-before"><strong class="strong-star2"><span class="note-caption">Todo</span></strong>.
</span>Use <code class="koka">linear <span class="tp kw">effect</span></code> to declare effects whose operations are always tail-resumptive
and use only linear effects themselves
(and thus resume exactly once). This removes monadic translation for such effects and
can make code that uses only linear effects more compact and efficient.</p></div><h3 id="sec-namedh" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-namedh" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.4.13</span>.&#8194;</span>Named and Scoped Handlers</h3>
<div class="todo note" style="display:block;font-style:italic">
<p class="p noindent"><span class="note-before"><strong class="strong-star2"><span class="note-caption">Todo</span></strong>.
</span>See <code class="koka"><a class="doc link" href="https://koka-lang.github.io/koka/doc/samples.html#named_handlers">samples<span class="fslash">/</span>named<span class="dash">-</span>handlers</a></code>.</p></div><h2 id="sec-fbip" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-fbip" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.5</span>.&#8194;</span>FBIP: Functional but In-Place</h2>
<p class="p noindent">With&nbsp;<a href="#why-fbip" title="2.5.&#8194;Reuse Analysis" class="localref" style="target-element:h2">Perceus</a> reuse analysis we can
write algorithms that dynamically adapt to use in-place mutation when
possible (and use copying when used persistently). Importantly,
you can rely on this optimization happening, e.g. see
the <code class="koka"><span class="kw">match</span></code> patterns and pair them to same-sized constructors in each branch.
</p>
<p class="p indent">This style of programming leads to a new paradigm that we call FBIP:
&#8220;functional but in place&#8221;. Just like tail-call optimization lets us
describe loops in terms of regular function calls, reuse analysis lets us
describe in-place mutating imperative algorithms in a purely functional
way (and get persistence as well).
</p>
<div class="note" style="display:block;font-style:italic">
<p class="p noindent"><span class="note-before"><strong class="strong-star2"><span class="note-caption">Note</span></strong>.
</span>FBIP is still active research. In particular we&#39;d like to add ways to add 
annotations to ensure reuse is taking place.</p></div><h3 id="sec-tree-rebalancing" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-tree-rebalancing" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.5.1</span>.&#8194;</span>Tree Rebalancing</h3>
<p class="p noindent">As an example, we consider
insertion into a red-black tree&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#guibas1978dichromatic" title="A dichromatic framework for balanced trees
Guibas and Sedgewick, 1978" class="bibref localref" style="target-element:bibitem"><span class="cite-number">2</span></a>]</span>. 
A polymorphic version of this example is part of the&nbsp;<a href="https://github.com/koka-lang/koka/tree/master/samples" data-linkid="samples"><code class="code code2">samples</code></a> directory when you have
installed Koka and can be loaded as <code class="code code2">:l</code>&nbsp;<a href="https://github.com/koka-lang/koka/tree/master/samples/basic/rbtree.kk" data-linkid="rbtree"><code class="code code2">samples/basic/rbtree</code></a>.
We define red-black trees as:
</p><pre class="koka source unchecked"><span class="plaincode">type color {
  Red
  Black
}

type tree {
  Leaf
  Node(color: color, left: tree, key: int, value: bool, right: tree)
}
</span><span class="nicecode"><span class="tp kw">type</span> <span class="tp">color</span> {
  <span class="co">Red</span>
  <span class="co">Black</span>
}

<span class="tp kw">type</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a> {
  <span class="co">Leaf</span>
  <span class="co">Node</span>(color<span class="tp kw op">:</span> <span class="tp">color</span>, left<span class="tp kw op">:</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a>, key<span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, value<span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a>, right<span class="tp kw op">:</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a>)
}
</span></pre>


<p class="p noindent">The red-black tree has the invariant that the number of black nodes from
the root to any of the leaves is the same, and that a red node is never a
parent of red node. Together this ensures that the trees are always
balanced. When inserting nodes, the invariants need to be maintained by
rebalancing the nodes when needed. Okasaki&#39;s algorithm&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#okasaki:rbtree" title="Red-black trees in a functional setting
Okasaki, 1999a" class="bibref localref" style="target-element:bibitem"><span class="cite-number">12</span></a>]</span>
implements this elegantly and functionally:
</p><pre class="koka source unchecked"><span class="plaincode">fun balance-left( l : tree, k : int, v : bool, r : tree ): tree {
  match(l) {
    Node(&#95;, Node(Red, lx, kx, vx, rx), ky, vy, ry)
      -&gt; Node(Red, Node(Black, lx, kx, vx, rx), ky, vy, Node(Black, ry, k, v, r))
    ...
}

fun ins( t : tree, k : int, v : bool ): tree {
  match(t) {
    Leaf -&gt; Node(Red, Leaf, k, v, Leaf)
    Node(Red, l, kx, vx, r)             
      -&gt; if (k &lt; kx) then Node(Red, ins(l, k, v), kx, vx, r)
         ...
    Node(Black, l, kx, vx, r)
      -&gt; if (k &lt; kx &amp;&amp; is-red(l)) then balance-left(ins(l,k,v), kx, vx, r)
         ...
}
</span><span class="nicecode"><span class="kw">fun</span> balance<span class="dash">-</span>left( l <span class="tp kw op">:</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a>, k <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, v <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a>, r <span class="tp kw op">:</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a> )<span class="tp kw op">:</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a> {
  <span class="kw">match</span>(l) {
    <span class="co">Node</span>(&#95;, <span class="co">Node</span>(<span class="co">Red</span>, lx, kx, vx, rx), ky, vy, ry)
      <span class="kw op">-></span> <span class="co">Node</span>(<span class="co">Red</span>, <span class="co">Node</span>(<span class="co">Black</span>, lx, kx, vx, rx), ky, vy, <span class="co">Node</span>(<span class="co">Black</span>, ry, k, v, r))
    <span class="op">...</span>
}

<span class="kw">fun</span> ins( t <span class="tp kw op">:</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a>, k <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, v <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> )<span class="tp kw op">:</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a> {
  <span class="kw">match</span>(t) {
    <span class="co">Leaf</span> <span class="kw op">-></span> <span class="co">Node</span>(<span class="co">Red</span>, <span class="co">Leaf</span>, k, v, <span class="co">Leaf</span>)
    <span class="co">Node</span>(<span class="co">Red</span>, l, kx, vx, r)             
      <span class="kw op">-></span> <span class="kw">if</span> (k <span class="op">&lt;</span> kx) <span class="kw">then</span> <span class="co">Node</span>(<span class="co">Red</span>, ins(l, k, v), kx, vx, r)
         <span class="op">...</span>
    <span class="co">Node</span>(<span class="co">Black</span>, l, kx, vx, r)
      <span class="kw op">-></span> <span class="kw">if</span> (k <span class="op">&lt;</span> kx <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_amp__amp_">(&amp;&amp;)<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&amp;&amp;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> is<span class="dash">-</span>red(l)) <span class="kw">then</span> balance<span class="dash">-</span>left(ins(l,k,v), kx, vx, r)
         <span class="op">...</span>
}
</span></pre>



<p class="p noindent">The Koka compiler will inline the <code class="koka">balance<span class="dash">-</span>left</code> function. At that point,
every matched <code class="koka"><span class="co">Node</span></code> constructor in the <code class="koka">ins</code> function has a corresponding <code class="koka"><span class="co">Node</span></code> allocation &#8211;
if we consider all branches we can see that we either match one <code class="koka"><span class="co">Node</span></code>
and allocate one, or we match three nodes deep and allocate three. Every 
<code class="koka"><span class="co">Node</span></code> is actually reused in the fast path without doing any allocations!
When studying the generated code, we can see the Perceus assigns the 
fields in the nodes in the fast path <em class="em-low1">in-place</em> much like the 
usual non-persistent rebalancing algorithm in C would do.
</p>
<p class="p indent">Essentially this means that for a unique tree, the purely functional
algorithm above adapts at runtime to an in-place mutating re-balancing
algorithm (without any further allocation). Moreover, if we use the tree
<em class="em-low1">persistently</em>&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#okasaki:purefun" title="Purely Functional Data Structures
Okasaki, 1999b" class="bibref localref" style="target-element:bibitem"><span class="cite-number">13</span></a>]</span>, and the tree is shared or has
shared parts, the algorithm adapts to copying exactly the shared <em class="em-low1">spine</em>
of the tree (and no more), while still rebalancing in place for any
unshared parts.
</p><h3 id="sec-morris-traversal" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-morris-traversal" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">3.5.2</span>.&#8194;</span>Morris Traversal</h3>
<p class="p noindent">As another example of FBIP, consider mapping a function <code class="koka">f</code> over
all elements in a binary tree in-order as shown in the <code class="koka"><a class="pp" href="#tmap_inorder">tmap<span class="dash">-</span>inorder<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tmap<span class="dash">-</span>inorder: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">tree</span></span></a></code> example:
</p><pre class="koka source"><span class="plaincode">type tree {
  Tip
  Bin( left: tree, value : int, right: tree )
}

fun tmap-inorder( t : tree, f : int -&gt; int ) : tree {
  match(t) {
    Bin(l,x,r) -&gt; Bin( l.tmap-inorder(f), f(x), r.tmap-inorder(f) )
    Tip        -&gt; Tip 
  }
}
</span><span class="nicecode"><span class="decl-type" id="type_space_tree"><span class="tp kw">type</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a> {
  <span class="decl-con" id="con_space_Tip"><a class="pp">Tip<span class="pc">tree: <span class="tp">tree</span></span></a></span>
  <span class="decl-con" id="con_space_Bin"><a class="pp">Bin<span class="pc">tree: <span class="tp">tree</span></span></a>( <a class="pp">left<span class="pc">left: <span class="tp">tree</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a>, <a class="pp">value<span class="pc">value: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">right<span class="pc">right: <span class="tp">tree</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a> </span>)
</span>}

<span class="decl-fun" id="tmap_inorder"><span class="kw">fun</span> <a class="pp" href="#tmap_inorder">tmap-inorder<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tmap<span class="dash">-</span>inorder: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">tree</span></span></a>( <a class="pp">t<span class="pc">t: <span class="tp">tree</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a>, <a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a> {
  <span class="kw">match</span>(<a class="pp">t<span class="pc">t: <span class="tp">tree</span></span></a>) {
    <a class="pp" href="#con_space_Bin"><span class="co">Bin</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Bin: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">tree</span></span></a>(<a class="pp">l<span class="pc">l: <span class="tp">tree</span></span></a>,<a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>,<a class="pp">r<span class="pc">r: <span class="tp">tree</span></span></a>) <span class="kw op">-></span> <a class="pp" href="#con_space_Bin"><span class="co">Bin</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Bin: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">tree</span></span></a>( <a class="pp">l<span class="pc">l: <span class="tp">tree</span></span></a><span class="kw op">.</span><a class="pp" href="#tmap_inorder">tmap-inorder<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tmap<span class="dash">-</span>inorder: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">tree</span></span></a>(<a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>), <a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>), <a class="pp">r<span class="pc">r: <span class="tp">tree</span></span></a><span class="kw op">.</span><a class="pp" href="#tmap_inorder">tmap-inorder<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tmap<span class="dash">-</span>inorder: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">tree</span></span></a>(<a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>) )
    <a class="pp" href="#con_space_Tip"><span class="co">Tip</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Tip: <span class="tp">tree</span></span></a>        <span class="kw op">-></span> <a class="pp" href="#con_space_Tip"><span class="co">Tip</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Tip: <span class="tp">tree</span></span></a> 
  }
</span>}
</span></pre>



<p class="p noindent">This is already quite efficient as all the <code class="koka"><a class="pp" href="#con_space_Bin"><span class="co">Bin</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Bin: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">tree</span></span></a></code> and <code class="koka"><a class="pp" href="#con_space_Tip"><span class="co">Tip</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Tip: <span class="tp">tree</span></span></a></code> nodes are
reused in-place when <code class="koka">t</code> is unique. However, the <code class="koka"><a class="pp" href="#tmap">tmap<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tmap: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">direction</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">div</span> <span class="tp">tree</span></span></a></code> function is not
tail-recursive and thus uses as much stack space as the depth of the
tree.
</p>
<pre class="para-block aside pre-fenced pre-fenced4 language-cpp lang-cpp cpp colorized" style="display:block"><code><span style="color:teal">void</span> inorder( tree* root, <span style="color:teal">void</span> (*f)(tree* t) ) {
  tree* cursor = root;
  <span style="color:blue">while</span> (cursor != <span style="color:teal">NULL</span> <span style="color:darkgreen">/*</span><span style="color:darkgreen"> Tip </span><span style="color:darkgreen">*/</span>) {
    <span style="color:blue">if</span> (cursor-&gt;left == <span style="color:teal">NULL</span>) {
      <span style="color:darkgreen">// no left tree, go down the right</span>
      f(cursor-&gt;value);
      cursor = cursor-&gt;right;
    } <span style="color:blue">else</span> {
      <span style="color:darkgreen">// has a left tree</span>
      tree* pre = cursor-&gt;left;  <span style="color:darkgreen">// find the predecessor</span>
      <span style="color:blue">while</span>(pre-&gt;right != <span style="color:teal">NULL</span> &amp;&amp; pre-&gt;right != cursor) {
        pre = pre-&gt;right;
      }
      <span style="color:blue">if</span> (pre-&gt;right == <span style="color:teal">NULL</span>) {
        <span style="color:darkgreen">// first visit, remember to visit right tree</span>
        pre-&gt;right = cursor;
        cursor = cursor-&gt;left;
      } <span style="color:blue">else</span> {
        <span style="color:darkgreen">// already set, restore</span>
        f(cursor-&gt;value);
        pre-&gt;right = <span style="color:teal">NULL</span>;
        cursor = cursor-&gt;right;
      } 
    } 
  } 
}</code></pre>
<p class="p noindent para-continued">In 1968, Knuth posed the problem of visiting a tree in-order while using
no extra stack- or heap space&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#knuth:aocp1" title="The Art of Computer Programming, Volume 1 (3rd Ed.): Fundamental Algorithms
Knuth, 1997" class="bibref localref" style="target-element:bibitem"><span class="cite-number">6</span></a>]</span> (For readers not familiar
with the problem it might be fun to try this in your favorite imperative
language first and see that it is not easy to do). Since then, numerous
solutions have appeared in the literature. A particularly elegant
solution was proposed by&nbsp;<span class="textual citations" style="target-element:bibitem"><span class="cite-authors">Morris</span>&#160;[<a href="#morris:tree" title="Traversing binary trees simply and cheaply
Morris, 1979" class="bibref localref" style="target-element:bibitem"><span class="cite-number">11</span></a>]</span>. This is an in-place mutating
algorithm that swaps pointers in the tree to &#8220;remember&#8221; which parts are
unvisited. It is beyond this tutorial to give a full explanation, but a C
implementation is shown here on the side. The traversal
essentially uses a <em class="em-low1">right-threaded</em> tree to keep track of which nodes to
visit. The algorithm is subtle, though. Since it transforms the tree into
an intermediate graph, we need to state invariants over the so-called
<em class="em-low1">Morris loops</em>&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#mateti:morris" title="Morris&#39; tree traversal algorithm reconsidered
Mateti and Manghirmalani, 1988" class="bibref localref" style="target-element:bibitem"><span class="cite-number">9</span></a>]</span> to prove its correctness.
</p>
<p class="p indent">We can derive a functional and more intuitive solution using the FBIP
technique. We start by defining an explicit <em class="em-low1">visitor</em> data structure
that keeps track of which parts of the tree we still need to visit. In
Koka we define this data type as <code class="koka"><a class="pp" href="#type_space_visitor"><span class="tp">visitor</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>visitor: <span class="tp">V</span></span></a></code>:
</p><pre class="koka source"><span class="plaincode">type visitor {
  Done
  BinR( right:tree, value : int, visit : visitor )
  BinL( left:tree, value : int, visit : visitor )
}
</span><span class="nicecode"><span class="decl-type" id="type_space_visitor"><span class="tp kw">type</span> <a class="pp" href="#type_space_visitor"><span class="tp">visitor</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>visitor: <span class="tp">V</span></span></a> {
  <span class="decl-con" id="con_space_Done"><a class="pp">Done<span class="pc">visitor: <span class="tp">visitor</span></span></a></span>
  <span class="decl-con" id="con_space_BinR"><a class="pp">BinR<span class="pc">visitor: <span class="tp">visitor</span></span></a>( <a class="pp">right<span class="pc">right: <span class="tp">tree</span></span></a><span class="tp kw op">:</span><a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a>, <a class="pp">value<span class="pc">value: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">visit<span class="pc">visit: <span class="tp">visitor</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_visitor"><span class="tp">visitor</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>visitor: <span class="tp">V</span></span></a> </span>)
  <span class="decl-con" id="con_space_BinL"><a class="pp">BinL<span class="pc">visitor: <span class="tp">visitor</span></span></a>( <a class="pp">left<span class="pc">left: <span class="tp">tree</span></span></a><span class="tp kw op">:</span><a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a>, <a class="pp">value<span class="pc">value: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">visit<span class="pc">visit: <span class="tp">visitor</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_visitor"><span class="tp">visitor</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>visitor: <span class="tp">V</span></span></a> </span>)
</span>}
</span></pre>



<p class="p noindent">(As an aside, 
Conor McBride&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#mcbride:derivative" title="The Derivative of a Regular Type is its Type of One-Hole Contexts
McBride, 2001" class="bibref localref" style="target-element:bibitem"><span class="cite-number">10</span></a>]</span> describes how we can
generically derive a <em class="em-low1">zipper</em>&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#huet:zipper" title="The Zipper
Huet, 1997" class="bibref localref" style="target-element:bibitem"><span class="cite-number">5</span></a>]</span> visitor for any
recursive type <svg  class="math-inline math-render-svg math" style="vertical-align:-0.2337em;height:0.9600em;width:2.6295em" viewBox='88.468 54.829 25.043 9.143'><desc>$\mathpre{\mu \mathid{x}.~\mathid{F}}$</desc><g id='math-7b2e55'><use x='88.667' y='61.836' xlink:href='#g7-22'/><use x='94.67' y='61.836' xlink:href='#g2-120'/><use x='100.492' y='61.836' xlink:href='#g7-58'/><use x='105.473' y='61.836' xlink:href='#g2-70'/></g></svg> as a list of the derivative of that type,
namely <svg  class="math-inline math-render-svg math" style="vertical-align:-0.3935em;height:1.3230em;width:8.5050em" viewBox='34.67 52.871 81 12.6'><desc>$\mathpre{\mathkw{list}~(\pdv{\mathid{x}}~\mathid{F}\mid_{\mathid{x}~=\mu \mathid{x}.\mathid{F}})}$</desc><g id='math-f5b205'><use x='34.869' y='61.836' xlink:href='#g0-108'/><use x='37.249' y='61.836' xlink:href='#g0-105'/><use x='39.629' y='61.836' xlink:href='#g0-115'/><use x='43.448' y='61.836' xlink:href='#g0-116'/><use x='49.26' y='61.836' xlink:href='#g9-40'/><use x='56.655' y='57.913' xlink:href='#g8-64'/><rect x='54.33' y='59.146' height='.398' width='9.333'/><use x='54.33' y='65.271' xlink:href='#g8-64'/><use x='59.013' y='65.271' xlink:href='#g1-120'/><use x='67.072' y='61.836' xlink:href='#g2-70'/><use x='77.669' y='61.836' xlink:href='#g5-106'/><use x='80.436' y='63.33' xlink:href='#g1-120'/><use x='86.9' y='63.33' xlink:href='#g10-61'/><use x='93.016' y='63.33' xlink:href='#g8-22'/><use x='97.86' y='63.33' xlink:href='#g1-120'/><use x='102.51' y='63.33' xlink:href='#g8-58'/><use x='104.876' y='63.33' xlink:href='#g1-70'/><use x='111.586' y='61.836' xlink:href='#g9-41'/></g></svg>.
In our case, the algebraic representation of the inductive <code class="koka"><a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a></code>
type is <svg  class="math-inline math-render-svg math" style="vertical-align:-0.2325em;height:1.0967em;width:19.3957em" viewBox='88.468 53.527 184.721 10.445'><desc>$\mathpre{\mu \mathid{x}.~1~+~\mathid{x}\times \mathid{int}\times \mathid{x}~~\,\cong\,~\mu \mathid{x}.~1~+~\mathid{x}^2\times \mathid{int}}$</desc><g id='math-3d61fb'><use x='88.667' y='61.836' xlink:href='#g7-22'/><use x='94.67' y='61.836' xlink:href='#g2-120'/><use x='100.492' y='61.836' xlink:href='#g7-58'/><use x='105.473' y='61.836' xlink:href='#g9-49'/><use x='114.882' y='61.836' xlink:href='#g9-43'/><use x='127.059' y='61.836' xlink:href='#g2-120'/><use x='135.094' y='61.836' xlink:href='#g5-2'/><use x='145.056' y='61.836' xlink:href='#g2-105'/><use x='148.111' y='61.836' xlink:href='#g2-110'/><use x='153.713' y='61.836' xlink:href='#g2-116'/><use x='160.181' y='61.836' xlink:href='#g5-2'/><use x='170.144' y='61.836' xlink:href='#g2-120'/><use x='184.821' y='59.177' xlink:href='#g5-24'/><use x='184.821' y='62.334' xlink:href='#g9-61'/><use x='199.211' y='61.836' xlink:href='#g7-22'/><use x='205.214' y='61.836' xlink:href='#g2-120'/><use x='211.035' y='61.836' xlink:href='#g7-58'/><use x='216.016' y='61.836' xlink:href='#g9-49'/><use x='225.425' y='61.836' xlink:href='#g9-43'/><use x='237.602' y='61.836' xlink:href='#g2-120'/><use x='243.423' y='58.22' xlink:href='#g10-50'/><use x='250.106' y='61.836' xlink:href='#g5-2'/><use x='260.069' y='61.836' xlink:href='#g2-105'/><use x='263.124' y='61.836' xlink:href='#g2-110'/><use x='268.725' y='61.836' xlink:href='#g2-116'/></g></svg>.
Calculating the derivative <svg  class="math-inline math-render-svg math" style="vertical-align:-0.3935em;height:1.3230em;width:14.4254em" viewBox='34.67 52.871 137.385 12.6'><desc>$\mathpre{\mathkw{list}~(\pdv{\mathid{x}}~(1~+~\mathid{x}^2\times \mathid{int})~\mid_{\mathid{x}~=~\mathid{tree}})}$</desc><g id='math-90111f'><use x='34.869' y='61.836' xlink:href='#g0-108'/><use x='37.249' y='61.836' xlink:href='#g0-105'/><use x='39.629' y='61.836' xlink:href='#g0-115'/><use x='43.448' y='61.836' xlink:href='#g0-116'/><use x='49.26' y='61.836' xlink:href='#g9-40'/><use x='56.655' y='57.913' xlink:href='#g8-64'/><rect x='54.33' y='59.146' height='.398' width='9.333'/><use x='54.33' y='65.271' xlink:href='#g8-64'/><use x='59.013' y='65.271' xlink:href='#g1-120'/><use x='67.072' y='61.836' xlink:href='#g9-40'/><use x='70.947' y='61.836' xlink:href='#g9-49'/><use x='80.356' y='61.836' xlink:href='#g9-43'/><use x='92.532' y='61.836' xlink:href='#g2-120'/><use x='98.354' y='58.22' xlink:href='#g10-50'/><use x='105.037' y='61.836' xlink:href='#g5-2'/><use x='114.999' y='61.836' xlink:href='#g2-105'/><use x='118.055' y='61.836' xlink:href='#g2-110'/><use x='123.656' y='61.836' xlink:href='#g2-116'/><use x='127.911' y='61.836' xlink:href='#g9-41'/><use x='136.766' y='61.836' xlink:href='#g5-106'/><use x='139.534' y='63.33' xlink:href='#g1-120'/><use x='145.998' y='63.33' xlink:href='#g10-61'/><use x='153.928' y='63.33' xlink:href='#g1-116'/><use x='156.701' y='63.33' xlink:href='#g1-114'/><use x='159.781' y='63.33' xlink:href='#g1-101'/><use x='163.168' y='63.33' xlink:href='#g1-101'/><use x='167.972' y='61.836' xlink:href='#g9-41'/></g></svg>
and by further simplification, 
we get <svg  class="math-inline math-render-svg math" style="vertical-align:-0.2930em;height:1.0879em;width:19.9379em" viewBox='88.468 54.164 189.885 10.361'><desc>$\mathpre{\mu \mathid{x}.~1~+~(\mathid{tree}\times \mathid{int}\times \mathid{x})~+~(\mathid{tree}\times \mathid{int}\times \mathid{x})}$</desc><g id='math-3b38c5'><use x='88.667' y='61.836' xlink:href='#g7-22'/><use x='94.67' y='61.836' xlink:href='#g2-120'/><use x='100.492' y='61.836' xlink:href='#g7-58'/><use x='105.473' y='61.836' xlink:href='#g9-49'/><use x='114.882' y='61.836' xlink:href='#g9-43'/><use x='127.059' y='61.836' xlink:href='#g9-40'/><use x='130.933' y='61.836' xlink:href='#g2-116'/><use x='134.243' y='61.836' xlink:href='#g2-114'/><use x='137.934' y='61.836' xlink:href='#g2-101'/><use x='142.008' y='61.836' xlink:href='#g2-101'/><use x='149.553' y='61.836' xlink:href='#g5-2'/><use x='159.516' y='61.836' xlink:href='#g2-105'/><use x='162.571' y='61.836' xlink:href='#g2-110'/><use x='168.172' y='61.836' xlink:href='#g2-116'/><use x='174.641' y='61.836' xlink:href='#g5-2'/><use x='184.603' y='61.836' xlink:href='#g2-120'/><use x='190.425' y='61.836' xlink:href='#g9-41'/><use x='198.727' y='61.836' xlink:href='#g9-43'/><use x='210.903' y='61.836' xlink:href='#g9-40'/><use x='214.778' y='61.836' xlink:href='#g2-116'/><use x='218.087' y='61.836' xlink:href='#g2-114'/><use x='221.779' y='61.836' xlink:href='#g2-101'/><use x='225.853' y='61.836' xlink:href='#g2-101'/><use x='233.398' y='61.836' xlink:href='#g5-2'/><use x='243.36' y='61.836' xlink:href='#g2-105'/><use x='246.416' y='61.836' xlink:href='#g2-110'/><use x='252.017' y='61.836' xlink:href='#g2-116'/><use x='258.486' y='61.836' xlink:href='#g5-2'/><use x='268.448' y='61.836' xlink:href='#g2-120'/><use x='274.269' y='61.836' xlink:href='#g9-41'/></g></svg>,
which corresponds exactly to our <code class="koka"><a class="pp" href="#type_space_visitor"><span class="tp">visitor</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>visitor: <span class="tp">V</span></span></a></code> datatype.)
</p>
<p class="p indent">We also keep track of which <code class="koka"><a class="pp" href="#type_space_direction"><span class="tp">direction</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>direction: <span class="tp">V</span></span></a></code> in the tree 
we are going, either <code class="koka"><a class="pp" href="#con_space_Up"><span class="co">Up</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Up: <span class="tp">direction</span></span></a></code> or <code class="koka"><a class="pp" href="#con_space_Down"><span class="co">Down</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Down: <span class="tp">direction</span></span></a></code> the tree.
</p><pre class="koka source"><span class="plaincode">type direction { 
  Up 
  Down 
}
</span><span class="nicecode"><span class="decl-type" id="type_space_direction"><span class="tp kw">type</span> <a class="pp" href="#type_space_direction"><span class="tp">direction</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>direction: <span class="tp">V</span></span></a> { 
  <span class="decl-con" id="con_space_Up"><a class="pp">Up<span class="pc">direction: <span class="tp">direction</span></span></a></span> 
  <span class="decl-con" id="con_space_Down"><a class="pp">Down<span class="pc">direction: <span class="tp">direction</span></span></a></span> 
</span>}
</span></pre>



<p class="p noindent">We start our traversal by going downward into the tree with an empty
visitor, expressed as <code class="koka"><a class="pp" href="#tmap">tmap<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tmap: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">direction</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">div</span> <span class="tp">tree</span></span></a>(f, t, <a class="pp" href="#con_space_Done"><span class="co">Done</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Done: <span class="tp">visitor</span></span></a>, <a class="pp" href="#con_space_Down"><span class="co">Down</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Down: <span class="tp">direction</span></span></a>)</code>:
</p><pre class="koka source"><span class="plaincode">fun tmap( f : int -&gt; int, t : tree, visit : visitor, d : direction ) {
  match(d) {
    Down -&gt; match(t) {    // going down a left spine
      Bin(l,x,r) -&gt; tmap(f,l,BinR(r,x,visit),Down) // A
      Tip        -&gt; tmap(f,Tip,visit,Up)           // B
    }
    Up -&gt; match(visit) {  // go up through the visitor
      Done        -&gt; t                             // C
      BinR(r,x,v) -&gt; tmap(f,r,BinL(t,f(x),v),Down) // D
      BinL(l,x,v) -&gt; tmap(f,Bin(l,x,t),v,Up)       // E
    } 
  } 
}
</span><span class="nicecode"><span class="decl-fun" id="tmap"><span class="kw">fun</span> <a class="pp" href="#tmap">tmap<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tmap: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">direction</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">tree</span></span></a>( <a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">t<span class="pc">t: <span class="tp">tree</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_tree"><span class="tp">tree</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tree: <span class="tp">V</span></span></a>, <a class="pp">visit<span class="pc">visit: <span class="tp">visitor</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_visitor"><span class="tp">visitor</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>visitor: <span class="tp">V</span></span></a>, <a class="pp">d<span class="pc">d: <span class="tp">direction</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_direction"><span class="tp">direction</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>direction: <span class="tp">V</span></span></a> ) {
  <span class="kw">match</span>(<a class="pp">d<span class="pc">d: <span class="tp">direction</span></span></a>) {
    <a class="pp" href="#con_space_Down"><span class="co">Down</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Down: <span class="tp">direction</span></span></a> <span class="kw op">-></span> <span class="kw">match</span>(<a class="pp">t<span class="pc">t: <span class="tp">tree</span></span></a>) {    <span class="comment">// going down a left spine
</span>      <a class="pp" href="#con_space_Bin"><span class="co">Bin</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Bin: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">tree</span></span></a>(<a class="pp">l<span class="pc">l: <span class="tp">tree</span></span></a>,<a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>,<a class="pp">r<span class="pc">r: <span class="tp">tree</span></span></a>) <span class="kw op">-></span> <a class="pp" href="#tmap">tmap<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tmap: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">direction</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">tree</span></span></a>(<a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<a class="pp">l<span class="pc">l: <span class="tp">tree</span></span></a>,<a class="pp" href="#con_space_BinR"><span class="co">BinR</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>BinR: <span class="tp sp">(</span><span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">visitor</span></span></a>(<a class="pp">r<span class="pc">r: <span class="tp">tree</span></span></a>,<a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>,<a class="pp">visit<span class="pc">visit: <span class="tp">visitor</span></span></a>),<a class="pp" href="#con_space_Down"><span class="co">Down</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Down: <span class="tp">direction</span></span></a>) <span class="comment">// A
</span>      <a class="pp" href="#con_space_Tip"><span class="co">Tip</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Tip: <span class="tp">tree</span></span></a>        <span class="kw op">-></span> <a class="pp" href="#tmap">tmap<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tmap: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">direction</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">tree</span></span></a>(<a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<a class="pp" href="#con_space_Tip"><span class="co">Tip</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Tip: <span class="tp">tree</span></span></a>,<a class="pp">visit<span class="pc">visit: <span class="tp">visitor</span></span></a>,<a class="pp" href="#con_space_Up"><span class="co">Up</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Up: <span class="tp">direction</span></span></a>)           <span class="comment">// B
</span>    }
    <a class="pp" href="#con_space_Up"><span class="co">Up</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Up: <span class="tp">direction</span></span></a> <span class="kw op">-></span> <span class="kw">match</span>(<a class="pp">visit<span class="pc">visit: <span class="tp">visitor</span></span></a>) {  <span class="comment">// go up through the visitor
</span>      <a class="pp" href="#con_space_Done"><span class="co">Done</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Done: <span class="tp">visitor</span></span></a>        <span class="kw op">-></span> <a class="pp">t<span class="pc">t: <span class="tp">tree</span></span></a>                             <span class="comment">// C
</span>      <a class="pp" href="#con_space_BinR"><span class="co">BinR</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>BinR: <span class="tp sp">(</span><span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">visitor</span></span></a>(<a class="pp">r<span class="pc">r: <span class="tp">tree</span></span></a>,<a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>,<a class="pp">v<span class="pc">v: <span class="tp">visitor</span></span></a>) <span class="kw op">-></span> <a class="pp" href="#tmap">tmap<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tmap: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">direction</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">tree</span></span></a>(<a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<a class="pp">r<span class="pc">r: <span class="tp">tree</span></span></a>,<a class="pp" href="#con_space_BinL"><span class="co">BinL</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>BinL: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">visitor</span></span></a>(<a class="pp">t<span class="pc">t: <span class="tp">tree</span></span></a>,<a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>),<a class="pp">v<span class="pc">v: <span class="tp">visitor</span></span></a>),<a class="pp" href="#con_space_Down"><span class="co">Down</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Down: <span class="tp">direction</span></span></a>) <span class="comment">// D
</span>      <a class="pp" href="#con_space_BinL"><span class="co">BinL</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>BinL: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">visitor</span></span></a>(<a class="pp">l<span class="pc">l: <span class="tp">tree</span></span></a>,<a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>,<a class="pp">v<span class="pc">v: <span class="tp">visitor</span></span></a>) <span class="kw op">-></span> <a class="pp" href="#tmap">tmap<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tmap: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">direction</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">tree</span></span></a>(<a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<a class="pp" href="#con_space_Bin"><span class="co">Bin</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Bin: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">tree</span></span></a>(<a class="pp">l<span class="pc">l: <span class="tp">tree</span></span></a>,<a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>,<a class="pp">t<span class="pc">t: <span class="tp">tree</span></span></a>),<a class="pp">v<span class="pc">v: <span class="tp">visitor</span></span></a>,<a class="pp" href="#con_space_Up"><span class="co">Up</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Up: <span class="tp">direction</span></span></a>)       <span class="comment">// E
</span>    } 
  } 
</span>}
</span></pre>


<p class="p noindent"> 
The key idea is that we
are either <code class="koka"><a class="pp" href="#con_space_Done"><span class="co">Done</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Done: <span class="tp">visitor</span></span></a></code> (<code class="koka"><span class="co">C</span></code>), or, on going downward in a left spine we
remember all the right trees we still need to visit in a <code class="koka"><a class="pp" href="#con_space_BinR"><span class="co">BinR</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>BinR: <span class="tp sp">(</span><span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">visitor</span></span></a></code> (<code class="koka"><span class="co">A</span></code>) or,
going upward again (<code class="koka"><span class="co">B</span></code>), we remember the left tree that we just
constructed as a <code class="koka"><a class="pp" href="#con_space_BinL"><span class="co">BinL</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>BinL: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">visitor</span></span></a></code> while visiting right trees (<code class="koka"><span class="co">D</span></code>). When we come
back up (<code class="koka"><span class="co">E</span></code>), we restore the original tree with the result values. Note
that we apply the function <code class="koka">f</code> to the saved value in branch <code class="koka"><span class="co">D</span></code> (as we
visit <em class="em-low1">in-order</em>), but the functional implementation makes it easy to
specify a <em class="em-low1">pre-order</em> traversal by applying <code class="koka">f</code> in branch <code class="koka"><span class="co">A</span></code>, or a
<em class="em-low1">post-order</em> traversal by applying <code class="koka">f</code> in branch <code class="koka"><span class="co">E</span></code>.
</p>
<p class="p indent">Looking at each branch we can see that each <code class="koka"><a class="pp" href="#con_space_Bin"><span class="co">Bin</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Bin: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">tree</span></span></a></code> matches up with a
<code class="koka"><a class="pp" href="#con_space_BinR"><span class="co">BinR</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>BinR: <span class="tp sp">(</span><span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">visitor</span></span></a></code>, each <code class="koka"><a class="pp" href="#con_space_BinR"><span class="co">BinR</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>BinR: <span class="tp sp">(</span><span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">visitor</span></span></a></code> with a <code class="koka"><a class="pp" href="#con_space_BinL"><span class="co">BinL</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>BinL: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">visitor</span></span></a></code>, and finally each <code class="koka"><a class="pp" href="#con_space_BinL"><span class="co">BinL</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>BinL: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">visitor</span></span></a></code> with a <code class="koka"><a class="pp" href="#con_space_Bin"><span class="co">Bin</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>Bin: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">tree</span></span></a></code>.
Since they all have the same size, if the tree is unique, each branch
updates the tree nodes <em class="em-low1">in-place</em> at runtime without any allocation,
where the <code class="koka"><a class="pp" href="#type_space_visitor"><span class="tp">visitor</span><span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>visitor: <span class="tp">V</span></span></a></code> structure is effectively overlaid over the tree
nodes while traversing the tree. Since all <code class="koka"><a class="pp" href="#tmap">tmap<span class="pc"><span class="mo">tour<span class="fslash last">/</span></span>tmap: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">tree</span><span class="tp sp">,</span> <span class="tp tpp">visit</span> <span class="tp kw op">:</span> <span class="tp">visitor</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">direction</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">div</span> <span class="tp">tree</span></span></a></code> calls are tail calls,
this also compiles to a tight loop and thus needs no extra stack- or heap
space.
</p>
<p class="p indent">Finally, just like with re-balancing tree insertion, the algorithm as
specified is still purely functional: it uses in-place updating when a
unique tree is passed, but it also adapts gracefully to the persistent
case where the input tree is shared, or where parts of the input tree are
shared, making a single copy of those parts of the tree.
</p>
<p class="p learn button indent"><a href="https://www.microsoft.com/en-us/research/publication/perceus-garbage-free-reference-counting-with-reuse/" data-linkid="perceus">Read the Perceus technical report</a></p><h1 id="sec-koka-language-specification" class="h1" data-heading-depth="1" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-koka-language-specification" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4</span>.&#8194;</span>Koka language specification</h1>
<p class="p noindent">This is the draft language specification of the Koka language, version v2.2.0<br>
Currently only the lexical and context-free grammar are specified.
The&nbsp;<a href="toc.html" data-linkid="stdlib">standard libraries</a> are documented separately.
</p><h2 id="sec-lexical-syntax" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-lexical-syntax" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.1</span>.&#8194;</span>Lexical syntax</h2>
<p class="p noindent">We define the grammar and lexical syntax of the language using standard BNF
notation where non-terminals are generated by alternative patterns:
</p><table class="grammar madoko block">
<tbody><tr><td class="tbody tr-odd tr-last tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">nonterm</em> </td><td class="tbody tr-odd tr-last tr-first col col-even" data-row="1" data-col="2"> ::= </td><td class="tbody tr-odd tr-last tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">pattern</em><sub>1</sub> <span class="bar">|</span> <em class="em-low1">pattern</em><sub>2</sub> </td><td class="tbody tr-odd tr-last tr-first col col-even col-last" data-row="1" data-col="4">   </td></tr></tbody></table>
<p class="p noindent">In the patterns, we use the following notations:
</p><table class="grammar madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <code class="koka">terminal</code>                         </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2">   </td><td class="tbody tr-odd tr-first col col-odd col-last" data-row="1" data-col="3"> A terminal symbol                                                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <code class="code code2">x0A</code>                            </td><td class="tbody tr-even col col-even" data-row="2" data-col="2">   </td><td class="tbody tr-even col col-odd col-last" data-row="2" data-col="3"> A character with hexadecimal code 0A                                       </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <code class="code code2">a..f</code>                           </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">   </td><td class="tbody tr-odd col col-odd col-last" data-row="3" data-col="3"> The characters from a to f                                                 </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> &#160;                             </td><td class="tbody tr-even col col-even" data-row="4" data-col="2">   </td><td class="tbody tr-even col col-odd col-last" data-row="4" data-col="3">                                                                            </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> ( <em class="em-low1">pattern</em> )                      </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2">   </td><td class="tbody tr-odd col col-odd col-last" data-row="5" data-col="3"> Grouping                                                                   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> [ <em class="em-low1">pattern</em> ]                      </td><td class="tbody tr-even col col-even" data-row="6" data-col="2">   </td><td class="tbody tr-even col col-odd col-last" data-row="6" data-col="3"> Optional occurrence of <em class="em-low1">pattern</em>                                           </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> { <em class="em-low1">pattern</em> }                      </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2">   </td><td class="tbody tr-odd col col-odd col-last" data-row="7" data-col="3"> Zero or more occurrences of <em class="em-low1">pattern</em>                                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">pattern</em><sub>1</sub> <span class="bar">|</span> <em class="em-low1">pattern</em><sub>2</sub> </td><td class="tbody tr-even col col-even" data-row="8" data-col="2">   </td><td class="tbody tr-even col col-odd col-last" data-row="8" data-col="3"> Choice: either <em class="em-low1">pattern</em><sub>1</sub> or <em class="em-low1">pattern</em><sub>2</sub>                                </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;                             </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">   </td><td class="tbody tr-odd col col-odd col-last" data-row="9" data-col="3">                                                                            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">pattern</em><sub>&#60;!<em class="em-low1">diff</em>&gt;</sub>            </td><td class="tbody tr-even col col-even" data-row="10" data-col="2">   </td><td class="tbody tr-even col col-odd col-last" data-row="10" data-col="3"> Difference: elements generated by <em class="em-low1">pattern</em> except those in <em class="em-low1">diff</em>         </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">nonterm</em><sub>[<em class="em-low1">lex</em>]</sub>               </td><td class="tbody tr-odd tr-last col col-even" data-row="11" data-col="2">   </td><td class="tbody tr-odd tr-last col col-odd col-last" data-row="11" data-col="3"> Generate <em class="em-low1">nonterm</em> by drawing lexemes from <em class="em-low1">lex</em>                           </td></tr></tbody></table><!--
| _pattern_~&lt;_postfix_>~          |   | Postfix: any elements in _pattern_ that are directly followed by _postfix_ |
| ~&lt;_prefix_>~_pattern_           |   | Prefix: any elements in _pattern_ that directly follow _prefix_            |
-->



<p class="p grammar noindent">Care must be taken to distinguish meta-syntax such as
 <span class="bar">|</span> and )
from concrete terminal symbols as <code class="code code2">|</code> and <code class="code code2">)</code>. In the specification
the order of the productions is not important and at each point the
<em class="em-low1">longest matching lexeme</em> is preferred. For example, even though
<code class="koka"><span class="kw">function</span></code> is a reserved word, the word <code class="koka">functions</code> is considered a
single identifier. A <em class="em-low1">prefix</em> or <em class="em-low1">postfix</em> pattern is included
when considering a longest match.</p><h3 id="sec-source-code" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-source-code" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.1.1</span>.&#8194;</span>Source code</h3>
<p class="p noindent">Source code consists of a sequence of 8-bit characters. Valid characters in
actual program code consists strictly of ASCII characters which range from 0
to 127 and can be encoded in 7-bits. Only comments, string literals, and
character literals are allowed to contain extended 8-bit characters.
</p><h3 id="sec-encoding" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-encoding" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.1.2</span>.&#8194;</span>Encoding</h3>
<p class="p noindent">A program source is assumed to be UTF-8 encoded which allows comments,
string literals, and character literals to contain (encoded) unicode
characters. Moreover, the grammar is designed such that a lexical
analyzer and parser can directly work on source files without doing UTF-8
decoding or unicode category identification. To further facilitate the
processing of UTF-8 encoded files the lexical analyzer ignores an initial
byte-order mark that some UTF-8 encoders insert. In particular, any
program source is allowed to start with three byte-order mark bytes
<code class="code code2">0xEF</code>, <code class="code code2">0xBB</code>, and <code class="code code2">0xBF</code>, which are ignored.
</p><h2 id="sec-lexical-grammar" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-lexical-grammar" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.2</span>.&#8194;</span>Lexical grammar</h2>
<p class="p noindent">In the specification of the lexical grammar all white space is explicit
and there is no implicit white space between juxtaposed symbols. The
lexical token stream is generated by the non-terminal <em class="em-low1">lex</em> which
consists of lexemes and whitespace.
</p>
<p class="p indent">Before doing lexical analysis, there is a <em class="em-low1">linefeed</em> character inserted
at the start and end of the input, which makes it easier to specify line
comments and directives.
</p><h3 id="sec-lexical-tokens" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-lexical-tokens" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.2.1</span>.&#8194;</span>Lexical tokens</h3><table class="grammar lex madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">lex</em>                </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">lexeme</em> <span class="bar">|</span> <em class="em-low1">whitespace</em>                               </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">lexeme</em>&#160;&#160; </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">conid</em> <span class="bar">|</span> <em class="em-low1">qconid</em>                                    </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1">                      </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">varid</em> <span class="bar">|</span> <em class="em-low1">qvarid</em>                                    </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1">                      </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">op</em> <span class="bar">|</span> <em class="em-low1">opid</em> <span class="bar">|</span> <em class="em-low1">qopid</em> <span class="bar">|</span> <em class="em-low1">wildcard</em>    </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">                      </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">natural</em> <span class="bar">|</span> <em class="em-low1">float</em> <span class="bar">|</span> <em class="em-low1">string</em> <span class="bar">|</span> <em class="em-low1">char</em> </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">                      </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">reserved</em> <span class="bar">|</span> <em class="em-low1">opreserved</em>                             </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">     </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="7" data-col="1">                      </td><td class="tbody tr-odd tr-last col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd tr-last col col-odd" data-row="7" data-col="3"> <em class="em-low1">special</em>                                                    </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="7" data-col="4">     </td></tr></tbody></table>
<p class="p noindent">The main program consists of <em class="em-low1">whitespace</em> or <em class="em-low1">lexeme</em>&#39;s. The context-free
grammar will draw it&#39;s lexemes from the <em class="em-low1">lex</em> production.
</p><h3 id="sec-identifiers" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-identifiers" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.2.2</span>.&#8194;</span>Identifiers</h3><table class="grammar lex madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">anyid</em>      </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">varid</em> <span class="bar">|</span> <em class="em-low1">qvarid</em> <span class="bar">|</span> <em class="em-low1">opid</em> <span class="bar">|</span> <em class="em-low1">qopid</em> <span class="bar">|</span> <em class="em-low1">conid</em> <span class="bar">|</span> <em class="em-low1">qconid</em> </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="2" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3">                                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">qconid</em>     </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">modulepath</em> <em class="em-low1">conid</em>                                                                          </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">qvarid</em>     </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">modulepath</em> <em class="em-low1">lowerid</em>                                                                        </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">modulepath</em> </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">lowerid</em> <code class="koka"><span class="op"><span class="divide">/</span></span></code> <span class="many">{ <em class="em-low1">lowerid</em> <code class="koka"><span class="op"><span class="divide">/</span></span></code> }</span>                                                          </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="6" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3">                                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">conid</em>      </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <em class="em-low1">upperid</em>                                                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">varid</em>      </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">lowerid</em><sub>&#60;!<em class="em-low1">reserved</em>&#62;</sub>                                                                </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                                                                               </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">lowerid</em>    </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <em class="em-low1">lower</em> <em class="em-low1">idtail</em>                                                                              </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">upperid</em>    </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <em class="em-low1">upper</em> <em class="em-low1">idtail</em>                                                                              </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> <em class="em-low1">wildcard</em>   </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <code class="code code2">_</code> <em class="em-low1">idtail</em>                                                                                </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">typevarid</em>  </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <em class="em-low1">letter</em> <span class="many">{ <em class="em-low1">digit</em> }</span>                                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="14" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3">                                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1"> <em class="em-low1">idtail</em>     </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3"> <span class="many">{ <em class="em-low1">idchar</em> }</span> <span class="opt">[ <em class="em-low1">idfinal</em> ]</span>                                                           </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1"> <em class="em-low1">idchar</em>     </td><td class="tbody tr-even col col-even" data-row="16" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3"> <em class="em-low1">letter</em> <span class="bar">|</span> <em class="em-low1">digit</em> <span class="bar">|</span> <code class="code code2">_</code> <span class="bar">|</span> <code class="code code2">-</code>                                       </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="17" data-col="1"> <em class="em-low1">idfinal</em>    </td><td class="tbody tr-odd col col-even" data-row="17" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="17" data-col="3"> <span class="many">{ <code class="code code2">&#39;</code> }</span>                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="17" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="18" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="18" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="18" data-col="3">                                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="18" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="19" data-col="1"> <em class="em-low1">reserved</em>   </td><td class="tbody tr-odd col col-even" data-row="19" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="19" data-col="3"> <code class="koka"><span class="kw">infix</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">infixr</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">infixl</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">prefix</span></code>                                 </td><td class="tbody tr-odd col col-even col-last" data-row="19" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="20" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="20" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="20" data-col="3"> <code class="koka"><span class="tp kw">type</span></code> <span class="bar">|</span> <code class="koka"><span class="tp kw">struct</span></code> <span class="bar">|</span> <code class="koka"><span class="tp kw">alias</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">con</span></code>                                                    </td><td class="tbody tr-even col col-even col-last" data-row="20" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="21" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="21" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="21" data-col="3"> <code class="koka"><span class="kw">forall</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">exists</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">some</span></code>                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="21" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="22" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="22" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="22" data-col="3"> <code class="koka"><span class="kw">fun</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">fn</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">val</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">var</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">extern</span></code>                           </td><td class="tbody tr-even col col-even col-last" data-row="22" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="23" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="23" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="23" data-col="3"> <code class="koka"><span class="kw">if</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">then</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">else</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">elif</span></code>                                          </td><td class="tbody tr-odd col col-even col-last" data-row="23" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="24" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="24" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="24" data-col="3"> <code class="koka"><span class="kw">match</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">return</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">with</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">in</span></code>                                       </td><td class="tbody tr-even col col-even col-last" data-row="24" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="25" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="25" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="25" data-col="3"> <code class="koka"><span class="kw">handle</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">handler</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">mask</span></code>                                                   </td><td class="tbody tr-odd col col-even col-last" data-row="25" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="26" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="26" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="26" data-col="3"> <code class="koka"><span class="kw">override</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">control</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">rcontrol</span></code>                                             </td><td class="tbody tr-even col col-even col-last" data-row="26" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="27" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="27" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="27" data-col="3"> <code class="koka"><span class="tp kw">effect</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">named</span></code>                                               </td><td class="tbody tr-odd col col-even col-last" data-row="27" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="28" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="28" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="28" data-col="3"> <code class="code code2">module</code> <span class="bar">|</span> <code class="koka"><span class="kw">import</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">as</span></code>                                                    </td><td class="tbody tr-even col col-even col-last" data-row="28" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="29" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="29" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="29" data-col="3"> <code class="koka"><span class="kw">public</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">private</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">abstract</span></code>                                               </td><td class="tbody tr-odd col col-even col-last" data-row="29" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="30" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="30" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="30" data-col="3"> <code class="koka"><span class="kw">pub</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">interface</span></code> <span class="bar">|</span> <code class="koka">yield</code> <span class="bar">|</span> <code class="koka">qualified</code> <span class="bar">|</span> <code class="koka">hiding</code> <span class="bar">|</span> <code class="koka"><span class="kw">unsafe</span></code>         </td><td class="tbody tr-even col col-even col-last" data-row="30" data-col="4"> (future reserved words) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="31" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="31" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="31" data-col="3">                                                                                               </td><td class="tbody tr-odd col col-even col-last" data-row="31" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="32" data-col="1"> <em class="em-low1">specialid</em>  </td><td class="tbody tr-even col col-even" data-row="32" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="32" data-col="3"> <code class="koka">co</code> <span class="bar">|</span> <code class="koka">rec</code> <span class="bar">|</span> <code class="koka">open</code> <span class="bar">|</span> <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#extend">extend<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>extend: <span class="tp sp">(</span><span class="tp tpp">slice</span> <span class="tp kw op">:</span> <span class="tp">sslice</span><span class="tp sp">,</span> <span class="tp tpp">count</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">sslice</span></span></a></code> <span class="bar">|</span> <code class="koka">behind</code>                                                    </td><td class="tbody tr-even col col-even col-last" data-row="32" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="33" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="33" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="33" data-col="3"> <code class="koka">linear</code> <span class="bar">|</span> <code class="koka">value</code> <span class="bar">|</span> <code class="koka">reference</code>                                                </td><td class="tbody tr-odd col col-even col-last" data-row="33" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="34" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="34" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="34" data-col="3"> <code class="koka">inline</code> <span class="bar">|</span> <code class="koka">noinline</code> <span class="bar">|</span> <code class="koka">include</code> <span class="bar">|</span> <code class="koka"><span class="kw">import</span></code>                             </td><td class="tbody tr-even col col-even col-last" data-row="34" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="35" data-col="1">              </td><td class="tbody tr-odd tr-last col col-even" data-row="35" data-col="2"> &#124; </td><td class="tbody tr-odd tr-last col col-odd" data-row="35" data-col="3"> <code class="koka">js</code> <span class="bar">|</span> <code class="koka">c</code>  <span class="bar">|</span> <code class="koka">file</code>                                                            </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="35" data-col="4">                         </td></tr></tbody></table>
<p class="p noindent">Identifiers always start with a letter, may contain underscores and
dashes, and can end with prime ticks.
Like in Haskell, constructors always begin with an uppercase
letter while regular identifiers are lowercase. The rationale is to
visibly distinguish constants from variables in pattern matches.
Here are some example of valid identifiers:
</p><pre class="koka source unchecked"><span class="plaincode">x
concat1
visit-left
is-nil
x'
Cons
True  
</span><span class="nicecode">x
concat1
visit<span class="dash">-</span>left
<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#is_nil">is<span class="dash">-</span>nil<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">list</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>
x'
<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>  
</span></pre>


<p class="p noindent">To avoid confusion with the subtraction operator, the occurrences of
dashes are restricted in identifiers. After lexical analysis, only
identifiers where each dash is surrounded on both sides with a <em class="em-low1">letter</em>
are accepted:
</p>
<pre class="para-block pre-fenced pre-fenced4 language-koka lang-koka koka colorized" style="display:block"><code>fold-right
n-1        <span style="color:darkgreen">//</span><span style="color:darkgreen"> illegal, a digit cannot follow a dash</span>
n - <span class="constant" style="color:purple">1</span>      <span style="color:darkgreen">//</span><span style="color:darkgreen"> n minus 1</span>
n-x-1      <span style="color:darkgreen">//</span><span style="color:darkgreen"> illegal, a digit cannot follow a dash</span>
n-x - <span class="constant" style="color:purple">1</span>    <span style="color:darkgreen">//</span><span style="color:darkgreen"> identifier </span><span style="color:darkgreen">&quot;</span><span style="color:gray">n-x</span><span style="color:darkgreen">&quot;</span><span style="color:darkgreen"> minus 1</span>
n - x - <span class="constant" style="color:purple">1</span>  <span style="color:darkgreen">//</span><span style="color:darkgreen"> n minus x minus 1</span></code></pre>
<p class="p noindent para-continued">Qualified identifiers are prefixed with a module path. Module
paths can be partial as long as they are unambiguous.
</p>
<pre class="para-block pre-fenced pre-fenced4 language-koka lang-koka koka colorized" style="display:block"><code><span style="color:navy">core/</span>map
<span style="color:navy">std/</span>core/(&amp;)</code></pre><h3 id="sec-operators-and-symbols" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-operators-and-symbols" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.2.3</span>.&#8194;</span>Operators and symbols</h3><table class="grammar lex madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">qopid</em>      </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">modulepath</em> <em class="em-low1">opid</em>                                                                                                                                   </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">opid</em>       </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <code class="koka">(</code> <em class="em-low1">symbols</em> <code class="koka">)</code>                                                                                                                                     </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                                                                                                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">op</em>         </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">symbols</em><sub>&#60;!&#160;<em class="em-low1">opreserved</em><span class="bar">|</span><em class="em-low1">optype</em>&#62;</sub>  <span class="bar">|</span>  <code class="code code2"><span class="code-escaped">&#124;&#124;</span></code>                                                                      </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3">                                                                                                                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">symbols</em>    </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">symbol</em> <span class="many">{ <em class="em-low1">symbol</em> }</span><span class="bar">|</span> <code class="code code2">/</code>                                                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">symbol</em>     </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka"><span class="op">$</span></code> <span class="bar">|</span> <code class="koka"><span class="op">%</span></code> <span class="bar">|</span> <code class="code code2">&amp;</code> <span class="bar">|</span> <code class="koka"><span class="op">&#42;</span></code> <span class="bar">|</span> <code class="koka"><span class="op">+</span></code>                                                                                             </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="code code2">~</code> <span class="bar">|</span> <code class="code code2">!</code> <span class="bar">|</span> <code class="code code2">\</code> <span class="bar">|</span> <code class="koka"><span class="op">^</span></code> <span class="bar">|</span> <code class="code code2">#</code>                                                                                       </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="code code2">=</code> <span class="bar">|</span> <code class="code code2">.</code> <span class="bar">|</span> <code class="code code2">:</code> <span class="bar">|</span> <code class="koka"><span class="op"><span class="minus">-</span></span></code> <span class="bar">|</span> <code class="koka"><span class="op">?</span></code>                                                                                         </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <em class="em-low1">anglebar</em>                                                                                                                                            </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">anglebar</em>   </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="code code2">&lt;</code> <span class="bar">|</span> <code class="code code2">&gt;</code> <span class="bar">|</span> <code class="code code2"><span class="code-escaped">&#124;</span></code>                                                                                                           </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="12" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3">                                                                                                                                                       </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">opreserved</em> </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <code class="koka"><span class="kw">=</span></code> <span class="bar">|</span> <code class="koka"><span class="kw op">.</span></code> <span class="bar">|</span> <code class="code code2">:</code> <span class="bar">|</span> <code class="koka"><span class="kw op">-&gt;</span></code>                                                                                                         </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">optype</em>     </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">anglebar</em> <em class="em-low1">anglebar</em> <span class="many">{ <em class="em-low1">anglebar</em> }</span>                                                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3">                                                                                                                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1"> <em class="em-low1">special</em>    </td><td class="tbody tr-even col col-even" data-row="16" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3"> <code class="koka">{</code> <span class="bar">|</span> <code class="koka">}</code> <span class="bar">|</span> <code class="koka">(</code> <span class="bar">|</span> <code class="koka">)</code> <span class="bar">|</span> <code class="koka">[</code> <span class="bar">|</span> <code class="koka">]</code> <span class="bar">|</span> <code class="code code2"><span class="code-escaped">&#124;</span></code> <span class="bar">|</span> <code class="koka">;</code> <span class="bar">|</span> <code class="koka">,</code>                                 </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="17" data-col="1"> &#160;       </td><td class="tbody tr-odd tr-last col col-even" data-row="17" data-col="2">       </td><td class="tbody tr-odd tr-last col col-odd" data-row="17" data-col="3">                                                                                                                                                       </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="17" data-col="4">    </td></tr></tbody></table><h3 id="sec-literals" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-literals" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.2.4</span>.&#8194;</span>Literals</h3><table class="grammar lex madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">string</em>      </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=    </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <code class="code code2">@&quot;</code> <span class="many">{ <em class="em-low1">graphic</em><sub>&#60;<code class="code code2">&quot;</code>&#62;</sub> <span class="bar">|</span> <em class="em-low1">utf8</em> <span class="bar">|</span> <em class="em-low1">space</em> <span class="bar">|</span> <em class="em-low1">tab</em> <span class="bar">|</span> <em class="em-low1">newline</em> <span class="bar">|</span> <code class="code code2">&quot;&quot;</code> }</span> <code class="code code2">&quot;</code> </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4"> (raw string) </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <code class="code code2">&quot;</code> <span class="many">{ <em class="em-low1">graphic</em><sub>&#60;<code class="code code2">&quot;</code><span class="bar">|</span><code class="code code2">\</code>&#62;</sub> <span class="bar">|</span> <em class="em-low1">utf8</em> <span class="bar">|</span> <em class="em-low1">space</em> <span class="bar">|</span> <em class="em-low1">escape</em> }</span> <code class="code code2">&quot;</code>                     </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">char</em>        </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <code class="code code2">&#39;</code> ( <em class="em-low1">graphic</em><sub>&#60;<code class="code code2">&#39;</code><span class="bar">|</span><code class="code code2">\</code>&#62;</sub> <span class="bar">|</span> <em class="em-low1">utf8</em> <span class="bar">|</span> <em class="em-low1">space</em> <span class="bar">|</span> <em class="em-low1">escape</em> ) <code class="code code2">&#39;</code>                          </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="4" data-col="2">        </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3">                                                                                                                           </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">escape</em>      </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <code class="code code2">\</code> ( <em class="em-low1">charesc</em> <span class="bar">|</span> <em class="em-low1">hexesc</em> )                                                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">charesc</em>     </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka">n</code> <span class="bar">|</span> <code class="koka">r</code> <span class="bar">|</span> <code class="koka">t</code> <span class="bar">|</span> <code class="code code2">\</code> <span class="bar">|</span> <code class="code code2">&quot;</code> <span class="bar">|</span> <code class="code code2">&#39;</code>                                                      </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">hexesc</em>      </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka">x</code> <em class="em-low1">hexdigit</em><sub>2</sub> <span class="bar">|</span>   <code class="koka">u</code> <em class="em-low1">hexdigit</em><sub>4</sub> <span class="bar">|</span>   <code class="code code2">U</code> <em class="em-low1">hexdigit</em><sub>4</sub> <em class="em-low1">hexdigit</em><sub>2</sub>                                 </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">hexdigit</em><sub>4</sub> </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">hexdigit</em> <em class="em-low1">hexdigit</em> <em class="em-low1">hexdigit</em> <em class="em-low1">hexdigit</em>                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> <em class="em-low1">hexdigit</em><sub>2</sub> </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <em class="em-low1">hexdigit</em> <em class="em-low1">hexdigit</em>                                                                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="10" data-col="2">        </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3">                                                                                                                           </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">float</em>       </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <em class="em-low1">decimal</em> <code class="koka"><span class="kw op">.</span></code> <em class="em-low1">decimal</em> <span class="opt">[ <em class="em-low1">exponent</em> ]</span>                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> <em class="em-low1">exponent</em>    </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> (<code class="code code2">e</code> &#124;  <code class="code code2">E</code>) <span class="opt">[ <code class="code code2">-</code> &#124;  <code class="code code2">+</code> ]</span> <em class="em-low1">decimal</em>                                                                     </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">natural</em>     </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <em class="em-low1">decimal</em> <span class="bar">|</span> <code class="koka"><span class="number">0</span></code> &#160; (<code class="code code2">x</code> &#124;  <code class="code code2">X</code>) <em class="em-low1">hexadecimal</em>                                                              </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">decimal</em>     </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">digit</em> <span class="many">{ <em class="em-low1">digit</em> }</span>                                                                                                  </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="15" data-col="1"> <em class="em-low1">hexadecimal</em> </td><td class="tbody tr-odd tr-last col col-even" data-row="15" data-col="2"> ::=    </td><td class="tbody tr-odd tr-last col col-odd" data-row="15" data-col="3"> <em class="em-low1">hexdigit</em> <span class="many">{ <em class="em-low1">hexdigit</em> }</span>                                                                                            </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="15" data-col="4">              </td></tr></tbody></table><h3 id="sec-white-space" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-white-space" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.2.5</span>.&#8194;</span>White space</h3><table class="grammar lex madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">whitespace</em>    </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=    </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">white</em> <span class="many">{ <em class="em-low1">white</em> }</span> <span class="bar">|</span> <em class="em-low1">newline</em>                                                                           </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">white</em>         </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">space</em>                                                                         </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1">                 </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">linecomment</em> <span class="bar">|</span> <em class="em-low1">blockcomment</em>                                                              </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1">                 </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">linedirective</em>                                                                                    </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> &#160;          </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3">                                                                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">linecomment</em>   </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="code code2">//</code> <span class="many">{ <em class="em-low1">linechar</em> }</span>                                                                  </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">linedirective</em> </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <em class="em-low1">newline</em> <code class="code code2">#</code> <span class="many">{ <em class="em-low1">linechar</em> }</span>                                            </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">linechar</em>      </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">graphic</em> <span class="bar">|</span> <em class="em-low1">utf8</em> <span class="bar">|</span> <em class="em-low1">space</em> <span class="bar">|</span> <em class="em-low1">tab</em>                                          </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;          </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                                                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">blockcomment</em>  </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <code>/&#42;</code> <em class="em-low1">blockpart</em> <span class="many">{ <em class="em-low1">blockcomment</em> <em class="em-low1">blockpart</em> }</span> <code>&#42;/</code>            </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4"> (allows nested comments) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">blockpart</em>     </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <em class="em-low1">blockchars</em><sub>&#60;<em class="em-low1">blockchars</em>&#160;(<code>/&#42;</code><span class="bar">|</span><code>&#42;/</code>)&#160;<em class="em-low1">blockchars</em>&#62;</sub> </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> <em class="em-low1">blockchars</em>    </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <span class="many">{ <em class="em-low1">blockchar</em> }</span>                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">                          </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">blockchar</em>     </td><td class="tbody tr-odd tr-last col col-even" data-row="13" data-col="2"> ::=    </td><td class="tbody tr-odd tr-last col col-odd" data-row="13" data-col="3"> <em class="em-low1">graphic</em> <span class="bar">|</span> <em class="em-low1">utf8</em> <span class="bar">|</span> <em class="em-low1">space</em> <span class="bar">|</span> <em class="em-low1">tab</em> <span class="bar">|</span> <em class="em-low1">newline</em>                       </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="13" data-col="4">                          </td></tr></tbody></table><h3 id="sec-character-classes" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-character-classes" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.2.6</span>.&#8194;</span>Character classes</h3><table class="grammar lex madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">letter</em>   </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=    </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">upper</em> <span class="bar">|</span> <em class="em-low1">lower</em>                </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">upper</em>    </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <code class="code code2">A..Z</code>                                  </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">lower</em>    </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <code class="code code2">a..z</code>                                  </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">digit</em>    </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <code class="code code2">0..9</code>                                  </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">hexdigit</em> </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <code class="code code2">a..f</code> <span class="bar">|</span> <code class="code code2">A..F</code> <span class="bar">|</span> <em class="em-low1">digit</em> </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> &#160;     </td><td class="tbody tr-even col col-even" data-row="6" data-col="2">        </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3">                                         </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">newline</em>  </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <span class="opt">[ <em class="em-low1">return</em> ]</span> <em class="em-low1">linefeed</em>             </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4"> (windows or unix style end of line) </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> &#160;     </td><td class="tbody tr-even col col-even" data-row="8" data-col="2">        </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3">                                         </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> <em class="em-low1">space</em>    </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="code code2">x20</code>                                   </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4"> (a space)                           </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">tab</em>      </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <code class="code code2">x09</code>                                   </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4"> (a tab (<code class="code code2">\t</code>))                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">linefeed</em> </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="code code2">x0A</code>                                   </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4"> (a line feed (<code class="code code2">\n</code>))                </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> <em class="em-low1">return</em>   </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <code class="code code2">x0D</code>                                   </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4"> (a carriage return (<code class="code code2">\r</code>))          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">graphic</em>  </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <code class="code code2">x21</code>..<code class="code code2">x7E</code>                            </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4"> (a visible character)               </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> &#160;     </td><td class="tbody tr-even col col-even" data-row="14" data-col="2">        </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3">                                         </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1"> <em class="em-low1">utf8</em>     </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3"> <code class="code code2">xC0</code> <code class="code code2">x80</code>                             </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4"> (encoded 0 character)               </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="16" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3"> (<code class="code code2">xC2</code>..<code class="code code2">xDF</code>) <em class="em-low1">cont</em>                   </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="17" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="17" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="17" data-col="3"> <code class="code code2">xE0</code> (<code class="code code2">xA0</code>..<code class="code code2">xBF</code>) <em class="em-low1">cont</em>             </td><td class="tbody tr-odd col col-even col-last" data-row="17" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="18" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="18" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="18" data-col="3"> (<code class="code code2">xE1</code>..<code class="code code2">xEC</code>) <em class="em-low1">cont</em> <em class="em-low1">cont</em>            </td><td class="tbody tr-even col col-even col-last" data-row="18" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="19" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="19" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="19" data-col="3"> <code class="code code2">xED</code> (<code class="code code2">x80</code>..<code class="code code2">x9F</code>) <em class="em-low1">cont</em>             </td><td class="tbody tr-odd col col-even col-last" data-row="19" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="20" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="20" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="20" data-col="3"> (<code class="code code2">xEE</code>..<code class="code code2">xEF</code>) <em class="em-low1">cont</em> <em class="em-low1">cont</em>            </td><td class="tbody tr-even col col-even col-last" data-row="20" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="21" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="21" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="21" data-col="3"> <code class="code code2">xF0</code> (<code class="code code2">x90</code>..<code class="code code2">xBF</code>) <em class="em-low1">cont</em> <em class="em-low1">cont</em>      </td><td class="tbody tr-odd col col-even col-last" data-row="21" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="22" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="22" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="22" data-col="3"> (<code class="code code2">xF1</code>..<code class="code code2">xF3</code>) <em class="em-low1">cont</em> <em class="em-low1">cont</em> <em class="em-low1">cont</em>     </td><td class="tbody tr-even col col-even col-last" data-row="22" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="23" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="23" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="23" data-col="3"> <code class="code code2">xF4</code> (<code class="code code2">x80</code>..<code class="code code2">x8F</code>) <em class="em-low1">cont</em> <em class="em-low1">cont</em>      </td><td class="tbody tr-odd col col-even col-last" data-row="23" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="24" data-col="1"> <em class="em-low1">cont</em>     </td><td class="tbody tr-even tr-last col col-even" data-row="24" data-col="2"> ::=    </td><td class="tbody tr-even tr-last col col-odd" data-row="24" data-col="3"> <code class="code code2">x80</code>..<code class="code code2">xBF</code>                            </td><td class="tbody tr-even tr-last col col-even col-last" data-row="24" data-col="4">                                     </td></tr></tbody></table><!--
### Semicolons?

Many languages have rules to avoid writing semicolons to separate
statements. Even though most of the time these rules are quite intuitive
to use, their actual definition can be quite subtle. For example,
both [Scala][lscala] and [Go][lgo] require remembering specific tokens to
know precisely when semicolon insertion takes place. In the case
of [JavaScript][ljavascript] and [Haskell][lhaskell] (I am sad to admit)
the precise behavior is bizarrely complex where semicolon insertion
depends on the interaction between the lexer and parser.

In &koka;, the grammar is carefully constructed to not need any statement
separator at all and semicolons are never required by the grammar.
They are still allowed in the grammar but strictly to help new programmers
that are used to putting semicolons at the end of statements.

The construction of a grammar that does not need statement separators is
also good from a human perspective. The reason semicolons are required is
to resolve ambiguities in the syntax. When such ambiguities do not occur
in the first place, that also removes a cognitive burden from the
programmer. In particular, &koka; statements often start with a keyword,
like <code class="koka"><span class="kw">val</span></code> or <code class="koka"><span class="kw">match</span></code>, signifying intention to both programmer and parser.

In other cases, we restrict the expression grammar. For example, one
reason why C requires semicolons is due to prefix- and postfix operators.
If we write ``p ++ q`` the C parser needs a semicolon in order to know if
we meant ``p++; q`` or ``p; ++q``. Such ambiguity is resolved in &koka; by
not having postfix operators and restricting prefix operators to ``!``
and ``~``.

One other reason that &koka; can do without a statement separator is the
effect inference system: without such effect inference subtle bugs may
occur if we leave out semicolons. For example, consider the following
function:
<pre class="koka source"><span class="plaincode">fun square( x : int ) {
  x &#42; x
}
</span><span class="nicecode"><span class="decl-fun" id="square"><span class="kw">fun</span> <a class="pp" href="#square">square<span class="pc"><span class="mo">spec<span class="fslash last">/</span></span>square: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) {
  <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>
</span>}
</span></pre>
which returns the square of <code class="koka">x</code>. Suppose now that we forgot to put
in the multiplication operation, giving:
<pre class="koka source unchecked"><span class="plaincode">fun square-wrong( x : int ) {
  x x
}
</span><span class="nicecode"><span class="kw">fun</span> square<span class="dash">-</span>wrong( x <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) {
  x x
}
</span></pre>
The &koka; grammar sees this as 2 separate statements now, &ie; as ``x; x``
returning ``x`` instead. In a language without effect inference it is hard
to detect such errors, but the &koka; type system rejects this program:

    > fun square-wrong(x:int) { x x }
                                ^
    ((1),27): error: expression has no effect and is unused
      hint: did you forget an operator? or is there a space between an application?


[LHaskell]: http://www.haskell.org/onlinereport/haskell2010/haskellch10.html#x17-17800010.3  
[LPython]: http://docs.python.org/2/reference/lexical_analysis.html
[LJavaScript]: https://tc39.github.io/ecma262/#sec-rules-of-automatic-semicolon-insertion
[LScala]: http://www.scala-lang.org/old/sites/default/files/linuxsoft_archives/docu/files/ScalaReference.pdf#page=13
[LGo]: http://golang.org/ref/spec#Semicolons

-->


<h2 id="sec:layout" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec:layout" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.3</span>.&#8194;</span>Semicolon insertion</h2>
<p class="p noindent">Just like programming languages like
<a href="http://www.haskell.org/onlinereport/haskell2010/haskellch10.html#x17-17800010.3" data-linkid="haskell">Haskell</a>,&nbsp;<a href="http://docs.python.org/2/reference/lexical_analysis.html" data-linkid="python">Python</a>,&nbsp;<a href="https://tc39.github.io/ecma262/#sec-rules-of-automatic-semicolon-insertion" data-linkid="javascript">JavaScript</a>,&nbsp;<a href="http://www.scala-lang.org/old/sites/default/files/linuxsoft_archives/docu/files/ScalaReference.pdf#page=13" data-linkid="scala">Scala</a>,&nbsp;<a href="http://golang.org/ref/spec#Semicolons" data-linkid="go">Go</a>, etc., there is a layout rule
which automatically adds semicolons at appropriate places. This enables the
programmer to leave out most semicolons:
</p>
<p class="p indent" style="padding-left:1em">Koka inserts semicolons automatically for any statements
and declarations that are <em class="em-low1">aligned between curly braces</em> (<code class="koka">{</code> and <code class="koka">}</code>).</p>
<p class="p grammar indent">For example, in the following program:</p><pre class="koka source"><span class="plaincode">fun eq1( x : int, y : int ) : io bool
{  
  print("calculate equality")
  val result = if (x == y) then True            
                else False
  result
}  
</span><span class="nicecode"><span class="decl-fun" id="eq1"><span class="kw">fun</span> <a class="pp" href="#eq1">eq1<span class="pc"><span class="mo">spec<span class="fslash last">/</span></span>eq1: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp">bool</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a>
{  
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#print">print<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>print: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"calculate equality"</span>)
  <span class="kw">val</span> <a class="pp">result<span class="pc">result: <span class="tp">bool</span></span></a> <span class="kw">=</span> <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>) <span class="kw">then</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>            
                <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>
  <a class="pp">result<span class="pc">result: <span class="tp">bool</span></span></a>
</span>}  
</span></pre>



<p class="p noindent">we get semicolons before each statement that was aligned between the braces:
</p><pre class="koka source"><span class="plaincode">fun eqSemi( x : int, y : int ) : io bool
{;  
  print("calculate equality");
  val result = if (x == y) then True            
                else False;
  result;
}  
</span><span class="nicecode"><span class="decl-fun" id="eqSemi"><span class="kw">fun</span> <a class="pp" href="#eqSemi">eqSemi<span class="pc"><span class="mo">spec<span class="fslash last">/</span></span>eqSemi: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp">bool</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a>
{;  
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#print">print<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>print: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"calculate equality"</span>);
  <span class="kw">val</span> <a class="pp">result<span class="pc">result: <span class="tp">bool</span></span></a> <span class="kw">=</span> <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>) <span class="kw">then</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>            
                <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>;
  <a class="pp">result<span class="pc">result: <span class="tp">bool</span></span></a>;
</span>}  
</span></pre>



<p class="p noindent">Since semicolons are only inserted for <em class="em-low1">aligned</em> statements, we can
write a long statement on multiple lines by using more indentation:
</p><pre class="koka source"><span class="plaincode">fun eq2( x : int, y : int ) : io bool
{  
  print("calculate " ++
         "equ" ++
         "ality")
  val result = if (x == y)
                then True
                else False
  result
}  
</span><span class="nicecode"><span class="decl-fun" id="eq2"><span class="kw">fun</span> <a class="pp" href="#eq2">eq2<span class="pc"><span class="mo">spec<span class="fslash last">/</span></span>eq2: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp">bool</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a>
{  
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#print">print<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>print: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"calculate "</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__plus__1">++<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(++)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>
         <span class="st">"equ"</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__plus__1">++<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(++)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>
         <span class="st">"ality"</span>)
  <span class="kw">val</span> <a class="pp">result<span class="pc">result: <span class="tp">bool</span></span></a> <span class="kw">=</span> <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>)
                <span class="kw">then</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>
                <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>
  <a class="pp">result<span class="pc">result: <span class="tp">bool</span></span></a>
</span>}  
</span></pre>



<p class="p noindent">In contrast to token-based layout rules (as in&nbsp;<a href="http://www.scala-lang.org/old/sites/default/files/linuxsoft_archives/docu/files/ScalaReference.pdf#page=13" data-linkid="scala">Scala</a> or&nbsp;<a href="http://golang.org/ref/spec#Semicolons" data-linkid="go">Go</a> for example), this
allows you to put line breaks at any point in a statement by just indenting
more. Moreover, it means that the visual indentation of a program corresponds
directly to how the compiler interprets the statements. Many tricky layout
examples in other programming languages are often based on a mismatch between
the visual representation and how a compiler interprets the tokens &#8211; with
Koka&#39;s layout rule such issues are largely avoided.
</p>
<p class="p grammar indent">To still allow for &#8220;block-style&#8221; layout, the
layout rule does not insert a  semicolon for an aligned statement if it
starts with <code class="koka"><span class="kw">then</span></code>, <code class="koka"><span class="kw">else</span></code>, <code class="koka"><span class="kw">elif</span></code>, or one of <code class="koka">{</code>, <code class="koka">,</code>, <code class="koka">)</code>, or <code class="koka">]</code>.</p><pre class="koka source"><span class="plaincode">fun bar()
{  
  val xs = [
    "list",
    "elements",
  ]
  if (is-odd(3&#42;3))
  {
    print("odd")
  }
  else
    print("even")
}  
</span><span class="nicecode"><span class="decl-fun" id="bar"><span class="kw">fun</span> <a class="pp" href="#bar">bar<span class="pc"><span class="mo">spec<span class="fslash last">/</span></span>bar: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>()
{  
  <span class="kw">val</span> <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
    <span class="st">"list"</span>,
    <span class="st">"elements"</span>,
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">]</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#is_odd">is-odd<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>odd: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>(<span class="number">3</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">3</span>))
  {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#print">print<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>print: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"odd"</span>)
  }
  <span class="kw">else</span>
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#print">print<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>print: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"even"</span>)
</span>}  
</span></pre>



<p class="p noindent">Of course, it is still allowed to use semicolons explicitly which can be used
for example to put multiple statements on a single line:
</p><pre class="koka source"><span class="plaincode">fun equalLine( x : int, y : int ) : io bool {
  print("calculate equality"); (x == y)
}  
</span><span class="nicecode"><span class="decl-fun" id="equalLine"><span class="kw">fun</span> <a class="pp" href="#equalLine">equalLine<span class="pc"><span class="mo">spec<span class="fslash last">/</span></span>equalLine: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp">bool</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#print">print<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>print: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"calculate equality"</span>); (<a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>)
</span>}  
</span></pre>



<p class="p noindent">The layout algorithm also checks for invalid layouts where the layout would
not visually correspond to how the compiler interprets the tokens. In
particular, it is illegal to indent less than the layout context or to put
comments into the indentation (because of tabs or potential unicode
characters). For example, the program:
</p><pre class="koka source unchecked"><span class="plaincode">fun equal( x : int, y : int ) : io bool {   
    print("calculate equality")
  result = if (x == y) then True   // wrong: too little indentation
  /&#42; wrong &#42;/      else False
    result
}  
</span><span class="nicecode"><span class="kw">fun</span> equal( x <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, y <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp">io</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {   
    print(<span class="st">"calculate equality"</span>)
  result <span class="kw">=</span> <span class="kw">if</span> (x <span class="op">==</span> y) <span class="kw">then</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>   <span class="comment">// wrong: too little indentation
</span>  <span class="comment">/&#42; wrong &#42;/</span>      <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>
    result
}  
</span></pre>



<p class="p noindent">is rejected. In order to facilitate code generation or source code
compression, compilers are also required to support a mode where the layout
rule is not applied and where no semicolons are inserted. A recognized command
line flag for that mode should be <code class="code code2">--nosemi</code>.
</p><h3 id="sec-the-layout-algorithm" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-the-layout-algorithm" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.3.1</span>.&#8194;</span>The layout algorithm</h3>
<p class="p noindent">A nice property of the layout
algorithm is that it is performed on the token stream in-between lexing
and parsing, and is independent of both. In particular, there are no intricate dependencies with the parser
that lead to bizarrely complex layout rules, as is the case in languages like
<a href="http://www.haskell.org/onlinereport/haskell2010/haskellch10.html#x17-17800010.3" data-linkid="haskell">Haskell</a> or&nbsp;<a href="https://tc39.github.io/ecma262/#sec-rules-of-automatic-semicolon-insertion" data-linkid="javascript">JavaScript</a>.
</p>
<p class="p indent">To define the layout algorithm formally, we first establish some terminology:
</p>
<ul class="ul list-star compact">
<li class="li ul-li list-star-li compact-li" style="margin-bottom:1ex">A new line is started after every <em class="em-low1">linefeed</em> character.
</li>
<li class="li ul-li list-star-li compact-li" style="margin-bottom:1ex">Any non-<em class="em-low1">white</em> token is called a <em class="em-low1">lexeme</em>, where a line without lexemes
is called <em class="em-low1">blank</em>.
</li>
<li class="li ul-li list-star-li compact-li" style="margin-bottom:1ex">The indentation of a lexeme is the column number of its first character on
that line (starting at 1), and the indentation of a line is the indentation
of the first lexeme on the line.
</li></ul>

<p class="p noindent">Because braces can be nested, we use a <em class="em-low1">layout stack</em> of strictly
increasing indentations. The top indentation on the layout stack holds the
<em class="em-low1">layout indentation</em>. The initial layout stack contains the single
value 0 (which is never popped). We now proceed through the token stream
where we perform the operations on the layout stack before the semicolon insertion:
</p>
<ul class="ul list-star grammar loose">
<li class="li ul-li list-star-li grammar-li loose-li" style="margin-bottom:1ex">
<p><em class="em-low1">Layout stack operations</em>: If the previous lexeme was an
open brace <code class="koka">{</code> or the start of the lexical token sequence, we push the
indentation of the current lexeme on the layout stack. The pushed indentation
must be larger than the previous layout indentation (unless the current lexeme
is a closing brace).  When a closing brace <code class="koka">}</code> is encountered the top
indentation is popped from the layout stack.
</p></li>
<li class="li ul-li list-star-li grammar-li loose-li" style="margin-bottom:1ex">
<p><em class="em-low1">Semicolon insertion</em>: For each non-blank line, the
indentation must be equal or larger to the layout indentation. A semicolon is
inserted before the line whenever the indentation is equal, unless the first
lexeme on the line is one of <code class="koka"><span class="kw">then</span></code>, <code class="koka"><span class="kw">else</span></code>, <code class="koka"><span class="kw">elif</span></code>, or one of <code class="koka">{</code>, <code class="koka">,</code>, <code class="koka">)</code>, or
<code class="koka">]</code>. Also, a semicolon is always inserted before a closing brace <code class="koka">}</code> and
before the end of the token sequence.
</p></li></ul>

<p class="p noindent">As defined, semicolons are inserted whenever statements or declarations are
aligned, unless the lexeme happens to be a clear statement continuation. To
simplify the grammar specification, a semicolon is also always inserted before
a closing brace and the end of the source. This allows us to specify many
grammar elements as ended by semicolons instead of separated by semicolons
which is more difficult to specify for a LALR(1) grammar.
</p>
<p class="p indent">Semicolon insertion can be easily implemented as part of the lexer, but could
also be implemented as a straightforward transformation on the lexical token
stream.
</p><h3 id="sec:lex-implementation" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec:lex-implementation" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.3.2</span>.&#8194;</span>Implementation</h3>
<p class="p noindent">There is a full&nbsp;<a href="https://koka.codeplex.com/SourceControl/latest#doc/spec/grammar/lexer.lex" data-linkid="flexlexer">Flex (Lex) implementation</a> of lexical
analysis and the layout algorithm.
Ultimately, the Flex implementation serves as <em class="em-low1">the</em>
specification, and this document and the Flex implementation should
always be in agreement.
</p><h2 id="sec-context-free-syntax" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-context-free-syntax" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4</span>.&#8194;</span>Context-free syntax</h2>
<p class="p noindent">The grammar specification starts with the non terminal <em class="em-low1">module</em> which draws
its lexical tokens from <em class="em-low1">lex</em> where all <em class="em-low1">whitespace</em> tokens are implicitly
ignored.
</p><h3 id="sec-modules" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-modules" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.1</span>.&#8194;</span>Modules</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">module</em><sub><span class="opt">[ <em class="em-low1">lex</em> ]</span></sub> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <span class="opt">[ <em class="em-low1">moduledecl</em> ]</span> <em class="em-low1">modulebody</em>                 </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> &#160;                  </td><td class="tbody tr-even col col-even" data-row="2" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3">                                                   </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">moduledecl</em>            </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">semis</em>  <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <code class="koka"></code> <em class="em-low1">moduleid</em> </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">moduleid</em>              </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">qvarid</em> <span class="bar">|</span> <em class="em-low1">varid</em>                         </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> &#160;                  </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3">                                                   </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">modulebody</em>            </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka">{</code> <em class="em-low1">semis</em> <em class="em-low1">declarations</em> <code class="koka">}</code> <em class="em-low1">semis</em>            </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">                         </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <em class="em-low1">semis</em> <em class="em-low1">declarations</em>                            </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> &#160;                  </td><td class="tbody tr-even col col-even" data-row="8" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3">                                                   </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> <em class="em-low1">visibility</em>            </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="koka"><span class="kw">public</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">private</span></code>                       </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">semis</em>                 </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <span class="many">{ <code class="koka">;</code> }</span>                                      </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">semi</em>                  </td><td class="tbody tr-odd tr-last col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd tr-last col col-odd" data-row="11" data-col="3"> <code class="koka">;</code> <em class="em-low1">semis</em>                                         </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="11" data-col="4">   </td></tr></tbody></table><h3 id="sec-top-level-declarations" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-top-level-declarations" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.2</span>.&#8194;</span>Top level declarations</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">declarations</em> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <span class="many">{ <em class="em-low1">import</em> }</span> <span class="many">{ <em class="em-low1">fixitydecl</em> }</span> <em class="em-low1">topdecls</em>                                    </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> &#160;         </td><td class="tbody tr-even col col-even" data-row="2" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3">                                                                                       </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">import</em>       </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <code class="koka"><span class="kw">import</span></code> <span class="opt">[ <em class="em-low1">moduleid</em> <code class="koka"><span class="kw">=</span></code> ]</span> <em class="em-low1">moduleid</em> <em class="em-low1">semi</em>                </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> &#160;         </td><td class="tbody tr-even col col-even" data-row="4" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3">                                                                                       </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">fixitydecl</em>   </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <em class="em-low1">fixity</em> <em class="em-low1">natural</em> <em class="em-low1">identifier</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">identifier</em> }</span> <em class="em-low1">semi</em> </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">fixity</em>       </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka"><span class="kw">infixl</span></code>                                                                              </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">                </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka"><span class="kw">infixr</span></code>                                                                              </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">                </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka"><span class="kw">infix</span></code>                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;         </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">topdecls</em>     </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <span class="many">{ <em class="em-low1">topdecl</em> <em class="em-low1">semi</em> }</span>                                                             </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">topdecl</em>      </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <em class="em-low1">puredecl</em>                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1">                </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <em class="em-low1">aliasdecl</em>                                                      </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1">                </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <em class="em-low1">typedecl</em>                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1">                </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <em class="em-low1">externdecl</em>                                                     </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="15" data-col="1">                </td><td class="tbody tr-odd tr-last col col-even" data-row="15" data-col="2"> &#124; </td><td class="tbody tr-odd tr-last col col-odd" data-row="15" data-col="3"> <code class="koka"><span class="kw">abstract</span></code> <em class="em-low1">typedecl</em>                                                                </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="15" data-col="4">   </td></tr></tbody></table><h3 id="sec-type-declarations" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-type-declarations" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.3</span>.&#8194;</span>Type declarations</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">aliasdecl</em>   </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <code class="koka"><span class="tp kw">alias</span></code> <em class="em-low1">typeid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <code class="koka"><span class="kw">=</span></code> <em class="em-low1">type</em>                                          </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">typedecl</em>    </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">typemod</em> <code class="koka"><span class="tp kw">type</span></code> <em class="em-low1">typeid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <span class="opt">[ <em class="em-low1">typebody</em> ]</span>                         </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">structmod</em> <code class="koka"><span class="tp kw">struct</span></code> <em class="em-low1">typeid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <span class="opt">[ <em class="em-low1">conparams</em> ]</span>                    </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">effectmod</em> <code class="koka"><span class="tp kw">effect</span></code> <em class="em-low1">typeid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <span class="opt">[ <em class="em-low1">opdecls</em> ]</span>                      </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">effectmod</em> <code class="koka"><span class="tp kw">effect</span></code> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <em class="em-low1">opdecl</em>                                        </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka"><span class="kw">named</span></code> <em class="em-low1">effectmod</em> <code class="koka"><span class="tp kw">effect</span></code> <em class="em-low1">typeid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <span class="opt">[ <em class="em-low1">opdecls</em> ]</span>              </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka"><span class="kw">named</span></code> <em class="em-low1">effectmod</em> <code class="koka"><span class="tp kw">effect</span></code> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <em class="em-low1">opdecl</em>                                </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka"><span class="kw">named</span></code> <em class="em-low1">effectmod</em> <code class="koka"><span class="tp kw">effect</span></code> <em class="em-low1">varid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <code class="koka"><span class="kw">in</span></code> <em class="em-low1">type</em> <span class="opt">[ <em class="em-low1">opdecls</em> ]</span>   </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;        </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                                                                                            </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">typemod</em>     </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <code class="koka">co</code> <span class="bar">|</span> <code class="koka">rec</code> <span class="bar">|</span> <code class="koka">open</code> <span class="bar">|</span> <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#extend">extend<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>extend: <span class="tp sp">(</span><span class="tp tpp">slice</span> <span class="tp kw op">:</span> <span class="tp">sslice</span><span class="tp sp">,</span> <span class="tp tpp">count</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">sslice</span></span></a></code> <span class="bar">|</span> <em class="em-low1">structmod</em>                                 </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">structmod</em>   </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="koka">value</code> <span class="bar">|</span> <code class="koka">reference</code>                                                                               </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> <em class="em-low1">effectmod</em>   </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <span class="opt">[ <code class="koka">linear</code> ]</span> <span class="opt">[ <code class="koka">rec</code> ]</span>                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> &#160;        </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3">                                                                                                            </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">typeid</em>      </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">varid</em>                                                                                                    </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3"> <code class="code code2">[]</code>                                                                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="16" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3"> <code class="koka">(</code> <span class="many">{ <code class="koka">,</code> }</span> <code class="koka">)</code>                                                                                       </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="17" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="17" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="17" data-col="3"> <code class="koka"><span class="op">&#60;</span></code> <code class="koka"><span class="op">&#62;</span></code>                                                                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="17" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="18" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="18" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="18" data-col="3"> <code class="koka"><span class="op">&#60;</span></code> <span class="koka code">&#124;</span> <code class="koka"><span class="op">&#62;</span></code>                                                                              </td><td class="tbody tr-even col col-even col-last" data-row="18" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="19" data-col="1"> &#160;        </td><td class="tbody tr-odd col col-even" data-row="19" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="19" data-col="3">                                                                                                            </td><td class="tbody tr-odd col col-even col-last" data-row="19" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="20" data-col="1"> <em class="em-low1">typeparams</em>  </td><td class="tbody tr-even col col-even" data-row="20" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="20" data-col="3"> <code class="koka"><span class="op">&#60;</span></code> <span class="opt">[ <em class="em-low1">tbinders</em> ]</span> <code class="koka"><span class="op">&#62;</span></code>                                                                                 </td><td class="tbody tr-even col col-even col-last" data-row="20" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="21" data-col="1"> <em class="em-low1">tbinders</em>    </td><td class="tbody tr-odd col col-even" data-row="21" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="21" data-col="3"> <em class="em-low1">tbinder</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">tbinder</em> }</span>                                                                           </td><td class="tbody tr-odd col col-even col-last" data-row="21" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="22" data-col="1"> <em class="em-low1">tbinder</em>     </td><td class="tbody tr-even col col-even" data-row="22" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="22" data-col="3"> <em class="em-low1">varid</em> <span class="opt">[ <em class="em-low1">kannot</em> ]</span>                                                                                   </td><td class="tbody tr-even col col-even col-last" data-row="22" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="23" data-col="1"> <em class="em-low1">typebody</em>    </td><td class="tbody tr-odd col col-even" data-row="23" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="23" data-col="3"> <code class="koka">{</code> <em class="em-low1">semis</em> <span class="many">{ <em class="em-low1">constructor</em> <em class="em-low1">semi</em> }</span> <code class="koka">}</code>                                                              </td><td class="tbody tr-odd col col-even col-last" data-row="23" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="24" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="24" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="24" data-col="3">                                                                                                            </td><td class="tbody tr-even col col-even col-last" data-row="24" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="25" data-col="1"> <em class="em-low1">constructor</em> </td><td class="tbody tr-odd col col-even" data-row="25" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="25" data-col="3"> <span class="opt">[ <code class="koka"><span class="kw">con</span></code> ]</span> <em class="em-low1">conid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">conparams</em> ]</span>                                             </td><td class="tbody tr-odd col col-even col-last" data-row="25" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="26" data-col="1"> <em class="em-low1">conparams</em>   </td><td class="tbody tr-even col col-even" data-row="26" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="26" data-col="3"> <code class="koka">{</code> <em class="em-low1">semis</em> <span class="many">{ <em class="em-low1">conparam</em> <em class="em-low1">semi</em> }</span> <code class="koka">}</code>                                                                 </td><td class="tbody tr-even col col-even col-last" data-row="26" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="27" data-col="1"> <em class="em-low1">conparam</em>    </td><td class="tbody tr-odd col col-even" data-row="27" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="27" data-col="3"> (<em class="em-low1">paramid</em> <span class="bar">|</span> <em class="em-low1">wildcard</em>) <code class="code code2">:</code> <em class="em-low1">paramtype</em> <span class="opt">[ <code class="koka"><span class="kw">=</span></code> <em class="em-low1">expr</em> ]</span>                                       </td><td class="tbody tr-odd col col-even col-last" data-row="27" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="28" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="28" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="28" data-col="3">                                                                                                            </td><td class="tbody tr-even col col-even col-last" data-row="28" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="29" data-col="1"> <em class="em-low1">opdecls</em>     </td><td class="tbody tr-odd col col-even" data-row="29" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="29" data-col="3"> <code class="koka">{</code> <em class="em-low1">semis</em> <span class="many">{ <em class="em-low1">opdecl</em> <em class="em-low1">semi</em> }</span> <code class="koka">}</code>                                                                   </td><td class="tbody tr-odd col col-even col-last" data-row="29" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="30" data-col="1"> <em class="em-low1">opdecl</em>      </td><td class="tbody tr-even col col-even" data-row="30" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="30" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <code class="koka"><span class="kw">val</span></code> <em class="em-low1">identifier</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span>  <code class="code code2">:</code> <em class="em-low1">tatom</em>                                </td><td class="tbody tr-even col col-even col-last" data-row="30" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="31" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="31" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="31" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> (<code class="koka"><span class="kw">fun</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">control</span></code>) <em class="em-low1">identifier</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <em class="em-low1">opparams</em> <code class="code code2">:</code> <em class="em-low1">tatom</em> </td><td class="tbody tr-odd col col-even col-last" data-row="31" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="32" data-col="1"> <em class="em-low1">opparams</em>    </td><td class="tbody tr-even col col-even" data-row="32" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="32" data-col="3"> <code class="koka">(</code> <span class="opt">[ <em class="em-low1">opparam</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">opparam</em> }</span> ]</span> <code class="koka">)</code>                                                           </td><td class="tbody tr-even col col-even col-last" data-row="32" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="33" data-col="1"> <em class="em-low1">opparam</em>     </td><td class="tbody tr-odd tr-last col col-even" data-row="33" data-col="2"> ::=   </td><td class="tbody tr-odd tr-last col col-odd" data-row="33" data-col="3"> <span class="opt">[ <em class="em-low1">paramid</em> ]</span> <code class="code code2">:</code> <em class="em-low1">paramtype</em>                                                                        </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="33" data-col="4">    </td></tr></tbody></table><h3 id="sec-value-and-function-declarations" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-value-and-function-declarations" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.4</span>.&#8194;</span>Value and function declarations</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">puredecl</em>     </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">inlinemod</em> <code class="koka"><span class="kw">val</span></code> <em class="em-low1">valdecl</em>                                                   </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">                </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">inlinemod</em> <code class="koka"><span class="kw">fun</span></code> <em class="em-low1">fundecl</em>                                                   </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">inlinemod</em>    </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <code class="koka">inline</code> <span class="bar">|</span> <code class="koka">noinline</code>                                                  </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> &#160;         </td><td class="tbody tr-even col col-even" data-row="4" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3">                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">valdecl</em>      </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">binder</em> <code class="koka"><span class="kw">=</span></code> <em class="em-low1">expr</em>                                                           </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">binder</em>       </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">identifier</em> <span class="opt">[ <code class="code code2">:</code> <em class="em-low1">type</em> ]</span>                                             </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> &#160;         </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3">                                                                               </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">fundecl</em>      </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">funid</em> <em class="em-low1">funparam</em> <em class="em-low1">bodyexpr</em>                                                 </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> <em class="em-low1">funparam</em>     </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <em class="em-low1">parameters</em> <span class="opt">[ <code class="code code2">:</code> <em class="em-low1">tresult</em> ]</span> <span class="opt">[ <em class="em-low1">qualifier</em> ]</span> </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">funid</em>        </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <em class="em-low1">identifier</em>                                                                  </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1">                </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="code code2">[</code> <span class="many">{ <code class="koka">,</code> }</span> <code class="code code2">]</code>                                                      </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4"> (indexing operator)  </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> &#160;         </td><td class="tbody tr-even col col-even" data-row="12" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3">                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">parameters</em>   </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <code class="koka">(</code> <span class="opt">[ <em class="em-low1">parameter</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">parameter</em> }</span> ]</span> <code class="koka">)</code>                          </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">parameter</em>    </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">paramid</em> <span class="opt">[ <code class="code code2">:</code> <em class="em-low1">paramtype</em> ]</span> <span class="opt">[ <code class="koka"><span class="kw">=</span></code> <em class="em-low1">expr</em> ]</span>                        </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1"> <em class="em-low1">paramid</em>      </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3"> <em class="em-low1">identifier</em> <span class="bar">|</span> <em class="em-low1">wildcard</em>                                              </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1"> <em class="em-low1">paramtype</em>    </td><td class="tbody tr-even col col-even" data-row="16" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3"> <em class="em-low1">type</em>                                                                        </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="17" data-col="1">                </td><td class="tbody tr-odd col col-even" data-row="17" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="17" data-col="3"> <code class="koka"><span class="op">?</span></code> <em class="em-low1">type</em>                                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="17" data-col="4"> (optional parameter) </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="18" data-col="1"> &#160;         </td><td class="tbody tr-even col col-even" data-row="18" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="18" data-col="3">                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="18" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="19" data-col="1"> <em class="em-low1">qidentifier</em>  </td><td class="tbody tr-odd col col-even" data-row="19" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="19" data-col="3"> <em class="em-low1">qvarid</em> <span class="bar">|</span> <em class="em-low1">qidop</em> <span class="bar">|</span> <em class="em-low1">identifier</em>                               </td><td class="tbody tr-odd col col-even col-last" data-row="19" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="20" data-col="1"> <em class="em-low1">identifier</em>   </td><td class="tbody tr-even col col-even" data-row="20" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="20" data-col="3"> <em class="em-low1">varid</em> <span class="bar">|</span> <em class="em-low1">idop</em>                                                       </td><td class="tbody tr-even col col-even col-last" data-row="20" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="21" data-col="1"> &#160;         </td><td class="tbody tr-odd col col-even" data-row="21" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="21" data-col="3">                                                                               </td><td class="tbody tr-odd col col-even col-last" data-row="21" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="22" data-col="1"> <em class="em-low1">qoperator</em>    </td><td class="tbody tr-even col col-even" data-row="22" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="22" data-col="3"> <em class="em-low1">op</em>                                                                          </td><td class="tbody tr-even col col-even col-last" data-row="22" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="23" data-col="1"> &#160;         </td><td class="tbody tr-odd col col-even" data-row="23" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="23" data-col="3">                                                                               </td><td class="tbody tr-odd col col-even col-last" data-row="23" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="24" data-col="1"> <em class="em-low1">qconstructor</em> </td><td class="tbody tr-even tr-last col col-even" data-row="24" data-col="2"> ::=   </td><td class="tbody tr-even tr-last col col-odd" data-row="24" data-col="3"> <em class="em-low1">conid</em> <span class="bar">|</span> <em class="em-low1">qconid</em>                                                     </td><td class="tbody tr-even tr-last col col-even col-last" data-row="24" data-col="4">                      </td></tr></tbody></table><h3 id="sec-statements" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-statements" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.5</span>.&#8194;</span>Statements</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">block</em>     </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <code class="code code2">{</code> <em class="em-low1">semis</em> <span class="many">{ <em class="em-low1">statement</em> <em class="em-low1">semi</em> }</span> <code class="code code2">}</code> </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> &#160;      </td><td class="tbody tr-even col col-even" data-row="2" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3">                                                 </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">statement</em> </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">decl</em>                                          </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">withstat</em>                                      </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">returnexpr</em>                                    </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">basicexpr</em>                                     </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> &#160;      </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3">                                                 </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">decl</em>      </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka"><span class="kw">fun</span></code> <em class="em-low1">fundecl</em>                                 </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="koka"><span class="kw">val</span></code> <em class="em-low1">apattern</em> <code class="koka"><span class="kw">=</span></code> <em class="em-low1">valexpr</em>                  </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4"> (local values can use a pattern binding) </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="10" data-col="1">             </td><td class="tbody tr-even tr-last col col-even" data-row="10" data-col="2"> &#124; </td><td class="tbody tr-even tr-last col col-odd" data-row="10" data-col="3"> <code class="koka"><span class="kw">var</span></code> <em class="em-low1">binder</em> <code class="code code2">:=</code> <em class="em-low1">valexpr</em>                 </td><td class="tbody tr-even tr-last col col-even col-last" data-row="10" data-col="4">                                          </td></tr></tbody></table><h3 id="sec-expressions" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-expressions" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.6</span>.&#8194;</span>Expressions</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">bodyexpr</em>    </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <code class="koka"><span class="kw op">-&gt;</span></code> <em class="em-low1">blockexpr</em>                                                            </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">block</em>                                                                     </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> &#160;        </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                                                             </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">blockexpr</em>   </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">expr</em>                                                                      </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4"> (<em class="em-low1">block</em> is interpreted as statements) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> &#160;        </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3">                                                                             </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">expr</em>        </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">withexpr</em>                                                                  </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <em class="em-low1">block</em>                                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4"> (interpreted as <code class="koka"><span class="kw">fn</span>(){<span class="op">...</span>}</code>)           </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="8" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">returnexpr</em>                                                                </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <em class="em-low1">basicexpr</em>                                                                 </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="10" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3">                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">basicexpr</em>   </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <em class="em-low1">ifexpr</em>                                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <em class="em-low1">fnexpr</em>                                                                    </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <em class="em-low1">matchexpr</em>                                                                 </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">handlerexpr</em>                                                               </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3"> <em class="em-low1">opexpr</em>                                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="16" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3">                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="17" data-col="1"> <em class="em-low1">ifexpr</em>      </td><td class="tbody tr-odd col col-even" data-row="17" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="17" data-col="3"> <code class="koka"><span class="kw">if</span></code> <em class="em-low1">atom</em> <em class="em-low1">then</em> <span class="many">{ <em class="em-low1">elif</em> }</span> <span class="opt">[ <code class="koka"><span class="kw">else</span></code> <em class="em-low1">expr</em><sub>&#60;!<em class="em-low1">ifexpr</em>&#62;</sub> ]</span> </td><td class="tbody tr-odd col col-even col-last" data-row="17" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="18" data-col="1"> <em class="em-low1">then</em>        </td><td class="tbody tr-even col col-even" data-row="18" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="18" data-col="3"> <span class="opt">[ <code class="koka"><span class="kw">then</span></code> ]</span> <em class="em-low1">expr</em><sub>&#60;!<em class="em-low1">ifexpr</em>&#62;</sub>                                    </td><td class="tbody tr-even col col-even col-last" data-row="18" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="19" data-col="1"> <em class="em-low1">elif</em>        </td><td class="tbody tr-odd col col-even" data-row="19" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="19" data-col="3"> <code class="koka"><span class="kw">elif</span></code> <em class="em-low1">atom</em> <em class="em-low1">then</em>                                                        </td><td class="tbody tr-odd col col-even col-last" data-row="19" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="20" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="20" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="20" data-col="3">                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="20" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="21" data-col="1"> <em class="em-low1">matchexpr</em>   </td><td class="tbody tr-odd col col-even" data-row="21" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="21" data-col="3"> <code class="koka"><span class="kw">match</span></code> <em class="em-low1">atom</em> <code class="koka">{</code> <em class="em-low1">semis</em> <span class="many">{ <em class="em-low1">matchrule</em> <em class="em-low1">semi</em> }</span> <code class="koka">}</code>                  </td><td class="tbody tr-odd col col-even col-last" data-row="21" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="22" data-col="1"> <em class="em-low1">returnexpr</em>  </td><td class="tbody tr-even col col-even" data-row="22" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="22" data-col="3"> <code class="koka"><span class="kw">return</span></code> <em class="em-low1">opexpr</em>                                                           </td><td class="tbody tr-even col col-even col-last" data-row="22" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="23" data-col="1"> <em class="em-low1">fnexpr</em>      </td><td class="tbody tr-odd col col-even" data-row="23" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="23" data-col="3"> <code class="koka"><span class="kw">fn</span></code> <em class="em-low1">funparam</em> <em class="em-low1">block</em>                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="23" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="24" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="24" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="24" data-col="3">                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="24" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="25" data-col="1"> <em class="em-low1">handlerexpr</em> </td><td class="tbody tr-odd col col-even" data-row="25" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="25" data-col="3"> <code class="koka"><span class="kw">handler</span></code> <span class="opt">[ <code class="koka"><span class="kw">override</span></code> ]</span> <em class="em-low1">heff</em>  <em class="em-low1">opclauses</em>                            </td><td class="tbody tr-odd col col-even col-last" data-row="25" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="26" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="26" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="26" data-col="3"> <code class="koka"><span class="kw">handle</span></code> <span class="opt">[ <code class="koka"><span class="kw">override</span></code> ]</span> <em class="em-low1">heff</em> <code class="koka">(</code> <em class="em-low1">expr</em> <code class="koka">)</code> <em class="em-low1">opclauses</em>               </td><td class="tbody tr-even col col-even col-last" data-row="26" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="27" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="27" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="27" data-col="3"> <code class="koka"><span class="kw">named</span></code> <code class="koka"><span class="kw">handler</span></code> <em class="em-low1">heff</em>  <em class="em-low1">opclauses</em>                                       </td><td class="tbody tr-odd col col-even col-last" data-row="27" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="28" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="28" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="28" data-col="3"> <code class="koka"><span class="kw">named</span></code> <code class="koka"><span class="kw">handle</span></code> <em class="em-low1">heff</em> <code class="koka">(</code> <em class="em-low1">expr</em> <code class="koka">)</code> <em class="em-low1">opclauses</em>                          </td><td class="tbody tr-even col col-even col-last" data-row="28" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="29" data-col="1"> <em class="em-low1">heff</em>        </td><td class="tbody tr-odd col col-even" data-row="29" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="29" data-col="3"> <span class="opt">[ <code class="koka"><span class="op">&#60;</span></code> <em class="em-low1">tbasic</em> <code class="koka"><span class="op">&#62;</span></code> ]</span>                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="29" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="30" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="30" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="30" data-col="3">                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="30" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="31" data-col="1"> <em class="em-low1">withexpr</em>    </td><td class="tbody tr-odd col col-even" data-row="31" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="31" data-col="3"> <em class="em-low1">withstat</em> <code class="koka"><span class="kw">in</span></code> <em class="em-low1">expr</em>                                                      </td><td class="tbody tr-odd col col-even col-last" data-row="31" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="32" data-col="1"> <em class="em-low1">withstat</em>    </td><td class="tbody tr-even col col-even" data-row="32" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="32" data-col="3"> <code class="koka"><span class="kw">with</span></code> <em class="em-low1">basicexpr</em>                                                          </td><td class="tbody tr-even col col-even col-last" data-row="32" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="33" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="33" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="33" data-col="3"> <code class="koka"><span class="kw">with</span></code> <em class="em-low1">binder</em> <code class="koka"><span class="kw">=</span></code> <em class="em-low1">basicexpr</em>                                             </td><td class="tbody tr-odd col col-even col-last" data-row="33" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="34" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="34" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="34" data-col="3"> <code class="koka"><span class="kw">with</span></code> <span class="opt">[ <code class="koka"><span class="kw">override</span></code> ]</span> <em class="em-low1">heff</em>  <em class="em-low1">opclauses</em>                               </td><td class="tbody tr-even col col-even col-last" data-row="34" data-col="4"> (with a handler)                       </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="35" data-col="1">               </td><td class="tbody tr-odd tr-last col col-even" data-row="35" data-col="2">       </td><td class="tbody tr-odd tr-last col col-odd" data-row="35" data-col="3"> <code class="koka"><span class="kw">with</span></code> <em class="em-low1">binder</em> <code class="koka"><span class="kw">=</span></code> <em class="em-low1">heff</em>  <em class="em-low1">opclauses</em>                                     </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="35" data-col="4"> (with a named andler)                  </td></tr></tbody></table><h3 id="sec-operator-expressions" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-operator-expressions" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.7</span>.&#8194;</span>Operator expressions</h3>
<p class="p noindent">For simplicity, we parse all operators as if they are left associative with
the same precedence. We assume that a separate pass in the compiler will use
the fixity declarations that are in scope to properly associate all operators
in an expressions.
</p><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">opexpr</em>     </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">prefix</em> <span class="many">{ <em class="em-low1">qoperator</em> <em class="em-low1">prefixexpr</em> }</span>   </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">prefixexpr</em> </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <span class="many">{ <code class="code code2">!</code> <span class="bar">|</span> <code class="code code2">~</code> }</span> <em class="em-low1">appexpr</em>      </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                              </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">appexpr</em>    </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">appexpr</em> <code class="koka">(</code> <span class="opt">[ <em class="em-low1">arguments</em> ]</span> <code class="koka">)</code>        </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4"> (regular application)        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">appexpr</em> <code class="koka">[</code> <span class="opt">[ <em class="em-low1">arguments</em> ]</span> <code class="koka">]</code>        </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4"> (index operation)            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">appexpr</em> <span class="bar">|<em class="em-low1">fnexpr</em> [</span> <em class="em-low1">block</em>) </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4"> (apply function expressions) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <em class="em-low1">appexpr</em> <code class="koka"><span class="kw op">.</span></code> <em class="em-low1">atom</em>                         </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">atom</em>                                       </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                              </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">arguments</em>  </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <em class="em-low1">argument</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">argument</em> }</span>           </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">                              </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">argument</em>   </td><td class="tbody tr-odd tr-last col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd tr-last col col-odd" data-row="11" data-col="3"> <span class="opt">[ <em class="em-low1">identifier</em> <code class="koka"><span class="kw">=</span></code> ]</span> <em class="em-low1">expr</em>              </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="11" data-col="4">                              </td></tr></tbody></table><h3 id="sec-atomic-expressions" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-atomic-expressions" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.8</span>.&#8194;</span>Atomic expressions</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">atom</em>     </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">qidentifier</em>                                                  </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">qconstructor</em>                                                 </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                            </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">literal</em>                                                      </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">mask</em>                                                         </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                            </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <code class="koka">(</code> <code class="koka">)</code>                                                        </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4"> (unit)                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka">(</code> <em class="em-low1">annexpr</em> <code class="koka">)</code>                                              </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4"> (parenthesized expression) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka">(</code> <em class="em-low1">annexprs</em> <code class="koka">)</code>                                             </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4"> (tuple expression)         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka">[</code> <span class="opt">[ <em class="em-low1">annexpr</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">annexprs</em> }</span> <span class="opt">[ <code class="koka">,</code> ]</span>  ]</span> <code class="koka">]</code> </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4"> (list expression)          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;     </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">                            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">literal</em>  </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <em class="em-low1">natural</em> <span class="bar">|</span> <em class="em-low1">float</em> <span class="bar">|</span> <em class="em-low1">char</em> <span class="bar">|</span> <em class="em-low1">string</em>   </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">                            </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">mask</em>     </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="koka"><span class="kw">mask</span></code> <span class="opt">[ <code class="koka">behind</code> ]</span> <code class="koka"><span class="op">&#60;</span></code> <em class="em-low1">tbasic</em> <code class="koka"><span class="op">&#62;</span></code>                       </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">                            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> &#160;     </td><td class="tbody tr-even col col-even" data-row="12" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3">                                                                </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">                            </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">annexprs</em> </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <em class="em-low1">annexpr</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">annexpr</em> }</span>                               </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">                            </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">annexpr</em>  </td><td class="tbody tr-even tr-last col col-even" data-row="14" data-col="2"> ::=   </td><td class="tbody tr-even tr-last col col-odd" data-row="14" data-col="3"> <em class="em-low1">expr</em> <span class="opt">[ <code class="code code2">:</code> <em class="em-low1">typescheme</em> ]</span>                              </td><td class="tbody tr-even tr-last col col-even col-last" data-row="14" data-col="4">                            </td></tr></tbody></table><h3 id="sec-matching" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-matching" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.9</span>.&#8194;</span>Matching</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">matchrule</em> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">patterns</em> <code class="code code2"><span class="code-escaped">&#124;</span></code> <em class="em-low1">expr</em> <code class="koka"><span class="kw op">-&gt;</span></code> <em class="em-low1">blockexpr</em> </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">patterns</em> <em class="em-low1">bodyexpr</em>                                    </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> &#160;      </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                                          </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">apattern</em>  </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">pattern</em> <span class="opt">[ <code class="koka"></code> <em class="em-low1">typescheme</em> ]</span>                       </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">pattern</em>   </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">identifier</em>                                             </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">wildcard</em>                                               </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <em class="em-low1">qconstructor</em> [<code class="koka">(</code> <span class="opt">[ <em class="em-low1">patargs</em> ]</span> <code class="koka">)</code>]          </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka">(</code> <span class="opt">[ <em class="em-low1">apatterns</em> ]</span> <code class="koka">)</code>                              </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4"> (unit, parenthesized pattern, tuple pattern) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="koka">[</code> <span class="opt">[ <em class="em-low1">apatterns</em> ]</span> <code class="koka">]</code>                              </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4"> (list pattern)                               </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <em class="em-low1">apattern</em> <code class="koka"><span class="kw">as</span></code> <em class="em-low1">identifier</em>                             </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4"> (named pattern)                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <em class="em-low1">literal</em>                                                </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> &#160;      </td><td class="tbody tr-even col col-even" data-row="12" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3">                                                          </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">patterns</em>  </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <em class="em-low1">pattern</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">pattern</em> }</span>                         </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">apatterns</em> </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">apattern</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">apattern</em> }</span>                       </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1"> <em class="em-low1">patargs</em>   </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3"> <em class="em-low1">patarg</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">patarg</em> }</span>                           </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="16" data-col="1"> <em class="em-low1">patarg</em>    </td><td class="tbody tr-even tr-last col col-even" data-row="16" data-col="2"> ::=   </td><td class="tbody tr-even tr-last col col-odd" data-row="16" data-col="3"> <span class="opt">[ <em class="em-low1">identifier</em> <code class="koka"><span class="kw">=</span></code> ]</span> <em class="em-low1">apattern</em>                      </td><td class="tbody tr-even tr-last col col-even col-last" data-row="16" data-col="4"> (possibly named parameter)                   </td></tr></tbody></table><h3 id="sec-operation-clauses" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-operation-clauses" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.10</span>.&#8194;</span>Operation Clauses</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">opclauses</em> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <code class="koka">{</code> <em class="em-low1">semis</em> <span class="many">{ <em class="em-low1">opclause</em> <em class="em-low1">semi</em> }</span> <code class="koka">}</code>                       </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">opclause</em> <em class="em-low1">semi</em>                                                </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                                                  </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">opclause</em>  </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <code class="koka"><span class="kw">val</span></code> <em class="em-low1">qidentifier</em> <span class="opt">[ <code class="koka"></code> <em class="em-low1">type</em> ]</span> <code class="koka"><span class="kw">=</span></code> <em class="em-low1">expr</em>                </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <code class="koka"><span class="kw">fun</span></code> <em class="em-low1">qidentifier</em> <em class="em-low1">opargs</em> <em class="em-low1">bodyexpr</em>                          </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka"><span class="kw">control</span></code> <em class="em-low1">qidentifier</em> <em class="em-low1">opargs</em> <em class="em-low1">bodyexpr</em>                      </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka"><span class="kw">rcontrol</span></code> <em class="em-low1">qidentifier</em> <em class="em-low1">opargs</em> <em class="em-low1">bodyexpr</em>                     </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka"><span class="kw">return</span></code>  (<code class="koka">(</code> <em class="em-low1">oparg</em> <code class="koka">)</code> <span class="bar">|</span> <em class="em-low1">paramid</em>) <em class="em-low1">bodyexpr</em> <em class="em-low1">semi</em> </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;      </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                                                  </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">opargs</em>    </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <code class="koka">(</code> <span class="opt">[ <em class="em-low1">oparg</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">oparg</em> }</span> ]</span> <code class="koka">)</code>                     </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">oparg</em>     </td><td class="tbody tr-odd tr-last col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd tr-last col col-odd" data-row="11" data-col="3"> <em class="em-low1">paramid</em> <span class="opt">[ <code class="code code2">:</code> <em class="em-low1">type</em> ]</span>                                   </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="11" data-col="4">    </td></tr></tbody></table><h3 id="sec-type-schemes" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-type-schemes" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.11</span>.&#8194;</span>Type schemes</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">typescheme</em> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::= </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">somes</em> <em class="em-low1">foralls</em> <em class="em-low1">tarrow</em> <span class="opt">[ <em class="em-low1">qualifier</em> ]</span> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="4">             </td><td class="tbody tr-odd tr-first col col-odd col-last" data-row="1" data-col="5">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">type</em>       </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::= </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">foralls</em> <em class="em-low1">tarrow</em> <span class="opt">[ <em class="em-low1">qualifier</em> ]</span>         </td><td class="tbody tr-even col col-even" data-row="2" data-col="4">             </td><td class="tbody tr-even col col-odd col-last" data-row="2" data-col="5">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">     </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                                </td><td class="tbody tr-odd col col-even" data-row="3" data-col="4">             </td><td class="tbody tr-odd col col-odd col-last" data-row="3" data-col="5">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">foralls</em>    </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::= </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <span class="opt">[ <code class="koka"><span class="kw">forall</span></code> <em class="em-low1">typeparams</em> ]</span>                  </td><td class="tbody tr-even col col-even" data-row="4" data-col="4">             </td><td class="tbody tr-even col col-odd col-last" data-row="4" data-col="5">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">some</em>       </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::= </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <span class="opt">[ <code class="koka"><span class="kw">some</span></code> <em class="em-low1">typeparams</em> ]</span>                    </td><td class="tbody tr-odd col col-even" data-row="5" data-col="4">             </td><td class="tbody tr-odd col col-odd col-last" data-row="5" data-col="5">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="6" data-col="2">     </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3">                                                </td><td class="tbody tr-even col col-even" data-row="6" data-col="4">             </td><td class="tbody tr-even col col-odd col-last" data-row="6" data-col="5">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">qualifier</em>  </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::= </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka"><span class="kw">with</span></code> <code class="koka">(</code> <em class="em-low1">predicates</em> <code class="koka">)</code>                    </td><td class="tbody tr-odd col col-even" data-row="7" data-col="4">             </td><td class="tbody tr-odd col col-odd col-last" data-row="7" data-col="5">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="8" data-col="2">     </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3">                                                </td><td class="tbody tr-even col col-even" data-row="8" data-col="4">             </td><td class="tbody tr-even col col-odd col-last" data-row="8" data-col="5">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> <em class="em-low1">predicates</em> </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> ::= </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <em class="em-low1">predicate</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">predicate</em> }</span>           </td><td class="tbody tr-odd col col-even" data-row="9" data-col="4">             </td><td class="tbody tr-odd col col-odd col-last" data-row="9" data-col="5">   </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">predicate</em>  </td><td class="tbody tr-even tr-last col col-even" data-row="10" data-col="2"> ::= </td><td class="tbody tr-even tr-last col col-odd" data-row="10" data-col="3"> <em class="em-low1">typeapp</em>                                      </td><td class="tbody tr-even tr-last col col-even" data-row="10" data-col="4"> (interface) </td><td class="tbody tr-even tr-last col col-odd col-last" data-row="10" data-col="5">   </td></tr></tbody></table><h3 id="sec-types" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-types" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.12</span>.&#8194;</span>Types</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">tarrow</em>  </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=    </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">tatom</em> <span class="opt">[ <code class="koka"><span class="kw op">-&gt;</span></code> <em class="em-low1">tresult</em> ]</span>                                                 </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">tresult</em> </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">tatom</em> <span class="opt">[ <em class="em-low1">tbasic</em> ]</span>                                                       </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> &#160;    </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">tatom</em>   </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">tbasic</em>                                                                       </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">           </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <code class="koka"><span class="op">&#60;</span></code> <em class="em-low1">anntype</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">anntype</em> }</span> <span class="opt">[ <code class="code code2"><span class="code-escaped">&#124;</span></code> <em class="em-low1">tatom</em> ]</span> <code class="koka"><span class="op">&#62;</span></code> </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">           </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka"><span class="op">&#60;</span></code> <code class="koka"><span class="op">&#62;</span></code>                                                                        </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> &#160;    </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3">                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">tbasic</em>  </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">typeapp</em>                                                                      </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1">           </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="koka">(</code> <code class="koka">)</code>                                                                        </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4"> (unit type)                            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1">           </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <code class="koka">(</code> <em class="em-low1">tparam</em> <code class="koka">)</code>                                                               </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4"> (parenthesized type or type parameter) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1">           </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="koka">(</code> <em class="em-low1">tparam</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">tparam</em> }</span> <code class="koka">)</code>                                         </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4"> (tuple type or parameters)             </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1">           </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <code class="koka">[</code> <em class="em-low1">anntype</em> <code class="koka">]</code>                                                              </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4"> (list type)                            </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> &#160;    </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3">                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">typeapp</em> </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">typecon</em> <span class="opt">[ <code class="koka"><span class="op">&#60;</span></code> <em class="em-low1">anntype</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">anntype</em> }</span> <code class="koka"><span class="op">&#62;</span></code> ]</span>                     </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1"> &#160;    </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3">                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1"> <em class="em-low1">typecon</em> </td><td class="tbody tr-even col col-even" data-row="16" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3"> <em class="em-low1">varid</em> <span class="bar">|</span> <em class="em-low1">qvarid</em>                                                      </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="17" data-col="1">           </td><td class="tbody tr-odd col col-even" data-row="17" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="17" data-col="3"> <em class="em-low1">wildcard</em>                                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="17" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="18" data-col="1">           </td><td class="tbody tr-even col col-even" data-row="18" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="18" data-col="3"> <code class="koka">(</code> <code class="koka">,</code> <span class="many">{ <code class="koka">,</code> }</span> <code class="koka">)</code>                                                       </td><td class="tbody tr-even col col-even col-last" data-row="18" data-col="4"> (tuple constructor)                    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="19" data-col="1">           </td><td class="tbody tr-odd col col-even" data-row="19" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="19" data-col="3"> <code class="koka">[</code> <code class="koka">]</code>                                                                        </td><td class="tbody tr-odd col col-even col-last" data-row="19" data-col="4"> (list constructor)                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="20" data-col="1">           </td><td class="tbody tr-even col col-even" data-row="20" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="20" data-col="3"> <code class="koka">(</code> <code class="koka"><span class="kw op">-&gt;</span></code> <code class="koka">)</code>                                                                   </td><td class="tbody tr-even col col-even col-last" data-row="20" data-col="4"> (function constructor)                 </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="21" data-col="1"> &#160;    </td><td class="tbody tr-odd col col-even" data-row="21" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="21" data-col="3">                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="21" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="22" data-col="1"> <em class="em-low1">tparam</em>  </td><td class="tbody tr-even col col-even" data-row="22" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="22" data-col="3"> <span class="opt">[ <em class="em-low1">varid</em> <code class="code code2">:</code> ]</span> <em class="em-low1">anntype</em>                                                  </td><td class="tbody tr-even col col-even col-last" data-row="22" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="23" data-col="1"> <em class="em-low1">anntype</em> </td><td class="tbody tr-odd tr-last col col-even" data-row="23" data-col="2"> ::=    </td><td class="tbody tr-odd tr-last col col-odd" data-row="23" data-col="3"> <em class="em-low1">type</em> <span class="opt">[ <em class="em-low1">kannot</em> ]</span>                                                        </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="23" data-col="4">                                        </td></tr></tbody></table><h3 id="sec-kinds" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-kinds" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.13</span>.&#8194;</span>Kinds</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">kannot</em> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <code class="code code2">::</code> <em class="em-low1">kind</em>                                  </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> &#160;   </td><td class="tbody tr-even col col-even" data-row="2" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3">                                                </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">kind</em>   </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <code class="koka">(</code> <em class="em-low1">kind</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">kind</em> }</span> <code class="koka">)</code> <code class="koka"><span class="kw op">-&gt;</span></code> <em class="em-low1">kind</em> </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1">          </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">katom</em> <code class="koka"><span class="kw op">-&gt;</span></code> <em class="em-low1">kind</em>                            </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">          </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">katom</em>                                        </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> &#160;   </td><td class="tbody tr-even col col-even" data-row="6" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3">                                                </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">katom</em>  </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka"><span class="co">V</span></code>                                            </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4"> (value type)                 </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">          </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka"><span class="co">X</span></code>                                            </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4"> (effect type)                </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1">          </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="koka"><span class="co">E</span></code>                                            </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4"> (effect row)                 </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1">          </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <code class="koka"><span class="co">H</span></code>                                            </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4"> (heap type)                  </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1">          </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="koka"><span class="co">P</span></code>                                            </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4"> (predicate type)             </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1">          </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <code class="koka"><span class="co">S</span></code>                                            </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4"> (scope type)                 </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1">          </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <code class="koka"><span class="co">HX</span></code>                                           </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4"> (handled effect type)        </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="14" data-col="1">          </td><td class="tbody tr-even tr-last col col-even" data-row="14" data-col="2"> &#124; </td><td class="tbody tr-even tr-last col col-odd" data-row="14" data-col="3"> <code class="koka"><span class="co">HX1</span></code>                                          </td><td class="tbody tr-even tr-last col col-even col-last" data-row="14" data-col="4"> (handled linear effect type) </td></tr></tbody></table><h3 id="sec-implementation" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-implementation" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">4.4.14</span>.&#8194;</span>Implementation</h3>
<p class="p noindent">As a companion to the Flex lexical implementation, there is a full
Bison(Yacc) LALR(1)&nbsp;<a href="https://koka.codeplex.com/SourceControl/latest#doc/spec/grammar/parser.y" data-linkid="bisongrammar">implementation</a>
available. Again, the Bison parser functions
as <em class="em-low1">the</em> specification of the grammar and this document should always
be in agreement with that implementation.
</p>
<div class="bibl" style="bbl-file:./book-bib.bbl.mdk"><h1 id="sec-references" class="clearnum h1 heading-references" data-heading-depth="1" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">References</h1>
<div class="bibliography bib-numeric" data-hanging-indent="0" data-cite-style="numeric:&#39;[&#39;,&#39;]&#39;,&#39;, &#39;" data-style="madoko-numeric" style="bibstyle:madoko-numeric">
<div id="biernacki:care" class="bibitem" data-cite-year="2017" data-cite-authors="Biernacki et al." data-cite-authors-long="Biernacki, Pir&#243;g, Polesiuk, and Sieczkowski" data-cite-label="1" data-line="koka.bib:223" style="text-indent:-2rem;margin-left:2rem;searchterm:Handle%20with%20Care%3A%20Relational%20Interpretation%20of%20Algebraic%20Effects%20and%20Handlers%20Biernacki%2C%20Pir%26oacute%3Bg%2C%20Polesiuk%2C%20and%20Sieczkowski%2C%202017;spellcheck:false;bibitem-label:\5C [1\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[1]</span>Dariusz Biernacki, Maciej Pir&#243;g, Piotr Polesiuk, and Filip Sieczkowski. &#8220;Handle with Care: Relational Interpretation of Algebraic Effects and Handlers.&#8221; <em class="em-low1">Proc. ACM Program. Lang.</em> 2 (POPL17 issue): 8:18:30. Dec. 2017. doi:<a href="https://dx.doi.org/10.1145/3158096" class="bib-doi" style="font-size:smaller">10.1145/3158096</a>.&nbsp;<a href="http://www.bing.com/search?q=Handle%20with%20Care%3A%20Relational%20Interpretation%20of%20Algebraic%20Effects%20and%20Handlers%20Biernacki%2C%20Pir%26oacute%3Bg%2C%20Polesiuk%2C%20and%20Sieczkowski%2C%202017" class="bibsearch">&#128270;</a></div>
<div id="guibas1978dichromatic" class="bibitem" data-cite-year="1978" data-cite-authors="Guibas and Sedgewick" data-cite-authors-long="Guibas and Sedgewick" data-cite-label="2" data-line="koka.bib:87" style="text-indent:-2rem;margin-left:2rem;searchterm:A%20dichromatic%20framework%20for%20balanced%20trees%20Guibas%20and%20Sedgewick%2C%201978;spellcheck:false;bibitem-label:\5C [2\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[2]</span>Leo J Guibas, and Robert Sedgewick. &#8220;A Dichromatic Framework for Balanced Trees.&#8221; In <em class="em-low1">19th Annual Symposium on Foundations of Computer Science (sfcs 1978)</em>, 821. IEEE.&#160;1978.&nbsp;<a href="http://www.bing.com/search?q=A%20dichromatic%20framework%20for%20balanced%20trees%20Guibas%20and%20Sedgewick%2C%201978" class="bibsearch">&#128270;</a></div>
<div id="gunter:mprompt" class="bibitem" data-cite-year="1995" data-cite-authors="Gunter et al." data-cite-authors-long="Gunter, R&#233;my, and Riecke" data-cite-label="3" data-line="koka.bib:201" style="text-indent:-2rem;margin-left:2rem;searchterm:A%20Generalization%20of%20Exceptions%20and%20Control%20in%20MLlike%20Languages%20Gunter%2C%20R%26eacute%3Bmy%2C%20and%20Riecke%2C%201995;spellcheck:false;bibitem-label:\5C [3\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[3]</span>Carl A.&#160;Gunter, Didier R&#233;my, and Jon G.&#160;Riecke. &#8220;A Generalization of Exceptions and Control in ML-like Languages.&#8221; In <em class="em-low1">Proceedings of the Seventh International Conference on Functional Programming Languages and Computer Architecture</em>, 1223. FPCA 95. ACM, La Jolla, California, USA.&#160;1995. doi:<a href="https://dx.doi.org/10.1145/224164.224173" class="bib-doi" style="font-size:smaller">10.1145/224164.224173</a>.&nbsp;<a href="http://www.bing.com/search?q=A%20Generalization%20of%20Exceptions%20and%20Control%20in%20MLlike%20Languages%20Gunter%2C%20R%26eacute%3Bmy%2C%20and%20Riecke%2C%201995" class="bibsearch">&#128270;</a></div>
<div id="lindley:liberate" class="bibitem" data-cite-year="2016" data-cite-authors="Hillerstr&#246;m and Lindley" data-cite-authors-long="Hillerstr&#246;m and Lindley" data-cite-label="4" data-line="koka.bib:240" style="text-indent:-2rem;margin-left:2rem;searchterm:Liberating%20Effects%20with%20Rows%20and%20Handlers%20Hillerstr%26ouml%3Bm%20and%20Lindley%2C%202016;spellcheck:false;bibitem-label:\5C [4\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[4]</span>Daniel Hillerstr&#246;m, and Sam Lindley. &#8220;Liberating Effects with Rows and Handlers.&#8221; In <em class="em-low1">Proceedings of the 1st International Workshop on Type-Driven Development</em>, 1527. TyDe 2016. Nara, Japan. 2016. doi:<a href="https://dx.doi.org/10.1145/2976022.2976033" class="bib-doi" style="font-size:smaller">10.1145/2976022.2976033</a>.&nbsp;<a href="http://www.bing.com/search?q=Liberating%20Effects%20with%20Rows%20and%20Handlers%20Hillerstr%26ouml%3Bm%20and%20Lindley%2C%202016" class="bibsearch">&#128270;</a></div>
<div id="huet:zipper" class="bibitem" data-cite-year="1997" data-cite-authors="Huet" data-cite-authors-long="Huet" data-cite-label="5" data-line="koka.bib:52" style="text-indent:-2rem;margin-left:2rem;searchterm:The%20Zipper%20Huet%2C%201997;spellcheck:false;bibitem-label:\5C [5\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[5]</span>G&#233;rard P.&#160;Huet. &#8220;The Zipper.&#8221; <em class="em-low1">Journal of Functional Programming</em> 7 (5): 549554. 1997.&nbsp;<a href="http://www.bing.com/search?q=The%20Zipper%20Huet%2C%201997" class="bibsearch">&#128270;</a></div>
<div id="knuth:aocp1" class="bibitem" data-cite-year="1997" data-cite-authors="Knuth" data-cite-authors-long="Knuth" data-cite-label="6" data-line="koka.bib:96" style="text-indent:-2rem;margin-left:2rem;searchterm:The%20Art%20of%20Computer%20Programming%2C%20Volume%201%203rd%20Ed.%3A%20Fundamental%20Algorithms%20Knuth%2C%201997;spellcheck:false;bibitem-label:\5C [6\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[6]</span>Donald E.&#160;Knuth. <em class="em-low1">The Art of Computer Programming, Volume 1 (3rd Ed.): Fundamental Algorithms</em>. Addison Wesley Longman Publishing Co., Inc. 1997.&nbsp;<a href="http://www.bing.com/search?q=The%20Art%20of%20Computer%20Programming%2C%20Volume%201%203rd%20Ed.%3A%20Fundamental%20Algorithms%20Knuth%2C%201997" class="bibsearch">&#128270;</a></div>
<div id="leijen:scopedlabels" class="bibitem" data-cite-year="2005" data-cite-authors="Leijen" data-cite-authors-long="Leijen" data-cite-label="7" data-line="koka.bib:215" style="text-indent:-2rem;margin-left:2rem;searchterm:Extensible%20records%20with%20scoped%20labels%20Leijen%2C%202005;spellcheck:false;bibitem-label:\5C [7\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[7]</span>Daan Leijen. &#8220;Extensible Records with Scoped Labels.&#8221; In <em class="em-low1">Proceedings of the 2005 Symposium on Trends in Functional Programming</em>, 297312. 2005.&nbsp;<a href="http://www.bing.com/search?q=Extensible%20records%20with%20scoped%20labels%20Leijen%2C%202005" class="bibsearch">&#128270;</a></div>
<div id="leijen:algeff" class="bibitem" data-cite-year="2017" data-cite-authors="Leijen" data-cite-authors-long="Leijen" data-cite-label="8" data-line="koka.bib:188" style="text-indent:-2rem;margin-left:2rem;searchterm:Type%20Directed%20Compilation%20of%20Rowtyped%20Algebraic%20Effects%20Leijen%2C%202017;spellcheck:false;bibitem-label:\5C [8\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[8]</span>Daan Leijen. &#8220;Type Directed Compilation of Row-Typed Algebraic Effects.&#8221; In <em class="em-low1">Proceedings of the 44th ACM SIGPLAN Symposium on Principles of Programming Languages (POPL17)</em>, 486499. Paris, France. Jan. 2017. doi:<a href="https://dx.doi.org/10.1145/3009837.3009872" class="bib-doi" style="font-size:smaller">10.1145/3009837.3009872</a>.&nbsp;<a href="http://www.bing.com/search?q=Type%20Directed%20Compilation%20of%20Rowtyped%20Algebraic%20Effects%20Leijen%2C%202017" class="bibsearch">&#128270;</a></div>
<div id="mateti:morris" class="bibitem" data-cite-year="1988" data-cite-authors="Mateti and Manghirmalani" data-cite-authors-long="Mateti and Manghirmalani" data-cite-label="9" data-line="koka.bib:63" style="text-indent:-2rem;margin-left:2rem;searchterm:Morris&#39;%20tree%20traversal%20algorithm%20reconsidered%20Mateti%20and%20Manghirmalani%2C%201988;spellcheck:false;bibitem-label:\5C [9\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[9]</span>Prabhaker Mateti, and Ravi Manghirmalani. &#8220;Morris Tree Traversal Algorithm Reconsidered.&#8221; <em class="em-low1">Science of Computer Programming</em> 11 (1): 2943. 1988. doi:<a href="https://dx.doi.org/10.1016/0167-6423%2888%2990063-9" class="bib-doi" style="font-size:smaller">10.1016/0167-6423(88)90063-9</a>.&nbsp;<a href="http://www.bing.com/search?q=Morris&#39;%20tree%20traversal%20algorithm%20reconsidered%20Mateti%20and%20Manghirmalani%2C%201988" class="bibsearch">&#128270;</a></div>
<div id="mcbride:derivative" class="bibitem" data-cite-year="2001" data-cite-authors="McBride" data-cite-authors-long="McBride" data-cite-label="10" data-line="koka.bib:44" style="text-indent:-2rem;margin-left:2rem;searchterm:The%20Derivative%20of%20a%20Regular%20Type%20is%20its%20Type%20of%20OneHole%20Contexts%20McBride%2C%202001;spellcheck:false;bibitem-label:\5C [10\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[10]</span>Conor McBride. &#8220;The Derivative of a Regular Type Is Its Type of One-Hole Contexts.&#8221; 2001. <a href="http://strictlypositive.org/diff.pdf" class="bib-url texturl monospace">http://&#8203;strictlypositive.&#8203;org/&#8203;diff.&#8203;pdf</a>. (Extended Abstract).&nbsp;<a href="http://www.bing.com/search?q=The%20Derivative%20of%20a%20Regular%20Type%20is%20its%20Type%20of%20OneHole%20Contexts%20McBride%2C%202001" class="bibsearch">&#128270;</a></div>
<div id="morris:tree" class="bibitem" data-cite-year="1979" data-cite-authors="Morris" data-cite-authors-long="Morris" data-cite-label="11" data-line="koka.bib:104" style="text-indent:-2rem;margin-left:2rem;searchterm:Traversing%20binary%20trees%20simply%20and%20cheaply%20Morris%2C%201979;spellcheck:false;bibitem-label:\5C [11\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[11]</span>Joseph M.&#160;Morris. &#8220;Traversing Binary Trees Simply and Cheaply.&#8221; <em class="em-low1">Information Processing Letters</em> 9 (5): 197200. 1979. doi:<a href="https://dx.doi.org/10.1016/0020-0190%2879%2990068-1" class="bib-doi" style="font-size:smaller">10.1016/0020-0190(79)90068-1</a>.&nbsp;<a href="http://www.bing.com/search?q=Traversing%20binary%20trees%20simply%20and%20cheaply%20Morris%2C%201979" class="bibsearch">&#128270;</a></div>
<div id="okasaki:rbtree" class="bibitem" data-cite-year="1999a" data-cite-authors="Okasaki" data-cite-authors-long="Okasaki" data-cite-label="12" data-line="koka.bib:75" style="text-indent:-2rem;margin-left:2rem;searchterm:Redblack%20trees%20in%20a%20functional%20setting%20Okasaki%2C%201999a;spellcheck:false;bibitem-label:\5C [12\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[12]</span>Chris Okasaki. &#8220;Red-Black Trees in a Functional Setting.&#8221; <em class="em-low1">Journal of Functional Programming</em> 9 (4). Cambridge University Press: 471477. 1999. doi:<a href="https://dx.doi.org/10.1017/S0956796899003494" class="bib-doi" style="font-size:smaller">10.1017/S0956796899003494</a>.&nbsp;<a href="http://www.bing.com/search?q=Redblack%20trees%20in%20a%20functional%20setting%20Okasaki%2C%201999a" class="bibsearch">&#128270;</a></div>
<div id="okasaki:purefun" class="bibitem" data-cite-year="1999b" data-cite-authors="Okasaki" data-cite-authors-long="Okasaki" data-cite-label="13" data-line="koka.bib:166" style="text-indent:-2rem;margin-left:2rem;searchterm:Purely%20Functional%20Data%20Structures%20Okasaki%2C%201999b;spellcheck:false;bibitem-label:\5C [13\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[13]</span>Chris Okasaki. <em class="em-low1">Purely Functional Data Structures</em>. Colombia University, New York. Jun. 1999.&nbsp;<a href="http://www.bing.com/search?q=Purely%20Functional%20Data%20Structures%20Okasaki%2C%201999b" class="bibsearch">&#128270;</a></div>
<div id="pretnar:handlers" class="bibitem" data-cite-year="2009" data-cite-authors="Plotkin and Pretnar" data-cite-authors-long="Plotkin and Pretnar" data-cite-label="14" data-line="koka.bib:176" style="text-indent:-2rem;margin-left:2rem;searchterm:Handlers%20of%20Algebraic%20Effects%20Plotkin%20and%20Pretnar%2C%202009;spellcheck:false;bibitem-label:\5C [14\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[14]</span>Gordon D.&#160;Plotkin, and Matija Pretnar. &#8220;Handlers of Algebraic Effects.&#8221; In <em class="em-low1">18th European Symposium on Programming Languages and Systems</em>, 8094. ESOP09. York, UK.&#160;Mar. 2009. doi:<a href="https://dx.doi.org/10.1007/978-3-642-00590-9_7" class="bib-doi" style="font-size:smaller">10.1007/978-3-642-00590-9_7</a>.&nbsp;<a href="http://www.bing.com/search?q=Handlers%20of%20Algebraic%20Effects%20Plotkin%20and%20Pretnar%2C%202009" class="bibsearch">&#128270;</a></div>
<div id="perceus:tech" class="bibitem" data-cite-year="2020" data-cite-authors="Reinking et al." data-cite-authors-long="Reinking, Xie, Moura, and Leijen" data-cite-label="15" data-line="koka.bib:1" style="text-indent:-2rem;margin-left:2rem;searchterm:Perceus%3A%20GarbageFree%20Reference%20Counting%20with%20Reuse%20Reinking%2C%20Xie%2C%20Moura%2C%20and%20Leijen%2C%202020;spellcheck:false;bibitem-label:\5C [15\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[15]</span>Alex Reinking, Ningning Xie, Leonardo de Moura, and Daan Leijen. <em class="em-low1">Perceus: Garbage-Free Reference Counting with Reuse</em>. MSR-TR-2020-42. Microsoft Research. Nov. 2020. <a href="https://www.microsoft.com/en-us/research/publication/perceus-garbage-free-reference-counting-with-reuse/" class="bib-url texturl monospace">https://&#8203;www.&#8203;microsoft.&#8203;com/&#8203;en-&#8203;us/&#8203;research/&#8203;publication/&#8203;perceus-&#8203;garbage-&#8203;free-&#8203;reference-&#8203;counting-&#8203;with-&#8203;reuse/&#8203;</a>.&nbsp;<a href="http://www.bing.com/search?q=Perceus%3A%20GarbageFree%20Reference%20Counting%20with%20Reuse%20Reinking%2C%20Xie%2C%20Moura%2C%20and%20Leijen%2C%202020" class="bibsearch">&#128270;</a></div>
<div id="xie:evidently" class="bibitem" data-cite-year="2020" data-cite-authors="Xie et al." data-cite-authors-long="Xie, Brachthuser, Schuster, Hillerstrm, and Leijen" data-cite-label="16" data-line="koka.bib:23" style="text-indent:-2rem;margin-left:2rem;searchterm:Effect%20Handlers%2C%20Evidently%20Xie%2C%20Brachth%C3%A4user%2C%20Schuster%2C%20Hillerstr%C3%B6m%2C%20and%20Leijen%2C%202020;spellcheck:false;bibitem-label:\5C [16\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[16]</span>Ningning Xie, Jonathan Brachthuser, Phillip Schuster, Daniel Hillerstrm, and Daan Leijen. &#8220;Effect Handlers, Evidently.&#8221; In <em class="em-low1">Proceedings of the 25th ACM SIGPLAN International Conference on Functional Programming (ICFP2020)</em>. ICFP 20. Jersey City, NJ.&#160;Aug. 2020.&nbsp;<a href="http://www.bing.com/search?q=Effect%20Handlers%2C%20Evidently%20Xie%2C%20Brachth%C3%A4user%2C%20Schuster%2C%20Hillerstr%C3%B6m%2C%20and%20Leijen%2C%202020" class="bibsearch">&#128270;</a></div>
<div id="xie:evidence-tr" class="bibitem" data-cite-year="2021" data-cite-authors="Xie and Leijen" data-cite-authors-long="Xie and Leijen" data-cite-label="17" data-line="koka.bib:12" style="text-indent:-2rem;margin-left:2rem;searchterm:Generalized%20Evidence%20Passing%20for%20Effect%20Handlers%20Xie%20and%20Leijen%2C%202021;spellcheck:false;bibitem-label:\5C [17\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[17]</span>Ningning Xie, and Daan Leijen. <em class="em-low1">Generalized Evidence Passing for Effect Handlers</em>. MSR-TR-2021-5. Microsoft Research. Mar. 2021. <a href="https://www.microsoft.com/en-us/research/publication/generalized-evidence-passing-for-effect-handlers/" class="bib-url texturl monospace">https://&#8203;www.&#8203;microsoft.&#8203;com/&#8203;en-&#8203;us/&#8203;research/&#8203;publication/&#8203;generalized-&#8203;evidence-&#8203;passing-&#8203;for-&#8203;effect-&#8203;handlers/&#8203;</a>.&nbsp;<a href="http://www.bing.com/search?q=Generalized%20Evidence%20Passing%20for%20Effect%20Handlers%20Xie%20and%20Leijen%2C%202021" class="bibsearch">&#128270;</a></div></div></div><h1 id="sec-appendix" class="clearnum h1" data-heading-depth="1" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">Appendix</h1><h1 id="sec-full-grammar-specification" class="h1" data-heading-depth="1" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-full-grammar-specification" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">A</span>.&#8194;</span>Full grammar specification</h1><h2 id="sec:full-lexical" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec:full-lexical" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">A.1</span>.&#8194;</span>Lexical syntax</h2>
<div id="full-lexical" class="div"></div><h2 id="sec:full-grammar" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec:full-grammar" class="entity-anchor fa fa-link localref"></a><span class="heading-before"><span class="heading-label">A.2</span>.&#8194;</span>Context-free syntax</h2>
<div id="full-grammar" class="div"></div></div></div></div><span data-line=""></span></div>
<svg id='math-svg-paths' style='display:none' version='1.1' viewBox='0 0 0 0' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
<defs>
<path id='g4-32' d='M1.883-3.407C1.763-3.517 1.704-3.517 1.674-3.517C1.604-3.517 1.584-3.517 1.385-3.328L.707-2.73C.588-2.62 .548-2.58 .548-2.491C.548-2.381 .648-2.291 .747-2.291C.807-2.291 .827-2.291 .996-2.451C1.205-2.63 1.405-2.829 1.674-3.049L3.039-1.813C3.059-1.803 3.238-1.644 3.288-1.604C3.427-1.465 3.447-1.465 3.517-1.465S3.606-1.465 3.826-1.664L4.613-2.371L5.36-3.049L6.097-2.391C6.207-2.291 6.227-2.291 6.436-2.291H8.588C8.498-2.212 7.93-1.724 7.582-.827H7.89C8.06-1.285 8.448-1.993 9.385-2.491C8.448-2.999 8.05-3.706 7.89-4.154H7.582C7.93-3.258 8.498-2.77 8.588-2.69H6.356C5.968-3.049 5.858-3.158 5.629-3.357C5.45-3.517 5.43-3.517 5.36-3.517S5.27-3.497 5.161-3.407C5.131-3.387 3.736-2.122 3.517-1.933L1.883-3.407Z'/>
<path id='g5-33' d='M8.309-2.291C7.761-1.873 7.492-1.465 7.412-1.335C6.964-.648 6.884-.02 6.884-.01C6.884 .11 7.004 .11 7.083 .11C7.253 .11 7.263 .09 7.303-.09C7.532-1.066 8.12-1.903 9.245-2.361C9.365-2.401 9.395-2.421 9.395-2.491S9.335-2.59 9.315-2.6C8.877-2.77 7.671-3.268 7.293-4.941C7.263-5.061 7.253-5.091 7.083-5.091C7.004-5.091 6.884-5.091 6.884-4.971C6.884-4.951 6.974-4.324 7.392-3.656C7.592-3.357 7.88-3.009 8.309-2.69H.907C.727-2.69 .548-2.69 .548-2.491S.727-2.291 .907-2.291H8.309Z'/>
<path id='g3-90' d='M5.938-6.466C6.027-6.595 6.027-6.615 6.027-6.645C6.027-6.824 5.878-6.824 5.699-6.824H1.136C.817-6.824 .817-6.795 .787-6.535L.638-5.191L.618-5.061C.618-4.922 .727-4.872 .797-4.872C.887-4.872 .946-4.941 .966-5.021C1.006-5.26 1.096-5.699 1.704-6.077C2.271-6.446 2.969-6.476 3.308-6.476H4.115L.369-.359C.279-.229 .279-.209 .279-.179C.279 0 .438 0 .618 0H5.729C6.027 0 6.027-.02 6.067-.279L6.336-2.242C6.336-2.351 6.247-2.421 6.167-2.421C6.017-2.421 5.998-2.321 5.968-2.122C5.798-1.305 5.021-.349 3.606-.349H2.192L5.938-6.466ZM1.126-6.476H1.654V-6.466C1.385-6.316 1.196-6.137 1.076-6.027L1.126-6.476ZM4.523-6.476H5.539L1.783-.349H.767L4.523-6.476ZM5.051-.359C5.33-.518 5.589-.737 5.818-1.016C5.798-.817 5.778-.707 5.729-.349H5.051V-.359Z'/>
<path id='g9-40' d='M3.298 2.391C3.298 2.361 3.298 2.341 3.128 2.172C1.883 .917 1.564-.966 1.564-2.491C1.564-4.224 1.943-5.958 3.168-7.203C3.298-7.323 3.298-7.342 3.298-7.372C3.298-7.442 3.258-7.472 3.198-7.472C3.098-7.472 2.202-6.795 1.614-5.529C1.106-4.433 .986-3.328 .986-2.491C.986-1.714 1.096-.508 1.644 .618C2.242 1.843 3.098 2.491 3.198 2.491C3.258 2.491 3.298 2.461 3.298 2.391Z'/>
<path id='g9-41' d='M2.879-2.491C2.879-3.268 2.77-4.473 2.222-5.599C1.624-6.824 .767-7.472 .667-7.472C.608-7.472 .568-7.432 .568-7.372C.568-7.342 .568-7.323 .757-7.143C1.733-6.157 2.301-4.573 2.301-2.491C2.301-.787 1.933 .966 .697 2.222C.568 2.341 .568 2.361 .568 2.391C.568 2.451 .608 2.491 .667 2.491C.767 2.491 1.664 1.813 2.252 .548C2.76-.548 2.879-1.654 2.879-2.491Z'/>
<path id='g9-43' d='M4.075-2.291H6.854C6.994-2.291 7.183-2.291 7.183-2.491S6.994-2.69 6.854-2.69H4.075V-5.479C4.075-5.619 4.075-5.808 3.875-5.808S3.676-5.619 3.676-5.479V-2.69H.887C.747-2.69 .558-2.69 .558-2.491S.747-2.291 .887-2.291H3.676V.498C3.676 .638 3.676 .827 3.875 .827S4.075 .638 4.075 .498V-2.291Z'/>
<path id='g9-49' d='M2.929-6.376C2.929-6.615 2.929-6.635 2.7-6.635C2.082-5.998 1.205-5.998 .887-5.998V-5.689C1.086-5.689 1.674-5.689 2.192-5.948V-.787C2.192-.428 2.162-.309 1.265-.309H.946V0C1.295-.03 2.162-.03 2.56-.03S3.826-.03 4.174 0V-.309H3.856C2.959-.309 2.929-.418 2.929-.787V-6.376Z'/>
<path id='g6-63' d='M3.285-4.568C3.285-4.672 3.285-4.84 3.117-4.84C2.943-4.84 2.943-4.679 2.943-4.568V-.342H.816C.711-.342 .537-.342 .537-.174C.537 0 .697 0 .816 0H5.412C5.523 0 5.691 0 5.691-.167C5.691-.342 5.53-.342 5.412-.342H3.285V-4.568Z'/>
<path id='g5-2' d='M3.875-2.77L1.883-4.752C1.763-4.872 1.743-4.892 1.664-4.892C1.564-4.892 1.465-4.802 1.465-4.692C1.465-4.623 1.484-4.603 1.594-4.493L3.587-2.491L1.594-.488C1.484-.379 1.465-.359 1.465-.289C1.465-.179 1.564-.09 1.664-.09C1.743-.09 1.763-.11 1.883-.229L3.866-2.212L5.928-.149C5.948-.139 6.017-.09 6.077-.09C6.197-.09 6.276-.179 6.276-.289C6.276-.309 6.276-.349 6.247-.399C6.237-.418 4.653-1.983 4.154-2.491L5.978-4.314C6.027-4.374 6.177-4.503 6.227-4.563C6.237-4.583 6.276-4.623 6.276-4.692C6.276-4.802 6.197-4.892 6.077-4.892C5.998-4.892 5.958-4.852 5.848-4.742L3.875-2.77Z'/>
<path id='g3-72' d='M6.705-5.908C6.705-6.406 6.745-6.476 7.323-6.476C7.412-6.476 7.582-6.476 7.582-6.645C7.582-6.824 7.432-6.824 7.253-6.824H4.543C4.364-6.824 4.204-6.824 4.204-6.645C4.204-6.476 4.394-6.476 4.473-6.476C5.041-6.476 5.081-6.396 5.081-5.908V-3.686H2.67V-5.908C2.67-6.406 2.71-6.476 3.288-6.476C3.377-6.476 3.547-6.476 3.547-6.645C3.547-6.824 3.397-6.824 3.218-6.824H.508C.329-6.824 .169-6.824 .169-6.645C.169-6.476 .359-6.476 .438-6.476C1.006-6.476 1.046-6.396 1.046-5.908V-.917C1.046-.448 1.016-.349 .488-.349C.339-.349 .169-.349 .169-.179C.169 0 .329 0 .508 0H3.218C3.397 0 3.547 0 3.547-.179C3.547-.349 3.377-.349 3.268-.349C2.7-.349 2.67-.438 2.67-.917V-3.228H5.081V-.917C5.081-.448 5.051-.349 4.523-.349C4.374-.349 4.204-.349 4.204-.179C4.204 0 4.364 0 4.543 0H7.253C7.432 0 7.582 0 7.582-.179C7.582-.349 7.412-.349 7.303-.349C6.735-.349 6.705-.438 6.705-.917V-5.908ZM1.395-5.928C1.395-6.047 1.395-6.296 1.315-6.476H2.401C2.321-6.296 2.321-6.047 2.321-5.928V-.897C2.321-.777 2.321-.528 2.401-.349H1.315C1.395-.528 1.395-.777 1.395-.897V-5.928ZM5.43-5.928C5.43-6.047 5.43-6.296 5.35-6.476H6.436C6.356-6.296 6.356-6.047 6.356-5.928V-.897C6.356-.777 6.356-.528 6.436-.349H5.35C5.43-.528 5.43-.777 5.43-.897V-5.928Z'/>
<path id='g7-28' d='M2.929-3.716H4.603C4.732-3.716 5.091-3.716 5.091-4.055C5.091-4.294 4.882-4.294 4.692-4.294H1.903C1.704-4.294 1.315-4.294 .877-3.826C.548-3.467 .269-2.989 .269-2.929C.269-2.919 .269-2.829 .389-2.829C.468-2.829 .488-2.869 .548-2.949C1.036-3.716 1.604-3.716 1.813-3.716H2.64L1.664-.518C1.624-.399 1.564-.189 1.564-.149C1.564-.04 1.634 .12 1.853 .12C2.182 .12 2.232-.159 2.262-.309L2.929-3.716Z'/>
<path id='g5-63' d='M4.075-6.296C4.075-6.476 4.075-6.655 3.875-6.655S3.676-6.446 3.676-6.296V-.399H.907C.757-.399 .548-.399 .548-.199S.757 0 .907 0H6.854C7.024 0 7.203 0 7.203-.199S7.024-.399 6.854-.399H4.075V-6.296Z'/>
<path id='g2-70' d='M3.148-3.238H3.975C4.623-3.238 4.712-3.088 4.712-2.819C4.712-2.65 4.672-2.491 4.633-2.331C4.613-2.262 4.603-2.222 4.603-2.192C4.603-2.072 4.712-2.072 4.752-2.072C4.862-2.072 4.892-2.082 4.941-2.271L5.489-4.463C5.499-4.503 5.509-4.553 5.509-4.603C5.509-4.712 5.39-4.712 5.36-4.712C5.23-4.712 5.22-4.682 5.171-4.503C4.991-3.796 4.832-3.547 4.005-3.547H3.228L3.866-6.127C3.945-6.456 4.015-6.466 4.344-6.466H5.509C6.575-6.466 6.795-6.157 6.795-5.469C6.795-5.23 6.765-5.041 6.735-4.812L6.725-4.653C6.725-4.533 6.834-4.533 6.874-4.533C7.014-4.533 7.024-4.573 7.044-4.752L7.273-6.516C7.303-6.775 7.243-6.775 7.034-6.775H2.501C2.331-6.775 2.232-6.775 2.232-6.595C2.232-6.466 2.301-6.466 2.501-6.466C3.078-6.466 3.078-6.386 3.078-6.296C3.078-6.286 3.078-6.217 3.039-6.067L1.704-.727C1.624-.389 1.564-.309 .887-.309C.727-.309 .618-.309 .618-.12C.618 0 .727 0 .757 0C1.156 0 1.574-.03 1.973-.03C2.431-.03 2.899 0 3.347 0C3.437 0 3.557 0 3.557-.189C3.557-.309 3.467-.309 3.308-.309H3.208C2.481-.309 2.481-.389 2.481-.518C2.481-.558 2.481-.578 2.521-.727L3.148-3.238Z'/>
<path id='g2-120' d='M4.722-4.045C4.324-3.945 4.324-3.577 4.324-3.567C4.324-3.437 4.413-3.248 4.672-3.248C4.852-3.248 5.161-3.387 5.161-3.776C5.161-4.284 4.583-4.403 4.294-4.403C3.746-4.403 3.417-3.915 3.318-3.726C3.098-4.324 2.61-4.403 2.361-4.403C1.365-4.403 .827-3.098 .827-2.869C.827-2.77 .927-2.77 .976-2.77C1.106-2.77 1.106-2.78 1.156-2.939C1.425-3.796 1.943-4.184 2.341-4.184C2.63-4.184 2.819-3.955 2.819-3.557C2.819-3.318 2.7-2.829 2.61-2.461C2.501-2.052 2.491-2.012 2.381-1.554C2.222-.907 2.012-.11 1.415-.11C1.385-.11 1.146-.11 .976-.249C1.275-.329 1.365-.578 1.365-.727C1.365-.986 1.156-1.046 1.026-1.046C.777-1.046 .528-.837 .528-.508C.528-.12 .946 .11 1.405 .11C1.883 .11 2.212-.269 2.381-.568C2.58 0 3.068 .11 3.328 .11C4.354 .11 4.862-1.225 4.862-1.425C4.862-1.524 4.782-1.524 4.712-1.524C4.593-1.524 4.583-1.514 4.533-1.355C4.264-.498 3.766-.11 3.347-.11C3.148-.11 2.879-.229 2.879-.747C2.879-.986 2.989-1.415 3.068-1.753C3.178-2.172 3.328-2.79 3.407-3.118C3.547-3.636 3.816-4.184 4.284-4.184C4.314-4.184 4.563-4.184 4.722-4.045Z'/>
<path id='g7-22' d='M2.301-3.497C2.351-3.706 2.451-4.085 2.451-4.134C2.451-4.304 2.331-4.403 2.162-4.403C2.132-4.403 1.853-4.394 1.763-4.045L.329 1.724C.299 1.843 .299 1.863 .299 1.883C.299 2.032 .408 2.152 .578 2.152C.787 2.152 .907 1.973 .927 1.943C.966 1.853 1.096 1.335 1.474-.199C1.793 .07 2.242 .11 2.441 .11C3.138 .11 3.527-.339 3.766-.618C3.856-.169 4.224 .11 4.663 .11C5.011 .11 5.24-.12 5.4-.438C5.569-.797 5.699-1.405 5.699-1.425C5.699-1.524 5.609-1.524 5.579-1.524C5.479-1.524 5.469-1.484 5.44-1.345C5.27-.697 5.091-.11 4.682-.11C4.413-.11 4.384-.369 4.384-.568C4.384-.787 4.503-1.255 4.583-1.604L4.862-2.68C4.892-2.829 4.991-3.208 5.031-3.357C5.081-3.587 5.181-3.965 5.181-4.025C5.181-4.204 5.041-4.294 4.892-4.294C4.842-4.294 4.583-4.284 4.503-3.945L4.035-2.082C3.915-1.584 3.806-1.166 3.776-1.066C3.766-1.016 3.288-.11 2.481-.11C1.983-.11 1.743-.438 1.743-.976C1.743-1.265 1.813-1.544 1.883-1.823L2.301-3.497Z'/>
<path id='g7-58' d='M1.913-.528C1.913-.817 1.674-1.056 1.385-1.056S.857-.817 .857-.528S1.096 0 1.385 0S1.913-.239 1.913-.528Z'/>
<path id='g10-61' d='M5.356-2.343C5.461-2.343 5.621-2.343 5.621-2.518C5.621-2.685 5.454-2.685 5.363-2.685H.746C.656-2.685 .488-2.685 .488-2.518C.488-2.343 .649-2.343 .753-2.343H5.356ZM5.363-.809C5.454-.809 5.621-.809 5.621-.976C5.621-1.151 5.461-1.151 5.356-1.151H.753C.649-1.151 .488-1.151 .488-.976C.488-.809 .656-.809 .746-.809H5.363Z'/>
<path id='g5-106' d='M1.584-7.113C1.584-7.293 1.584-7.472 1.385-7.472S1.186-7.293 1.186-7.113V2.132C1.186 2.311 1.186 2.491 1.385 2.491S1.584 2.311 1.584 2.132V-7.113Z'/>
<path id='g8-22' d='M.377 1.123C.349 1.227 .349 1.262 .349 1.269C.349 1.423 .474 1.492 .586 1.492C.837 1.492 .893 1.262 .921 1.144C.934 1.109 1.074 .551 1.241-.133C1.458 .014 1.736 .07 1.988 .07C2.587 .07 2.978-.418 2.992-.432C3.124 .049 3.605 .07 3.71 .07C3.961 .07 4.135-.084 4.261-.3C4.414-.572 4.505-.969 4.505-.997C4.505-1.088 4.414-1.088 4.394-1.088C4.296-1.088 4.289-1.06 4.24-.872C4.156-.537 4.024-.126 3.731-.126C3.55-.126 3.501-.279 3.501-.467C3.501-.586 3.557-.837 3.605-1.018C3.654-1.206 3.724-1.492 3.759-1.646L3.919-2.267C3.961-2.441 4.038-2.748 4.038-2.783C4.038-2.922 3.926-3.006 3.808-3.006C3.731-3.006 3.599-2.971 3.522-2.838C3.501-2.797 3.445-2.573 3.41-2.434L3.264-1.855L3.048-.983C2.999-.809 2.999-.795 2.936-.704C2.72-.398 2.413-.126 2.015-.126C1.444-.126 1.444-.621 1.444-.746C1.444-.928 1.465-1.018 1.562-1.395C1.632-1.702 1.646-1.75 1.716-2.022L1.813-2.413C1.848-2.559 1.918-2.824 1.918-2.852C1.918-2.978 1.82-3.075 1.681-3.075C1.43-3.075 1.367-2.831 1.346-2.748L.377 1.123Z'/>
<path id='g8-58' d='M1.583-.398C1.583-.649 1.374-.802 1.186-.802C.955-.802 .781-.614 .781-.404C.781-.153 .99 0 1.179 0C1.409 0 1.583-.188 1.583-.398Z'/>
<path id='g8-64' d='M3.661-2.357C3.564-2.762 3.25-3.18 2.594-3.18C1.618-3.18 .809-2.448 .558-1.82C.516-1.702 .418-1.416 .418-1.137C.418-.656 .795 .139 1.883 .139C3.689 .139 4.421-2.113 4.421-3.103C4.421-4.296 3.64-4.979 2.706-4.979C1.569-4.979 1.255-4.073 1.255-3.857C1.255-3.801 1.29-3.605 1.534-3.605S1.925-3.822 1.925-3.989C1.925-4.177 1.785-4.24 1.653-4.254C2.001-4.777 2.573-4.777 2.692-4.777C3.215-4.777 3.836-4.449 3.836-3.459C3.836-3.159 3.801-2.915 3.668-2.357H3.661ZM1.897-.084C1.109-.084 1.018-.676 1.018-.893C1.018-1.165 1.206-1.848 1.276-2.022C1.402-2.343 1.834-2.985 2.622-2.985C3.299-2.985 3.522-2.455 3.522-2.036C3.522-1.569 3.068-.084 1.897-.084Z'/>
<path id='g1-70' d='M2.448-2.246H3.159C3.675-2.246 3.724-2.134 3.724-1.946C3.724-1.848 3.696-1.716 3.675-1.618C3.661-1.583 3.654-1.555 3.654-1.534C3.654-1.43 3.738-1.43 3.801-1.43C3.912-1.43 3.933-1.451 3.961-1.569L4.338-3.082C4.359-3.173 4.366-3.187 4.366-3.208C4.366-3.313 4.282-3.313 4.219-3.313C4.094-3.313 4.087-3.285 4.059-3.152C3.919-2.622 3.745-2.497 3.173-2.497H2.511L2.943-4.24C3.006-4.484 3.048-4.484 3.278-4.484H4.289C5.112-4.484 5.3-4.275 5.3-3.724C5.3-3.564 5.265-3.278 5.265-3.25C5.265-3.131 5.342-3.131 5.412-3.131C5.544-3.131 5.551-3.18 5.565-3.299L5.698-4.554C5.719-4.735 5.663-4.735 5.509-4.735H1.988C1.862-4.735 1.771-4.735 1.771-4.582C1.771-4.484 1.862-4.484 1.981-4.484C2.218-4.484 2.371-4.484 2.371-4.373C2.371-4.317 2.357-4.261 2.343-4.212L1.43-.558C1.367-.307 1.332-.251 .879-.251C.732-.251 .656-.251 .656-.098C.656-.07 .669 0 .76 0C1.025 0 1.332-.028 1.604-.028C1.925-.028 2.28 0 2.594 0C2.65 0 2.748 0 2.748-.153C2.748-.251 2.657-.251 2.552-.251H2.49C2.371-.251 2.315-.251 2.19-.265C2.043-.279 1.988-.286 1.988-.377C1.988-.391 1.988-.404 2.015-.502L2.448-2.246Z'/>
<path id='g1-120' d='M3.682-2.762C3.459-2.664 3.459-2.49 3.459-2.448C3.459-2.253 3.612-2.211 3.703-2.211C3.836-2.211 4.052-2.308 4.052-2.594C4.052-3.02 3.515-3.075 3.347-3.075C2.971-3.075 2.713-2.831 2.587-2.643C2.413-2.943 2.127-3.075 1.82-3.075C1.053-3.075 .614-2.218 .614-2.008C.614-1.918 .704-1.918 .76-1.918C.851-1.918 .886-1.925 .907-2.008C1.116-2.678 1.562-2.88 1.806-2.88C2.043-2.88 2.197-2.713 2.197-2.434C2.197-2.287 2.12-1.981 2.064-1.757L1.827-.802C1.723-.391 1.471-.126 1.193-.126C1.158-.126 .976-.126 .851-.244C1.074-.335 1.074-.53 1.074-.558C1.074-.76 .907-.795 .83-.795C.628-.795 .474-.628 .474-.411C.474-.077 .844 .07 1.186 .07C1.604 .07 1.862-.251 1.939-.363C2.085-.098 2.357 .07 2.706 .07C3.473 .07 3.919-.781 3.919-1.004C3.919-1.088 3.822-1.088 3.773-1.088C3.654-1.088 3.647-1.074 3.605-.934C3.459-.481 3.082-.126 2.72-.126C2.497-.126 2.322-.279 2.322-.579C2.322-.718 2.371-.9 2.441-1.179C2.511-1.471 2.615-1.904 2.678-2.134C2.831-2.741 3.124-2.88 3.333-2.88C3.368-2.88 3.55-2.88 3.682-2.762Z'/>
<path id='g0-105' d='M1.624-6.775H.737V-5.888H1.624V-6.775ZM1.554-4.423H.807V0H1.554V-4.423Z'/>
<path id='g0-108' d='M1.554-6.914H.807V0H1.554V-6.914Z'/>
<path id='g0-115' d='M3.417-4.274C2.899-4.513 2.491-4.593 1.983-4.593C1.733-4.593 .329-4.593 .329-3.288C.329-2.8 .618-2.481 .867-2.291C1.176-2.072 1.395-2.032 1.943-1.923C2.301-1.853 2.879-1.733 2.879-1.205C2.879-.518 2.092-.518 1.943-.518C1.136-.518 .578-.887 .399-1.006L.279-.329C.598-.169 1.146 .11 1.953 .11C2.132 .11 2.68 .11 3.108-.209C3.417-.448 3.587-.847 3.587-1.275C3.587-1.823 3.218-2.162 3.198-2.192C2.809-2.54 2.54-2.6 2.042-2.69C1.494-2.8 1.036-2.899 1.036-3.387C1.036-4.005 1.753-4.005 1.883-4.005C2.202-4.005 2.73-3.965 3.298-3.626L3.417-4.274Z'/>
<path id='g0-116' d='M1.743-3.846H3.148V-4.423H1.743V-5.689H1.056V-4.423H.189V-3.846H1.026V-1.186C1.026-.588 1.166 .11 1.853 .11C2.55 .11 3.059-.139 3.308-.269L3.148-.857C2.889-.648 2.57-.528 2.252-.528C1.883-.528 1.743-.827 1.743-1.355V-3.846Z'/>
<path id='g10-50' d='M3.522-1.269H3.285C3.264-1.116 3.194-.704 3.103-.635C3.048-.593 2.511-.593 2.413-.593H1.13C1.862-1.241 2.106-1.437 2.525-1.764C3.041-2.176 3.522-2.608 3.522-3.271C3.522-4.115 2.783-4.631 1.89-4.631C1.025-4.631 .439-4.024 .439-3.382C.439-3.027 .739-2.992 .809-2.992C.976-2.992 1.179-3.11 1.179-3.361C1.179-3.487 1.13-3.731 .767-3.731C.983-4.226 1.458-4.38 1.785-4.38C2.483-4.38 2.845-3.836 2.845-3.271C2.845-2.664 2.413-2.183 2.19-1.932L.509-.272C.439-.209 .439-.195 .439 0H3.313L3.522-1.269Z'/>
<path id='g9-61' d='M6.844-3.258C6.994-3.258 7.183-3.258 7.183-3.457S6.994-3.656 6.854-3.656H.887C.747-3.656 .558-3.656 .558-3.457S.747-3.258 .897-3.258H6.844ZM6.854-1.325C6.994-1.325 7.183-1.325 7.183-1.524S6.994-1.724 6.844-1.724H.897C.747-1.724 .558-1.724 .558-1.524S.747-1.325 .887-1.325H6.854Z'/>
<path id='g2-105' d='M3.298-1.425C3.298-1.524 3.218-1.524 3.148-1.524C3.019-1.524 3.019-1.504 2.979-1.355C2.899-1.066 2.63-.11 2.052-.11C1.973-.11 1.833-.12 1.833-.389C1.833-.648 1.963-.976 2.092-1.345L2.73-3.049C2.829-3.337 2.849-3.417 2.849-3.606C2.849-4.154 2.471-4.403 2.102-4.403C1.166-4.403 .827-2.919 .827-2.869C.827-2.77 .927-2.77 .976-2.77C1.106-2.77 1.116-2.79 1.156-2.929C1.245-3.258 1.504-4.184 2.082-4.184C2.192-4.184 2.301-4.134 2.301-3.905C2.301-3.666 2.192-3.377 2.122-3.188L1.823-2.361C1.694-2.032 1.574-1.704 1.455-1.375C1.315-.996 1.275-.887 1.275-.687C1.275-.299 1.514 .11 2.032 .11C2.969 .11 3.298-1.385 3.298-1.425ZM3.248-6.207C3.248-6.456 3.049-6.535 2.909-6.535C2.7-6.535 2.431-6.336 2.431-6.057C2.431-5.808 2.63-5.729 2.77-5.729C2.969-5.729 3.248-5.918 3.248-6.207Z'/>
<path id='g2-110' d='M2.291-1.743C2.341-1.963 2.401-2.172 2.451-2.391C2.58-2.899 2.58-2.909 2.75-3.198C2.889-3.437 3.337-4.184 4.095-4.184C4.533-4.184 4.553-3.736 4.553-3.527C4.553-2.909 4.115-1.724 3.975-1.325C3.846-.986 3.816-.897 3.816-.687C3.816-.249 4.095 .11 4.573 .11C5.499 .11 5.838-1.375 5.838-1.425C5.838-1.524 5.758-1.524 5.689-1.524C5.559-1.524 5.559-1.504 5.519-1.355C5.44-1.086 5.171-.11 4.593-.11C4.384-.11 4.374-.259 4.374-.399C4.374-.648 4.473-.907 4.553-1.146C4.752-1.674 5.161-2.79 5.161-3.367C5.161-4.184 4.613-4.403 4.125-4.403C3.308-4.403 2.829-3.806 2.7-3.616C2.63-4.105 2.291-4.403 1.863-4.403C1.504-4.403 1.305-4.174 1.146-3.875C.956-3.477 .827-2.889 .827-2.869C.827-2.77 .927-2.77 .976-2.77C1.106-2.77 1.116-2.78 1.166-2.999C1.345-3.696 1.534-4.184 1.843-4.184C2.102-4.184 2.102-3.895 2.102-3.786C2.102-3.626 2.072-3.437 2.032-3.278L1.285-.289C1.265-.229 1.255-.179 1.255-.149C1.255-.04 1.335 .11 1.534 .11C1.654 .11 1.823 .04 1.893-.149L2.291-1.743Z'/>
<path id='g2-116' d='M2.59-3.985H3.437C3.606-3.985 3.716-3.985 3.716-4.174C3.716-4.294 3.626-4.294 3.467-4.294H2.67L3.039-5.768C3.078-5.908 3.078-5.928 3.078-5.978C3.078-6.187 2.909-6.237 2.809-6.237C2.56-6.237 2.461-6.027 2.421-5.878L2.032-4.294H1.186C1.016-4.294 .907-4.294 .907-4.105C.907-3.985 .996-3.985 1.156-3.985H1.953L1.235-1.126C1.225-1.086 1.186-.927 1.186-.787C1.186-.289 1.514 .11 2.032 .11C3.039 .11 3.547-1.375 3.547-1.425C3.547-1.524 3.467-1.524 3.397-1.524C3.278-1.524 3.278-1.514 3.198-1.335C3.019-.857 2.62-.11 2.052-.11C1.783-.11 1.783-.359 1.783-.518C1.783-.588 1.783-.747 1.853-1.026L2.59-3.985Z'/>
<path id='g5-24' d='M7.193-3.328C7.193-3.547 7.133-3.646 7.054-3.646C7.004-3.646 6.924-3.577 6.914-3.387C6.874-2.431 6.217-1.883 5.519-1.883C4.892-1.883 4.413-2.311 3.925-2.74C3.417-3.198 2.899-3.656 2.222-3.656C1.136-3.656 .548-2.56 .548-1.654C.548-1.335 .677-1.335 .687-1.335C.797-1.335 .827-1.534 .827-1.564C.867-2.66 1.614-3.098 2.222-3.098C2.849-3.098 3.328-2.67 3.816-2.242C4.324-1.783 4.842-1.325 5.519-1.325C6.605-1.325 7.193-2.421 7.193-3.328Z'/>
<path id='g1-101' d='M2.001-1.59C2.301-1.59 3.675-1.59 3.675-2.462C3.675-2.838 3.32-3.075 2.831-3.075C2.05-3.075 .941-2.448 .941-1.22C.941-.488 1.374 .07 2.127 .07C3.236 .07 3.773-.586 3.773-.676C3.773-.732 3.675-.844 3.612-.844C3.578-.844 3.557-.823 3.508-.767C3.082-.258 2.476-.126 2.127-.126C1.674-.126 1.478-.509 1.478-.948C1.478-1.165 1.52-1.381 1.569-1.59H2.001ZM1.625-1.785C1.939-2.866 2.748-2.88 2.831-2.88C3.124-2.88 3.34-2.72 3.34-2.469C3.34-1.785 2.225-1.785 1.953-1.785H1.625Z'/>
<path id='g1-114' d='M1.862-1.297C1.897-1.451 1.939-1.597 1.974-1.75C2.015-1.918 2.092-2.218 2.399-2.566C2.538-2.727 2.741-2.88 3.048-2.88C3.124-2.88 3.361-2.873 3.522-2.762C3.375-2.692 3.313-2.566 3.313-2.448C3.313-2.253 3.466-2.211 3.557-2.211C3.689-2.211 3.905-2.308 3.905-2.594C3.905-2.95 3.473-3.075 3.062-3.075C2.873-3.075 2.497-3.062 2.099-2.601C1.988-2.985 1.625-3.075 1.43-3.075C1.13-3.075 .976-2.88 .872-2.706C.725-2.476 .614-2.05 .614-2.008C.614-1.918 .704-1.918 .76-1.918C.886-1.918 .893-1.925 .941-2.12C1.06-2.601 1.193-2.88 1.409-2.88S1.625-2.629 1.625-2.545C1.625-2.413 1.534-2.057 1.478-1.813L1.283-1.06C1.262-.955 1.193-.69 1.165-.586C1.13-.432 1.067-.188 1.067-.139C1.067 .014 1.179 .07 1.283 .07C1.437 .07 1.527-.042 1.555-.098C1.576-.146 1.639-.398 1.674-.544L1.862-1.297Z'/>
<path id='g1-116' d='M2.022-2.755H2.713C2.838-2.755 2.922-2.755 2.922-2.908C2.922-3.006 2.838-3.006 2.727-3.006H2.085L2.336-4.01C2.364-4.108 2.364-4.122 2.364-4.149C2.364-4.275 2.267-4.359 2.141-4.359C1.904-4.359 1.848-4.129 1.834-4.066L1.569-3.006H.879C.753-3.006 .669-3.006 .669-2.852C.669-2.755 .753-2.755 .865-2.755H1.506L1.025-.823C.99-.683 .99-.635 .99-.586C.99-.153 1.332 .07 1.695 .07C2.448 .07 2.894-.893 2.894-1.004C2.894-1.088 2.803-1.088 2.755-1.088C2.643-1.088 2.636-1.074 2.594-.976C2.267-.237 1.904-.126 1.716-.126C1.478-.126 1.478-.384 1.478-.453C1.478-.572 1.513-.718 1.52-.739L2.022-2.755Z'/>
<path id='g2-101' d='M2.381-2.301C2.68-2.301 3.347-2.331 3.826-2.521C4.613-2.839 4.613-3.487 4.613-3.557C4.613-4.015 4.244-4.403 3.606-4.403C2.56-4.403 1.136-3.397 1.136-1.634C1.136-.737 1.614 .11 2.56 .11C3.836 .11 4.663-.887 4.663-1.036C4.663-1.086 4.583-1.196 4.503-1.196C4.463-1.196 4.453-1.186 4.374-1.086C3.636-.149 2.75-.11 2.58-.11C1.933-.11 1.823-.817 1.823-1.205C1.823-1.584 1.923-2.032 1.993-2.301H2.381ZM2.052-2.521C2.481-4.154 3.507-4.184 3.606-4.184C4.005-4.184 4.234-3.915 4.234-3.577C4.234-2.521 2.59-2.521 2.262-2.521H2.052Z'/>
<path id='g2-114' d='M2.57-2.869C2.58-2.899 3.029-4.184 3.885-4.184C3.935-4.184 4.214-4.184 4.413-4.045C4.065-3.935 4.035-3.616 4.035-3.567C4.035-3.437 4.125-3.248 4.384-3.248C4.563-3.248 4.872-3.387 4.872-3.776C4.872-4.294 4.224-4.403 3.895-4.403C3.208-4.403 2.849-3.905 2.69-3.686C2.58-4.214 2.192-4.403 1.863-4.403C1.504-4.403 1.305-4.174 1.146-3.875C.956-3.477 .827-2.889 .827-2.869C.827-2.77 .927-2.77 .976-2.77C1.106-2.77 1.116-2.78 1.166-2.999C1.345-3.696 1.534-4.184 1.843-4.184C2.102-4.184 2.102-3.895 2.102-3.786C2.102-3.626 2.072-3.437 2.032-3.278L1.285-.289C1.265-.229 1.255-.179 1.255-.149C1.255-.04 1.335 .11 1.534 .11C1.833 .11 1.903-.179 1.923-.259L2.57-2.869Z'/>
</defs>
</svg>

</body>
<script type="text/javascript">
  // ---------------------------------------------
      // Classname helpers
      // ---------------------------------------------
      function hasClassName(elem,cname) {
        if (elem==null) return false;
        var regex = new RegExp("\\s*\\b" + cname + "\\b","g");
        return regex.test(elem.className);
      }
      
      function removeClassName(elem,cname) {
        var regex = new RegExp("\\s*\\b" + cname + "\\b","g");
        elem.className = elem.className.replace( regex, "" );
      }
      
      function addClassName(elem,cname) {
        if (!hasClassName(elem,cname)) elem.className = elem.className + " " + cname;
      }
      
      function toggleClassName(elem,cname) {
        var regex = new RegExp("\\s*\\b" + cname + "\\b","g");
        var classes = elem.className;
        if (regex.test(classes)) {
          elem.className = classes.replace( regex, "" );
          return false;
        }
        else {
          elem.className = classes + " " + cname;
          return true;
        }
      }
      
      // ---------------------------------------------
      // Reliable offset determination
      // ---------------------------------------------
      
      function getWindowOffset(elem) {
        var box;
        if (elem.getBoundingClientRect) {
          box = elem.getBoundingClientRect();
        }
        else if (elem.offsetParent && elem.offsetParent.getBoundingClientRect) {
          // text node
          box = elem.offsetParent.getBoundingClientRect();
          box.top = box.top + elem.offsetTop;
          box.left = box.left + elem.offsetLeft;
        }
        else {
          box = { top: 0, left : 0 };
        }
        return box;
      }
      
      // Return the viewport position: -1 (before), 0 (visible), 1 (after)
      function viewportPosition(elem) {
        var pos = getWindowOffset(elem);
        if (pos.top < 0 || pos.left < 0) 
          return -1;
        else if (pos.top > (window.innerHeight || document.documentElement.clientHeight) || 
                 pos.left > (window.innerWidth || document.documentElement.clientWidth)) 
          return 1;
        else {      
          return 0;
        }
      }
      
      // ---------------------------------------------
      // Expand the toc sections and align headers with the toc.
      // ---------------------------------------------
      
      var side = document.getElementsByClassName("sidepanel")[0];
      var afterScroll = null;
      
      // Align a heading at the top of the page with the toc
      function alignHeading( elem ) {
        var ofs     = getWindowOffset(elem).top;
        var sideofs = getWindowOffset(side).top;
        if (ofs >= 0 && ofs < sideofs) {
          window.scrollBy(0, ofs - sideofs);
        } 
      }
      
      // Expand, or unexpand, one toc item
      // The class is 'auto-expands' or 'click-expands'; the latter is sticky
      // as it is user induced and will not be automatically unexpanded.
      function itemExpand(item,cls,expand) {
        // get possible toc block (that follows the item)
        var tocblock = item.nextElementSibling;
        if (tocblock==null || !hasClassName(tocblock,"tocblock")) return;
       
        // set expand class
        if (expand===undefined) expand = !hasClassName(tocblock,"expands");
        if (cls===undefined) cls = "auto-expands" 
        if (cls==="click-expands") removeClassName(tocblock,"auto-expands");
        if (expand && !hasClassName(tocblock,cls)) {
          toggleClassName(tocblock,cls); 
        }
        else if (!expand && hasClassName(tocblock,cls)) {
          toggleClassName(tocblock,cls);
          item.firstElementChild.className = "unexpanded";
        }
        
        // set expansion icon
        if (hasClassName(tocblock,"auto-expands") || hasClassName(tocblock,"click-expands")) {
          item.firstElementChild.className = "expanded";   
        }
        else {
          item.firstElementChild.className = "unexpanded";
        }
      }
      
      // Expand a single item in the toc (and unexpand others).
      function itemExpandOne(item) {
        // unexpand anything that was expanded
        [].forEach.call( document.querySelectorAll(".tocitem"), function(item) {
          removeClassName(item,"current");
          itemExpand(item,"auto-expands",false);      
        });
        addClassName(item,"current");
        // expand the chain of parent blocks
        var tocblock = null;
        var toc = item.nextElementSibling;
        if (toc && hasClassName(toc,"tocblock")) { 
          tocblock = toc;
        }
        else {
          tocblock = item.parentElement;
        }
        while(tocblock != null && !hasClassName(tocblock,"toc")) {
          if (hasClassName(tocblock,"tocblock")) {
            item = tocblock.previousElementSibling;
            if (item != null) itemExpand(item,"auto-expands",true);
          }
          tocblock = tocblock.parentElement;
        }
      }
      
      // Auto expand the toc at current  position in the document 
      function expandToc() {
        // find the first section heading that is visible in the viewport 
        var current = null;
        [].every.call( document.querySelectorAll(".tocitem"), function(item) {
          var target = document.getElementById( item.getAttribute("data-toc-target") );
          var pos = viewportPosition(target);
          if (pos <= 0) {
            current = item;
          }
          return (pos < 0); // keep going if not yet on screen
        });
        // if found, expand the corresponding item
        if (current != null) itemExpandOne(current);
      }
      
      document.addEventListener("load", function(ev) { expandToc(); });
      document.addEventListener("resize", function(ev) { expandToc(); });
      
      // fire at end of scrolling
      var scrollHandler = null;
      document.addEventListener("scroll", function(ev) {
        if (scrollHandler) clearTimeout(scrollHandler);
        scrollHandler = setTimeout( function() {
          scrollHandler = null;
          if (afterScroll) {
            afterScroll();
            afterScroll = null;
          }
          else {
            expandToc();
          }
        }, 50 );
      });
      
      // ---------------------------------------------
      // Install event handlers for all items in the TOC
      // ---------------------------------------------
      [].forEach.call( document.querySelectorAll(".tocitem"), function(item) {
        // only for toc items with a target
        var target = document.getElementById( item.getAttribute("data-toc-target") );
        if (!target) return;
        
        // ensure every tocblock has a expansion icon in front
        // (the optional nested tocblock follows the item)
        var tocblock = null;
        var toc = item.nextElementSibling;  
        if (toc && hasClassName(toc,"tocblock")) { 
          tocblock = toc;
          item.innerHTML = "<span class='unexpanded'></span>" + item.innerHTML;   
        } 
        
        // on a click
        item.addEventListener( "click", function() {
          // expand this toc item and set expansion icon
          itemExpand(item,"click-expands");
          // after navigation, align the heading with the toc
          afterScroll = (function() {
            alignHeading(target);
          });    
        }); 
      });
</script>

</html>
