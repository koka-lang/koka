<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<style type="text/css">.koka .plaincode, .koka a.pp .pc { display: none; } .koka a.pp { color: inherit; text-decoration: none; }</style>
<link rel="stylesheet" type="text/css" href="styles/madoko.css" />
<link rel="stylesheet" type="text/css" href="styles/koka.css" />

<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Nunito:400,400italic,700,700italic" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic" />

<title>calendar.kk documentation</title>
</head>

<body class="koka doc body madoko">
<pre class="koka source"><span class="comment">/&#42;----------------------------------------------------------------------------
   Copyright (C) 2012-2019 Microsoft Corporation

   Licensed under the Apache License, Version 2.0 ("The Licence"). You may not
   use this file except in compliance with the License. A copy of the License
   can be found in the file "license.txt" at the root of this distribution.
----------------------------------------------------------------------------&#42;/</span>

<span class="comment">/&#42; Calendars.

  A Calendar determines how a &#96;:date&#96; and &#96;:clock&#96; relates to an &#96;:instant&#96; in time
  with respect to a &#96;:timezone&#96;. These functions turn &#96;:instant&#96;'s into "human" dates.
  Months, days etc. are always 1-based.
&#42;/</span>
<span class="kw">module</span> calendar

<span class="kw">import</span> ddouble
<span class="kw">import</span> timestamp
<span class="kw">import</span> duration
<span class="kw">import</span> instant
<span class="kw">import</span> utc
<span class="kw">import</span> date

include <span class="kw">extern</span> {
  c  file <span class="st">"calendar-inline.c"</span>
  cs file <span class="st">"calendar-inline.cs"</span>
  js file <span class="st">"calendar-inline.js"</span>
}

<span class="comment">// A Calendar determines how a &#96;:date&#96; and &#96;:clock&#96; relates to an &#96;:instant&#96; in time.
</span><span class="decl-type" id="type_space_calendar"><span class="kw">public</span> <span class="tp kw">struct</span> <span class="decl-con" id="con_space_Calendar"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a>(
  <span class="decl-fun" id="name_1"><a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a></span>        <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
  <span class="decl-fun" id="long_name"><a class="pp">long-name<span class="pc">long<span class="dash">-</span>name: <span class="tp">string</span></span></a></span>   <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
  <span class="comment">//timescale   : timescale,
</span>  <span class="decl-fun" id="month_prefix"><a class="pp">month-prefix<span class="pc">month<span class="dash">-</span>prefix: <span class="tp">string</span></span></a></span><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
  <span class="decl-fun" id="show_era"><a class="pp">show-era<span class="pc">show<span class="dash">-</span>era: <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a></span>    <span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
  <span class="kw">private</span> <span class="decl-fun" id="instant_to_dc"><a class="pp">instant-to-dc<span class="pc">instant<span class="dash">-</span>to<span class="dash">-</span>dc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">tzdelta</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">,</span> <span class="tp">clock</span><span class="tp sp">)</span></span></a></span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">,</span><span class="tp tpp">tzdelta</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_clock"><span class="tp">clock</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>clock: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a>,
  <span class="kw">private</span> <span class="decl-fun" id="dc_to_instant"><a class="pp">dc-to-instant<span class="pc">dc<span class="dash">-</span>to<span class="dash">-</span>instant: <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">,</span> <span class="tp">clock</span><span class="tp sp">,</span> <span class="tp">timezone</span><span class="tp sp">,</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a></span> <span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_clock"><span class="tp">clock</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>clock: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="#type_space_timezone"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>timezone: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a>,
  <span class="kw">private</span> <span class="decl-fun" id="days_to_date"><a class="pp">days-to-date<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a></span>  <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a>,
  <span class="kw">private</span> <span class="decl-fun" id="date_to_days"><a class="pp">date-to-days<span class="pc">date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a></span>  <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">date</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>
</span></span>)

<span class="comment">// Check if two calendars use the same date calculations. (Display of era names etc. may differ)
</span><span class="decl-fun" id="_eq__eq_"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#_eq__eq_">(==)<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>(==): <span class="tp sp">(</span><span class="tp tpp">c1</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">,</span> <span class="tp tpp">c2</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>( <a class="pp">c1<span class="pc">c1: <span class="tp">calendar</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a>, <a class="pp">c2<span class="pc">c2: <span class="tp">calendar</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {
  (<a class="pp">c1<span class="pc">c1: <span class="tp">calendar</span></span></a><span class="kw op">.</span><a class="pp" href="#long_name">long-name<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>long<span class="dash">-</span>name: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_eq__eq__3">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">c2<span class="pc">c2: <span class="tp">calendar</span></span></a><span class="kw op">.</span><a class="pp" href="#long_name">long-name<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>long<span class="dash">-</span>name: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>)
</span>}

<span class="comment">/&#42;----------------------------------------------------------------------------
  Time zone
----------------------------------------------------------------------------&#42;/</span>

<span class="comment">// A &#96;:timezone&#96; determines a time offset with respect to the UTC / GMT timezone. For
// using general time zones, see the [&#96;std/time/timezone&#96;](std&#95;time&#95;timezone.html) module.\
// The &#96;tz-utc&#96; and &#96;tz-local&#96; time zones are used for UTC/GMT time and the local system time.\
// The &#96;name&#96; field contains the time zone name as IANA timezone identifier.
// The &#96;utc-delta&#96; field returns the time zone offset
// relative to UTC (for GMT-08:00 it returns a duration of &#96;-8&#42;3600&#96; seconds) and the abbreviated
// time zone name (&#96;&#96;PDT&#96;&#96; for example).\
// The optional &#96;utc-inverse&#96; field returns for an instant in the time zone, the associated UTC time.
// By default it returns &#96;Nothing&#96; in which case a generic algorithm is used to determine the
// inverse.
</span><span class="decl-type" id="type_space_timezone"><span class="kw">public</span> <span class="tp kw">struct</span> <span class="decl-con" id="con_space_Timezone"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#type_space_timezone"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>timezone: <span class="tp">V</span></span></a>(
  <span class="decl-fun" id="name"><a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a></span>    <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
  <span class="kw">private</span> <span class="decl-fun" id="utc_delta"><a class="pp">utc-delta<span class="pc">utc<span class="dash">-</span>delta: <span class="tp sp">(</span><span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span></span></a></span>  <span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a>,
  <span class="kw">private</span> <span class="decl-fun" id="utc_inverse"><a class="pp">utc-inverse<span class="pc">utc<span class="dash">-</span>inverse: <span class="tp sp">(</span><span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">instant</span><span class="tp sp">&gt;</span></span></a></span><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> <span class="kw">=</span> <span class="kw">fn</span>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>) { <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> }
</span></span>)

<span class="comment">// Same timezone?
</span><span class="decl-fun" id="_eq__eq__1"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#_eq__eq__1">(==)<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">tz1</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">,</span> <span class="tp tpp">tz2</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>( <a class="pp">tz1<span class="pc">tz1: <span class="tp">timezone</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_timezone"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>timezone: <span class="tp">V</span></span></a>, <a class="pp">tz2<span class="pc">tz2: <span class="tp">timezone</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_timezone"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>timezone: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {
  (<a class="pp">tz1<span class="pc">tz1: <span class="tp">timezone</span></span></a><span class="kw op">.</span><a class="pp" href="#name">name<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">timezone</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_eq__eq__3">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">tz2<span class="pc">tz2: <span class="tp">timezone</span></span></a><span class="kw op">.</span><a class="pp" href="#name">name<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">timezone</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>)
</span>}

<span class="comment">// Is this the UTC timezone?
</span><span class="decl-fun" id="is_tz_utc"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#is_tz_utc">is-tz-utc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>is<span class="dash">-</span>tz<span class="dash">-</span>utc: <span class="tp sp">(</span><span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>( <a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_timezone"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>timezone: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {
  <a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a> <a class="pp" href="#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">tz1</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">,</span> <span class="tp tpp">tz2</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="#tz_utc">tz-utc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>utc: <span class="tp">timezone</span></span></a>
</span>}

<span class="comment">// Create a time zone with a fixed number of hours and optional minutes (=&#96;0&#96;) difference from UTC/GMT.
// The time zone name and abbreviation is optional, and the default name
// will reflect the offset from UTC, for example &#96;"UTC+1:20"&#96;, or &#96;"UTC-8"&#96;.
// The default abbreviation is the empty string.
// The sign of the minutes will be matched to the hours (unless &#96;hours&#96; is &#96;0&#96;).
// For example, &#96;tz-fixed(-1,30)&#96; gives a time zone offset of -90 minutes, "UTC-1:30".
// Returns &#96;tz-utc&#96; if both &#96;hours&#96; and &#96;mins&#96; are zero.
</span><span class="decl-fun" id="tz_fixed"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#tz_fixed">tz-fixed<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>fixed: <span class="tp sp">(</span><span class="tp tpp">hours</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">mins</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">abbrv</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">hourwidth</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timezone</span></span></a>( <a class="pp">hours<span class="pc">hours: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">mins<span class="pc">mins: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0</span>, <a class="pp">name<span class="pc">name: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">""</span>, <a class="pp">abbrv<span class="pc">abbrv: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">""</span>, <a class="pp">hourwidth<span class="pc">hourwidth: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">1</span> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_timezone"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>timezone: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">hours<span class="pc">hours: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#is_zero">is-zero<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>zero: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#_amp__amp_">&amp;&amp;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&amp;&amp;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">mins<span class="pc">mins: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#is_zero">is-zero<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>zero: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">timezone</span></span></a> <a class="pp" href="#tz_utc">tz-utc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>utc: <span class="tp">timezone</span></span></a>
  <span class="kw">val</span> <a class="pp">xmins<span class="pc">xmins: <span class="tp">int</span></span></a> <span class="kw">=</span> <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">hours<span class="pc">hours: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#is_pos_2">is-pos<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>pos<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp">mins<span class="pc">mins: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#abs">abs<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>abs: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="kw">elif</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">hours<span class="pc">hours: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#is_neg_2">is-neg<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>neg<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> (<a class="pp">mins<span class="pc">mins: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#abs">abs<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>abs: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#negate">negate<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>negate: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="kw">else</span> <a class="pp">mins<span class="pc">mins: <span class="tp">int</span></span></a>
  <span class="kw">val</span> <a class="pp">secs<span class="pc">secs: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp">hours<span class="pc">hours: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">3600</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">xmins<span class="pc">xmins: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">60</span>
  <span class="kw">val</span> <a class="pp">tzonename<span class="pc">tzonename: <span class="tp">string</span></span></a> <span class="kw">=</span> <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_bar__bar__1">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> (<span class="st">"UTC"</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__6">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.6</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> (<span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">secs<span class="pc">secs: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#is_neg_2">is-neg<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>neg<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <span class="st">"-"</span> <span class="kw">else</span> <span class="st">"+"</span>)
                            <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__6">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.6</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">hours<span class="pc">hours: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#abs">abs<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>abs: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#show">show<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>show: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pad_left">pad-left<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pad<span class="dash">-</span>left: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">width</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">fill</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<a class="pp">hourwidth<span class="pc">hourwidth: <span class="tp">int</span></span></a>,<span class="st">'0'</span>)
                            <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__6">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.6</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> (<span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">mins<span class="pc">mins: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#is_zero">is-zero<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>zero: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <span class="st">""</span> <span class="kw">else</span> <span class="st">":"</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__6">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.6</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">mins<span class="pc">mins: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#abs">abs<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>abs: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#show">show<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>show: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pad_left">pad-left<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pad<span class="dash">-</span>left: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">width</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">fill</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<span class="number">2</span>,<span class="st">'0'</span>)))
  <span class="kw">val</span> <a class="pp">delta<span class="pc">delta: <span class="tp">duration</span></span></a>  <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_duration-source.html#duration_1">duration<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">secs</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">secs<span class="pc">secs: <span class="tp">int</span></span></a>)
  <a class="pp" href="#tz_fixed_1">tz-fixed<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>fixed<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">delta</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">abbrv</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timezone</span></span></a>(<a class="pp">tzonename<span class="pc">tzonename: <span class="tp">string</span></span></a>,<a class="pp">delta<span class="pc">delta: <span class="tp">duration</span></span></a>,<a class="pp">abbrv<span class="pc">abbrv: <span class="tp">string</span></span></a>)
</span>}

<span class="decl-fun" id="tz_fixed_1"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#tz_fixed_1">tz-fixed<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>fixed<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">delta</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">abbrv</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timezone</span></span></a>( <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">delta<span class="pc">delta: <span class="tp">duration</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <a class="pp">abbrv<span class="pc">abbrv: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">""</span> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_timezone"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>timezone: <span class="tp">V</span></span></a> {
  <a class="pp" href="#con_space_Timezone"><span class="co">Timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>Timezone: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">utc<span class="dash">-</span>delta</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">utc<span class="dash">-</span>inverse</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">instant</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timezone</span></span></a>( <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a>,
    <span class="kw">fn</span>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>) { <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">delta<span class="pc">delta: <span class="tp">duration</span></span></a>,<a class="pp">abbrv<span class="pc">abbrv: <span class="tp">string</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> },
    <span class="kw">fn</span>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>) { <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">delta<span class="pc">delta: <span class="tp">duration</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_duration-source.html#is_zero">is-zero<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>is<span class="dash">-</span>zero: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>) <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> }
  )
</span>}

<span class="comment">// The standard UTC time zone with a 0 delta.
</span><span class="decl-val" id="tz_utc"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#tz_utc">tz-utc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>utc: <span class="tp">timezone</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_timezone"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>timezone: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#tz_fixed_1">tz-fixed<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>fixed<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">delta</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">abbrv</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timezone</span></span></a>(<span class="st">"UTC"</span>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_duration-source.html#zero">zero<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>zero: <span class="tp">duration</span></span></a></span>)

<span class="comment">// Return the local timezone on the current system.
</span><span class="decl-fun" id="tz_local"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#tz_local">tz-local<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>local: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ndet</span> <span class="tp">timezone</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_ndet"><span class="tp"><span class="effect">ndet</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a> <a class="pp" href="#type_space_timezone"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>timezone: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">tz<span class="pc">tz: <span class="tp">local<span class="dash">-</span>timezone</span></span></a> <span class="kw">=</span> <a class="pp" href="#local_get_timezone">local-get-timezone<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>local<span class="dash">-</span>get<span class="dash">-</span>timezone: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ndet</span> <span class="tp">local<span class="dash">-</span>timezone</span></span></a>()  <span class="comment">// get it once so the &#96;Timezone&#96; itself is immutable!
</span>  <a class="pp" href="#con_space_Timezone"><span class="co">Timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>Timezone: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">utc<span class="dash">-</span>delta</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">utc<span class="dash">-</span>inverse</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">instant</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timezone</span></span></a>(
    <span class="st">""</span>,
    <span class="kw">fn</span>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>) {
      <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">ofs<span class="pc">ofs: <span class="tp">double</span></span></a>,<a class="pp">abbrv<span class="pc">abbrv: <span class="tp">string</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span> <a class="pp" href="#local_utc_delta">local-utc-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>local<span class="dash">-</span>utc<span class="dash">-</span>delta: <span class="tp sp">(</span><span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>timezone</span><span class="tp sp">,</span> <span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span></span></a>(<a class="pp">tz<span class="pc">tz: <span class="tp">local<span class="dash">-</span>timezone</span></span></a>, <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_utc-source.html#unix_timestamp">unix-timestamp<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>unix<span class="dash">-</span>timestamp: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>)
      <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_duration-source.html#duration_2">duration<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">secs</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">ofs<span class="pc">ofs: <span class="tp">double</span></span></a>),<a class="pp">abbrv<span class="pc">abbrv: <span class="tp">string</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
    }
  )
</span>}

<span class="comment">// A local timezone structure provided by the host system
</span><span class="decl-type" id="type_space_local_timezone"><span class="tp kw">type</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#type_space_local_timezone"><span class="tp">local-timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>local<span class="dash">-</span>timezone: <span class="tp">V</span></span></a></span>

<span class="comment">// Get the current local timezone structure.
// The timezone name is allowed to be the empty string.
</span><span class="decl-fun" id="local_get_timezone"><span class="kw">extern</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#local_get_timezone">local-get-timezone<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>local<span class="dash">-</span>get<span class="dash">-</span>timezone: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ndet</span> <span class="tp">local<span class="dash">-</span>timezone</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_ndet"><span class="tp"><span class="effect">ndet</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a> <a class="pp" href="#type_space_local_timezone"><span class="tp">local-timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>local<span class="dash">-</span>timezone: <span class="tp">V</span></span></a> {
  c  <span class="st">"kk&#95;local&#95;get&#95;timezone"</span>
  cs <span class="st">"&#95;Calendar.LocalTimeZone"</span>
  js <span class="st">"&#95;local&#95;get&#95;timezone"</span>
</span>}

<span class="comment">// Return the utc delta in fractional seconds given a local timezone structure
// and time &#96;i&#96; in fractional seconds since the UNIX epoch (1970-01-01).
// Also returns time zone abbreviation.
</span><span class="decl-fun" id="local_utc_delta"><span class="kw">extern</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#local_utc_delta">local-utc-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>local<span class="dash">-</span>utc<span class="dash">-</span>delta: <span class="tp sp">(</span><span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>timezone</span><span class="tp sp">,</span> <span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span></span></a>( <a class="pp">tz<span class="pc">tz: <span class="tp">local<span class="dash">-</span>timezone</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_local_timezone"><span class="tp">local-timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>local<span class="dash">-</span>timezone: <span class="tp">V</span></span></a>, <a class="pp">i<span class="pc">i: <span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> {
  c  <span class="st">"kk&#95;local&#95;get&#95;utc&#95;delta&#95;tuple"</span>
  cs <span class="st">"&#95;Calendar.LocalUtcDelta"</span>
  js <span class="st">"&#95;local&#95;utc&#95;delta"</span>
</span>}


<span class="comment">/&#42;----------------------------------------------------------------------------
  Time and instant conversion using a calendar
----------------------------------------------------------------------------&#42;/</span>

<span class="comment">// Return the instant in time for a given &#96;:date&#96; and &#96;:clock&#96; (= &#96;clock0&#96;) interpreted by
// calendar &#96;cal&#96; (=&#96;cal-iso&#96;) in a timezone &#96;tz&#96; (=&#96;tz-utc&#96; by default).
</span><span class="decl-fun" id="instant"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#instant">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>instant: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">clock</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timezone</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">calendar</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>( <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a>, <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a>, <a class="pp">c<span class="pc">c: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">clock</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">clock</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#clock0">clock0<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>clock0: <span class="tp">clock</span></span></a>, <a class="pp">tz<span class="pc">tz: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timezone</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#tz_utc">tz-utc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>utc: <span class="tp">timezone</span></span></a>, <a class="pp">cal<span class="pc">cal: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">calendar</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#cal_iso">cal-iso<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>cal<span class="dash">-</span>iso: <span class="tp">calendar</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a> {
  (<a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a><span class="kw op">.</span><a class="pp" href="#dc_to_instant">dc-to-instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>dc<span class="dash">-</span>to<span class="dash">-</span>instant: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">,</span> <span class="tp">clock</span><span class="tp sp">,</span> <span class="tp">timezone</span><span class="tp sp">,</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span><span class="tp sp">)</span></span></a>)( <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>, <a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a>, <a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a>, <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a> )
</span>}

<span class="decl-fun" id="instant_1"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#instant_1">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>instant<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">clock</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timezone</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">calendar</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timescale</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">utc</span> <span class="tp">instant</span></span></a>( <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a>, <a class="pp">c<span class="pc">c: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">clock</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">clock</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#clock0">clock0<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>clock0: <span class="tp">clock</span></span></a>, <a class="pp">tz<span class="pc">tz: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timezone</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#tz_utc">tz-utc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>utc: <span class="tp">timezone</span></span></a>, <a class="pp">cal<span class="pc">cal: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">calendar</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#cal_iso">cal-iso<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>cal<span class="dash">-</span>iso: <span class="tp">calendar</span></span></a>, <a class="pp">ts<span class="pc">ts: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timescale</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_utc-source.html#utc">utc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>utc: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">utc</span> <span class="tp">timescale</span></span></a>() ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_utc-source.html#type_space_utc"><span class="tp">utc</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>utc: <span class="tp">HX</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a> {
  <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="#instant">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>instant: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">clock</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timezone</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">calendar</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>(<a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>,<a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a>,<a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a>,<a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a>)
</span>}

<span class="comment">// Convert an &#96;:instant&#96; to a &#96;:date&#96;, &#96;:clock&#96;, timezone delta and abbreviation,
// for a given timezone &#96;tz&#96; (=&#96;tz-utc&#96; by default) and calendar (=&#96;cal-iso&#96; by default).
</span><span class="decl-fun" id="instant_dc"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#instant_dc">instant-dc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>instant<span class="dash">-</span>dc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timezone</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">calendar</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">,</span> <span class="tp">clock</span><span class="tp sp">,</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span></span></a>( <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a>, <a class="pp">tz<span class="pc">tz: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timezone</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#tz_utc">tz-utc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>utc: <span class="tp">timezone</span></span></a>, <a class="pp">cal<span class="pc">cal: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">calendar</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#cal_iso">cal-iso<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>cal<span class="dash">-</span>iso: <span class="tp">calendar</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__comma__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,,,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_clock"><span class="tp">clock</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>clock: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__comma__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,,,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> {
  <span class="comment">//trace("instant-dc: " + i.show-raw)
</span>  <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">tzdelta<span class="pc">tzdelta: <span class="tp">duration</span></span></a>,<a class="pp">tzabbrv<span class="pc">tzabbrv: <span class="tp">string</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span> (<a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a><span class="kw op">.</span><a class="pp" href="#utc_delta">utc-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>utc<span class="dash">-</span>delta: <span class="tp sp">(</span><span class="tp tpp">timezone</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span><span class="tp sp">)</span></span></a>)(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>)
  <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>,<a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span> (<a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a><span class="kw op">.</span><a class="pp" href="#instant_to_dc">instant-to-dc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>instant<span class="dash">-</span>to<span class="dash">-</span>dc: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">tzdelta</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">,</span> <span class="tp">clock</span><span class="tp sp">)</span><span class="tp sp">)</span></span></a>)( <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>, <a class="pp">tzdelta<span class="pc">tzdelta: <span class="tp">duration</span></span></a> )
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__comma__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,,,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">c</span><span class="tp sp">,</span><span class="tp tv">d</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tpp">thd</span> <span class="tp kw op">:</span> <span class="tp tv">c</span><span class="tp sp">,</span> <span class="tp tpp">field4</span> <span class="tp kw op">:</span> <span class="tp tv">d</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tv">c</span><span class="tp sp">,</span> <span class="tp tv">d</span><span class="tp sp">)</span></span></a><a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>,<a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a>,<a class="pp">tzdelta<span class="pc">tzdelta: <span class="tp">duration</span></span></a>,<a class="pp">tzabbrv<span class="pc">tzabbrv: <span class="tp">string</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__comma__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,,,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">c</span><span class="tp sp">,</span><span class="tp tv">d</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tpp">thd</span> <span class="tp kw op">:</span> <span class="tp tv">c</span><span class="tp sp">,</span> <span class="tp tpp">field4</span> <span class="tp kw op">:</span> <span class="tp tv">d</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tv">c</span><span class="tp sp">,</span> <span class="tp tv">d</span><span class="tp sp">)</span></span></a>
</span>}

<span class="comment">/&#42; Return the instant in time for a given date and clock interpreted by
   calendar &#96;cal&#96; (=&#96;cal-iso&#96;) in a timezone &#96;tz&#96; (=&#96;tz-utc&#96; by default).

  The &#96;month&#96;, &#96;day&#96;, &#96;hour&#96;, &#96;minutes&#96; may be outside their usual ranges
  and will be normalized during the conversion. For example, January 33 converts to February 2.
  This makes it very easy to add- or subtract days or months to an existing time.
  When the &#96;seconds&#96; or fraction of seconds &#96;frac&#96; add up over 60 those extra seconds are
  interpreted as leap seconds.

  Due to timezone transitions, or leap seconds, it is possible to specify dates that never
  happened (as it was skipped by a timezone change), or ambigious times (as a timezone springs back).
  In such cases, the time is always interpreted in the earlier timezone.
&#42;/</span>
<span class="decl-fun" id="instant_2"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#instant_2">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>instant<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">day</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">hours</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">minutes</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">seconds</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timezone</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">calendar</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>( <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a>,
                    <a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">month<span class="pc">month: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">1</span>, <a class="pp">day<span class="pc">day: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">1</span>,
                    <a class="pp">hours<span class="pc">hours: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0</span>, <a class="pp">minutes<span class="pc">minutes: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0</span>, <a class="pp">seconds<span class="pc">seconds: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0</span>,
                    <a class="pp">frac<span class="pc">frac: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0.0</span>, <a class="pp">tz<span class="pc">tz: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timezone</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#tz_utc">tz-utc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>utc: <span class="tp">timezone</span></span></a>,
                    <a class="pp">cal<span class="pc">cal: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">calendar</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#cal_iso">cal-iso<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>cal<span class="dash">-</span>iso: <span class="tp">calendar</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a>
{
  <span class="kw">val</span> <a class="pp">fsecs<span class="pc">fsecs: <span class="tp">ddouble</span></span></a> <span class="kw">=</span> <a class="pp">seconds<span class="pc">seconds: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#ddouble_1">ddouble<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>ddouble<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a> <a class="pp">frac<span class="pc">frac: <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#ddouble">ddouble<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>ddouble: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a>
  <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="#instant">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>instant: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">clock</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timezone</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">calendar</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>( <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#con_space_Date"><span class="co">Date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>Date: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">day</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>(<a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a>,<a class="pp">month<span class="pc">month: <span class="tp">int</span></span></a>,<a class="pp">day<span class="pc">day: <span class="tp">int</span></span></a>), <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#con_space_Clock"><span class="co">Clock</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>Clock: <span class="tp sp">(</span><span class="tp tpp">hours</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">minutes</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">seconds</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">clock</span></span></a>(<a class="pp">hours<span class="pc">hours: <span class="tp">int</span></span></a>,<a class="pp">minutes<span class="pc">minutes: <span class="tp">int</span></span></a>,<a class="pp">fsecs<span class="pc">fsecs: <span class="tp">ddouble</span></span></a>), <a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a>, <a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a> )
</span>}

<span class="decl-fun" id="instant_3"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#instant_3">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>instant<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">day</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">hours</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">minutes</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">seconds</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timezone</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">calendar</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timescale</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">utc</span> <span class="tp">instant</span></span></a>( <a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">month<span class="pc">month: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">1</span>, <a class="pp">day<span class="pc">day: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">1</span>,
                    <a class="pp">hours<span class="pc">hours: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0</span>, <a class="pp">minutes<span class="pc">minutes: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0</span>, <a class="pp">seconds<span class="pc">seconds: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0</span>,
                    <a class="pp">frac<span class="pc">frac: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0.0</span>, <a class="pp">tz<span class="pc">tz: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timezone</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#tz_utc">tz-utc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>tz<span class="dash">-</span>utc: <span class="tp">timezone</span></span></a>,
                    <a class="pp">cal<span class="pc">cal: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">calendar</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#cal_iso">cal-iso<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>cal<span class="dash">-</span>iso: <span class="tp">calendar</span></span></a>, <a class="pp">ts<span class="pc">ts: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timescale</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_utc-source.html#utc">utc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>utc: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">utc</span> <span class="tp">timescale</span></span></a>() ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_utc-source.html#type_space_utc"><span class="tp">utc</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>utc: <span class="tp">HX</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a>
{
  <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="#instant_2">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>instant<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">day</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">hours</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">minutes</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">seconds</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timezone</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">calendar</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>(<a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a>,<a class="pp">month<span class="pc">month: <span class="tp">int</span></span></a>,<a class="pp">day<span class="pc">day: <span class="tp">int</span></span></a>,<a class="pp">hours<span class="pc">hours: <span class="tp">int</span></span></a>,<a class="pp">minutes<span class="pc">minutes: <span class="tp">int</span></span></a>,<a class="pp">seconds<span class="pc">seconds: <span class="tp">int</span></span></a>,<a class="pp">frac<span class="pc">frac: <span class="tp">double</span></span></a>,<a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a>,<a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a>)
</span>}

<span class="comment">// Return the day of the week for a calendar &#96;cal&#96; (=&#96;cal-iso&#96;).
</span><span class="decl-fun" id="weekday"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#weekday">weekday<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>weekday: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">weekday</span></span></a>( <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a>, <a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_weekday"><span class="tp">weekday</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>weekday: <span class="tp">V</span></span></a> {
  <span class="comment">// Generic algorithm for any calendar
</span>  <span class="comment">/&#42;
  val i    = instant(d.year,d.month,d.day,cal=cal)
  val dow  = (i.days+6)%7      // plus 6 since 2000-01-01 epoch was a Saturday  (note: 0 = sunday, 1 = monday, ..)
  &#42;/</span>
  <span class="kw">val</span> <a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a> <span class="kw">=</span> (<a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a><span class="kw op">.</span><a class="pp" href="#date_to_days">date-to-days<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">)</span></span></a>)(<a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>)
  <span class="kw">val</span> <a class="pp">dow<span class="pc">dow: <span class="tp">int</span></span></a>  <span class="kw">=</span> (<a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">6</span>)<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">7</span>        <span class="comment">// plus 6 since 2000-01-01 epoch was a Saturday  (note: 0 = sunday, 1 = monday, ..)
</span>  <a class="pp">dow<span class="pc">dow: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#weekday">weekday<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>weekday: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">weekday</span></span></a>                  <span class="comment">// to ISO week day
</span></span>}

<span class="comment">// Return the days between two dates interpreted by calendar &#96;cal&#96;.
</span><span class="decl-fun" id="days_until"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#days_until">days-until<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>days<span class="dash">-</span>until: <span class="tp sp">(</span><span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">,</span> <span class="tp tpp">d1</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">d2</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a>, <a class="pp">d1<span class="pc">d1: <span class="tp">date</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a>, <a class="pp">d2<span class="pc">d2: <span class="tp">date</span></span></a> <span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">days1<span class="pc">days1: <span class="tp">int</span></span></a> <span class="kw">=</span> (<a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a><span class="kw op">.</span><a class="pp" href="#date_to_days">date-to-days<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">)</span></span></a>)(<a class="pp">d1<span class="pc">d1: <span class="tp">date</span></span></a>)
  <span class="kw">val</span> <a class="pp">days2<span class="pc">days2: <span class="tp">int</span></span></a> <span class="kw">=</span> (<a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a><span class="kw op">.</span><a class="pp" href="#date_to_days">date-to-days<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">)</span></span></a>)(<a class="pp">d2<span class="pc">d2: <span class="tp">date</span></span></a>)
  <a class="pp">days2<span class="pc">days2: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">days1<span class="pc">days1: <span class="tp">int</span></span></a>
  <span class="comment">/&#42;
  val i1 = instant(d1,cal=cal,ts=ts)
  val i2 = instant(d2,cal=cal,ts=ts)
  i2.days - i1.days
  &#42;/</span>
</span>}



<span class="comment">/&#42;----------------------------------------------------------------------------
  Earth calendars
  Abstracts over common patterns to relates dates and time instants to simpler
  relations between dates and days.
----------------------------------------------------------------------------&#42;/</span>


<span class="comment">// Create a calendar where we assume that each
// day has 24 hours with 60 minutes, and where minutes are 60 seconds
// (with possibly leap seconds). The function takes care of timezones,
// epoch shifts, and leap seconds, and only needs a calendar &#96;name&#96;,
// a function &#96;days-to-date&#96; to calculate a date given a number of days since the &#96;epoch&#96;,
// a function &#96;date-to-days&#96; to calculate days since the &#96;epoch&#96; for a given date,
// and an optional time scale to be used (=&#96;ts-utc&#96;).\
// &#96;month-prefix&#96; (=&#96;""&#96;) is used when displaying numeric months and is set for
// the ISO week dates to &#96;"W"&#96; for example. The &#96;show-era&#96; function can be given
// to display the era of a date.
</span><span class="decl-fun" id="earth_calendar"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#earth_calendar">earth-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>earth<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>date</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">date<span class="dash">-</span>to<span class="dash">-</span>days</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month<span class="dash">-</span>prefix</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">show<span class="dash">-</span>era</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>(
              <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a>        <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
              <a class="pp">long-name<span class="pc">long<span class="dash">-</span>name: <span class="tp">string</span></span></a>   <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
              <a class="pp">days-to-date<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>  <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a>,
              <a class="pp">date-to-days<span class="pc">date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>  <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>,
              <a class="pp">month-prefix<span class="pc">month<span class="dash">-</span>prefix: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a>  <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">""</span>,
              <a class="pp">show-era<span class="pc">show<span class="dash">-</span>era: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span></span></a>      <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a><span class="tp sp">)</span><span class="tp kw op">-></span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="kw">fn</span>(<a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>){ <span class="st">""</span> }
              <span class="comment">// ts   : timescale = ts-ti
</span>            ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a>
{
  <span class="decl-fun" id="instant_to_dc"><span class="kw">fun</span> <a class="pp">instant-to-dc<span class="pc">instant<span class="dash">-</span>to<span class="dash">-</span>dc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">tzdelta</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">,</span> <span class="tp">clock</span><span class="tp sp">)</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a>, <a class="pp">tzdelta<span class="pc">tzdelta: <span class="tp">duration</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>) {
    <a class="pp" href="#earth_timestamp_to_dc">earth-timestamp-to-dc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>earth<span class="dash">-</span>timestamp<span class="dash">-</span>to<span class="dash">-</span>dc: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">tzdelta</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>date</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">,</span> <span class="tp">clock</span><span class="tp sp">)</span></span></a>( <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#timestamp">timestamp<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timestamp: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>, <a class="pp">tzdelta<span class="pc">tzdelta: <span class="tp">duration</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_duration-source.html#timespan">timespan<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>timespan: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>, <a class="pp">days-to-date<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a> )
  </span>}
  <span class="decl-fun" id="dc_to_instant"><span class="kw">fun</span> <a class="pp">dc-to-instant<span class="pc">dc<span class="dash">-</span>to<span class="dash">-</span>instant: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">clock</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">,</span> <span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>(<a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a>, <a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_clock"><span class="tp">clock</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>clock: <span class="tp">V</span></span></a>, <a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_timezone"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>timezone: <span class="tp">V</span></span></a>, <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a> ) {
    <a class="pp" href="#earth_timestamp_to_instant">earth-timestamp-to-instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>earth<span class="dash">-</span>timestamp<span class="dash">-</span>to<span class="dash">-</span>instant: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">,</span> <span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>( <a class="pp" href="#dc_timestamp">dc-timestamp<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>dc<span class="dash">-</span>timestamp: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">clock</span><span class="tp sp">,</span> <span class="tp tpp">date<span class="dash">-</span>to<span class="dash">-</span>days</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">has<span class="dash">-</span>leap<span class="dash">-</span>seconds</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">bool</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>(<a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>, <a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a>, <a class="pp">date-to-days<span class="pc">date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#has_leap_seconds">has-leap-seconds<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>has<span class="dash">-</span>leap<span class="dash">-</span>seconds: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>), <a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a>, <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a>)
  </span>}
  <a class="pp" href="#con_space_Calendar"><span class="co">Calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>Calendar: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">month<span class="dash">-</span>prefix</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">show<span class="dash">-</span>era</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">instant<span class="dash">-</span>to<span class="dash">-</span>dc</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">tzdelta</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">,</span> <span class="tp">clock</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">dc<span class="dash">-</span>to<span class="dash">-</span>instant</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">,</span> <span class="tp">clock</span><span class="tp sp">,</span> <span class="tp">timezone</span><span class="tp sp">,</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>date</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">date<span class="dash">-</span>to<span class="dash">-</span>days</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a>,<a class="pp">long-name<span class="pc">long<span class="dash">-</span>name: <span class="tp">string</span></span></a>,<a class="pp">month-prefix<span class="pc">month<span class="dash">-</span>prefix: <span class="tp">string</span></span></a>,<a class="pp">show-era<span class="pc">show<span class="dash">-</span>era: <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>,
            <a class="pp">instant-to-dc<span class="pc">instant<span class="dash">-</span>to<span class="dash">-</span>dc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">tzdelta</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">,</span> <span class="tp">clock</span><span class="tp sp">)</span></span></a>,<a class="pp">dc-to-instant<span class="pc">dc<span class="dash">-</span>to<span class="dash">-</span>instant: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">clock</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">,</span> <span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>,
            <a class="pp">days-to-date<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>, <a class="pp">date-to-days<span class="pc">date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> )
</span>}


<span class="decl-fun" id="earth_timestamp_to_dc"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#earth_timestamp_to_dc">earth-timestamp-to-dc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>earth<span class="dash">-</span>timestamp<span class="dash">-</span>to<span class="dash">-</span>dc: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">tzdelta</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>date</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">,</span> <span class="tp">clock</span><span class="tp sp">)</span></span></a>( <a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a>, <a class="pp">tzdelta<span class="pc">tzdelta: <span class="tp">timespan</span></span></a><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_timestamp-source.html#type_space_timespan"><span class="tp">timespan</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timespan: <span class="tp">V</span></span></a>, <a class="pp">days-to-date<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a><span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_clock"><span class="tp">clock</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>clock: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> {
  <span class="comment">// adjust for timezone (disregarding leap seconds for now) (and possibly going into the next or previous day)
</span>  <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a>,<a class="pp">clock<span class="pc">clock: <span class="tp">clock</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>     <span class="kw">=</span> (<a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_timestamp-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp">tzdelta<span class="pc">tzdelta: <span class="tp">timespan</span></span></a>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_timestamp-source.html#days_clock">days-clock<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>days<span class="dash">-</span>clock: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">clock</span><span class="tp sp">)</span></span></a>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">days-to-date<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>(<a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a>),<a class="pp">clock<span class="pc">clock: <span class="tp">clock</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
</span>}

<span class="decl-fun" id="earth_timestamp_to_instant"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#earth_timestamp_to_instant">earth-timestamp-to-instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>earth<span class="dash">-</span>timestamp<span class="dash">-</span>to<span class="dash">-</span>instant: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">,</span> <span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>( <a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a>, <a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_timezone"><span class="tp">timezone</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>timezone: <span class="tp">V</span></span></a>, <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a> {
  <span class="comment">// do timezone adjustment ignoring leap seconds (TODO: check correctness)
</span>  <span class="kw">val</span> <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>    <span class="kw">=</span> <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#instant">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>(<a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a>)
  <span class="kw">val</span> <a class="pp">iz<span class="pc">iz: <span class="tp">instant</span></span></a>   <span class="kw">=</span> <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a><span class="kw op">.</span><a class="pp" href="#is_tz_utc">is-tz-utc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>is<span class="dash">-</span>tz<span class="dash">-</span>utc: <span class="tp sp">(</span><span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a> <span class="kw">else</span> {
               <span class="kw">match</span>((<a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a><span class="kw op">.</span><a class="pp" href="#utc_inverse">utc-inverse<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>utc<span class="dash">-</span>inverse: <span class="tp sp">(</span><span class="tp tpp">timezone</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">instant</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>)(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>)) {
                 <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">inv<span class="pc">inv: <span class="tp">instant</span></span></a>) <span class="kw op">-></span> <a class="pp">inv<span class="pc">inv: <span class="tp">instant</span></span></a>
                 <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">-></span> {
                   <span class="comment">// no explicit inverse,
</span>                   <span class="comment">// do a double pass to accommodate jumping over a DST boundary.
</span>                   <span class="kw">val</span> <a class="pp">tzd1<span class="pc">tzd1: <span class="tp">duration</span></span></a> <span class="kw">=</span> (<a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a><span class="kw op">.</span><a class="pp" href="#utc_delta">utc-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>utc<span class="dash">-</span>delta: <span class="tp sp">(</span><span class="tp tpp">timezone</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span><span class="tp sp">)</span></span></a>)(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#fst">fst<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>fst: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>
                   <span class="kw">val</span> <a class="pp">tzi1<span class="pc">tzi1: <span class="tp">instant</span></span></a> <span class="kw">=</span> <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#instant">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>(<a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_timestamp-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp">tzd1<span class="pc">tzd1: <span class="tp">duration</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_duration-source.html#timespan">timespan<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>timespan: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>)
                   <span class="kw">val</span> <a class="pp">tzd2<span class="pc">tzd2: <span class="tp">duration</span></span></a> <span class="kw">=</span> (<a class="pp">tz<span class="pc">tz: <span class="tp">timezone</span></span></a><span class="kw op">.</span><a class="pp" href="#utc_delta">utc-delta<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>utc<span class="dash">-</span>delta: <span class="tp sp">(</span><span class="tp tpp">timezone</span> <span class="tp kw op">:</span> <span class="tp">timezone</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span><span class="tp sp">)</span></span></a>)(<a class="pp">tzi1<span class="pc">tzi1: <span class="tp">instant</span></span></a>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#fst">fst<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>fst: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>
                   <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">tzd1<span class="pc">tzd1: <span class="tp">duration</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_duration-source.html#_eq__eq_">==<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>(==): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">j</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><a class="pp">tzd2<span class="pc">tzd2: <span class="tp">duration</span></span></a>) <span class="kw">then</span> <a class="pp">tzi1<span class="pc">tzi1: <span class="tp">instant</span></span></a>
                    <span class="kw">else</span> <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#instant">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>(<a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_timestamp-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp">tzd2<span class="pc">tzd2: <span class="tp">duration</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_duration-source.html#timespan">timespan<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>timespan: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>)
                 }
               }
             }
  <a class="pp">iz<span class="pc">iz: <span class="tp">instant</span></span></a>
</span>}

<span class="decl-fun" id="cal_timestamp"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#cal_timestamp">cal-timestamp<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>cal<span class="dash">-</span>timestamp: <span class="tp sp">(</span><span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">,</span> <span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">clock</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>( <a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a>, <a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a>, <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a>, <a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_clock"><span class="tp">clock</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>clock: <span class="tp">V</span></span></a>  ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a> {
  <a class="pp" href="#dc_timestamp">dc-timestamp<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>dc<span class="dash">-</span>timestamp: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">clock</span><span class="tp sp">,</span> <span class="tp tpp">date<span class="dash">-</span>to<span class="dash">-</span>days</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">has<span class="dash">-</span>leap<span class="dash">-</span>seconds</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">bool</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>(<a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>,<a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a>,<a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a><span class="kw op">.</span><a class="pp" href="#date_to_days">date-to-days<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">)</span></span></a>,<a class="pp">ts<span class="pc">ts: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#has_leap_seconds">has-leap-seconds<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>has<span class="dash">-</span>leap<span class="dash">-</span>seconds: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>)
</span>}

<span class="decl-fun" id="dc_timestamp"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#dc_timestamp">dc-timestamp<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>dc<span class="dash">-</span>timestamp: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">clock</span><span class="tp sp">,</span> <span class="tp tpp">date<span class="dash">-</span>to<span class="dash">-</span>days</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">has<span class="dash">-</span>leap<span class="dash">-</span>seconds</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">bool</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>( <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a>, <a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_clock"><span class="tp">clock</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>clock: <span class="tp">V</span></span></a>, <a class="pp">date-to-days<span class="pc">date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">has-leap-seconds<span class="pc">has<span class="dash">-</span>leap<span class="dash">-</span>seconds: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">bool</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a> {
  <span class="comment">// check if we are in a leap second and remember
</span>  <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">xsecs<span class="pc">xsecs: <span class="tp">ddouble</span></span></a>,<a class="pp">leap<span class="pc">leap: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>  <span class="kw">=</span> <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#_excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(!): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><a class="pp">has-leap-seconds<span class="pc">has<span class="dash">-</span>leap<span class="dash">-</span>seconds: <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#seconds">seconds<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>seconds: <span class="tp sp">(</span><span class="tp tpp">clock</span> <span class="tp kw op">:</span> <span class="tp">clock</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#_lt_">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>(&lt;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">60</span><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#ddouble_1">ddouble<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>ddouble<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a>) <span class="kw">then</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#seconds">seconds<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>seconds: <span class="tp sp">(</span><span class="tp tpp">clock</span> <span class="tp kw op">:</span> <span class="tp">clock</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a>,<span class="number">0</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">else</span> {
                        <span class="kw">val</span> <a class="pp">leap<span class="pc">leap: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#seconds">seconds<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>seconds: <span class="tp sp">(</span><span class="tp tpp">clock</span> <span class="tp kw op">:</span> <span class="tp">clock</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#floor">floor<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>floor: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#int">int<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>int: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">,</span> <span class="tp tpp">nonfin</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">59</span>
                        <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#seconds">seconds<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>seconds: <span class="tp sp">(</span><span class="tp tpp">clock</span> <span class="tp kw op">:</span> <span class="tp">clock</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a> <a class="pp">leap<span class="pc">leap: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#ddouble_1">ddouble<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>ddouble<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a>, <a class="pp">leap<span class="pc">leap: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
                      }
  <span class="kw">val</span> <a class="pp">secs<span class="pc">secs: <span class="tp">ddouble</span></span></a> <span class="kw">=</span> (((<a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#hours">hours<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>hours: <span class="tp sp">(</span><span class="tp tpp">clock</span> <span class="tp kw op">:</span> <span class="tp">clock</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">60</span>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">c<span class="pc">c: <span class="tp">clock</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#minutes">minutes<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>minutes: <span class="tp sp">(</span><span class="tp tpp">clock</span> <span class="tp kw op">:</span> <span class="tp">clock</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>)<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">60</span>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#ddouble_1">ddouble<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>ddouble<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_ddouble-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a> <a class="pp">xsecs<span class="pc">xsecs: <span class="tp">ddouble</span></span></a>
  <span class="kw">val</span> <a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">date-to-days<span class="pc">date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> )
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_timestamp-source.html#timestamp_days">timestamp-days<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">secs</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">timespan</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">leap</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>(<a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a>,<a class="pp">secs<span class="pc">secs: <span class="tp">ddouble</span></span></a>,<a class="pp">leap<span class="pc">leap: <span class="tp">int</span></span></a>)
</span>}


<span class="comment">/&#42;----------------------------------------------------------------------------
  Combine earth calendars/ year-shift earth calendars
----------------------------------------------------------------------------&#42;/</span>

<span class="comment">// Create a new calendar from by combining two other calendars. The &#96;switch-date&#96;
// is in terms of the second calendar (&#96;cal2&#96;) and time after (and including) the switch
// date is displayed in &#96;cal2&#96; while times before it in &#96;cal1&#96;. This function is used
// for example for the Julian Gregorian calendar.
</span><span class="decl-fun" id="combine_earth_calendars"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#combine_earth_calendars">combine-earth-calendars<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>combine<span class="dash">-</span>earth<span class="dash">-</span>calendars: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">switch<span class="dash">-</span>date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">cal1</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">,</span> <span class="tp tpp">cal2</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">,</span> <span class="tp tpp">mb<span class="dash">-</span>show<span class="dash">-</span>era</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">long-name<span class="pc">long<span class="dash">-</span>name: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
                            <a class="pp">switch-date<span class="pc">switch<span class="dash">-</span>date: <span class="tp">date</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a>, <a class="pp">cal1<span class="pc">cal1: <span class="tp">calendar</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a>, <a class="pp">cal2<span class="pc">cal2: <span class="tp">calendar</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a>,
                            <a class="pp">mb-show-era<span class="pc">mb<span class="dash">-</span>show<span class="dash">-</span>era: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp sp">(</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
                          ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a>
{
  <span class="kw">val</span> <a class="pp">switch-days<span class="pc">switch<span class="dash">-</span>days: <span class="tp">int</span></span></a> <span class="kw">=</span> (<a class="pp">cal2<span class="pc">cal2: <span class="tp">calendar</span></span></a><span class="kw op">.</span><a class="pp" href="#date_to_days">date-to-days<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">)</span></span></a>)(<a class="pp">switch-date<span class="pc">switch<span class="dash">-</span>date: <span class="tp">date</span></span></a>) <span class="comment">//+ skip
</span>  <span class="decl-fun" id="cdays_to_date"><span class="kw">fun</span> <a class="pp">cdays-to-date<span class="pc">cdays<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>( <a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a> {
    ((<span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_lt__1">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">switch-days<span class="pc">switch<span class="dash">-</span>days: <span class="tp">int</span></span></a>) <span class="kw">then</span> <a class="pp">cal1<span class="pc">cal1: <span class="tp">calendar</span></span></a> <span class="kw">else</span> <a class="pp">cal2<span class="pc">cal2: <span class="tp">calendar</span></span></a>)<span class="kw op">.</span><a class="pp" href="#days_to_date">days-to-date<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>days<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span><span class="tp sp">)</span></span></a>)(<a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a>)
  </span>}
  <span class="decl-fun" id="cdate_to_days"><span class="kw">fun</span> <a class="pp">cdate-to-days<span class="pc">cdate<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
    ((<span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#_lt_">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>(&lt;): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">j</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">switch-date<span class="pc">switch<span class="dash">-</span>date: <span class="tp">date</span></span></a>) <span class="kw">then</span> <a class="pp">cal1<span class="pc">cal1: <span class="tp">calendar</span></span></a> <span class="kw">else</span> <a class="pp">cal2<span class="pc">cal2: <span class="tp">calendar</span></span></a>)<span class="kw op">.</span><a class="pp" href="#date_to_days">date-to-days<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">)</span></span></a>)(<a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>)
  </span>}
  <span class="decl-fun" id="cshow_era"><span class="kw">fun</span> <a class="pp">cshow-era<span class="pc">cshow<span class="dash">-</span>era: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
    <span class="kw">match</span>(<a class="pp">mb-show-era<span class="pc">mb<span class="dash">-</span>show<span class="dash">-</span>era: <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span></span></a>) {
      <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">showera<span class="pc">showera: <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>) <span class="kw op">-></span> <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a><span class="kw op">.</span><a class="pp">showera<span class="pc">showera: <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>
      <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">-></span> ((<span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#_lt_">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>(&lt;): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">j</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">switch-date<span class="pc">switch<span class="dash">-</span>date: <span class="tp">date</span></span></a>) <span class="kw">then</span> <a class="pp">cal1<span class="pc">cal1: <span class="tp">calendar</span></span></a> <span class="kw">else</span> <a class="pp">cal2<span class="pc">cal2: <span class="tp">calendar</span></span></a>)<span class="kw op">.</span><a class="pp" href="#show_era">show-era<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>show<span class="dash">-</span>era: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">)</span></span></a>)(<a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>)
    }
  </span>}
  <a class="pp" href="#earth_calendar">earth-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>earth<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>date</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">date<span class="dash">-</span>to<span class="dash">-</span>days</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month<span class="dash">-</span>prefix</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">show<span class="dash">-</span>era</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a>, <a class="pp">long-name<span class="pc">long<span class="dash">-</span>name: <span class="tp">string</span></span></a>, <a class="pp">cdays-to-date<span class="pc">cdays<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>, <a class="pp">cdate-to-days<span class="pc">cdate<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, show<span class="dash">-</span>era <span class="kw">=</span> <a class="pp">cshow-era<span class="pc">cshow<span class="dash">-</span>era: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> )
</span>}

<span class="comment">// Create a new calendar from anoter calendar &#96;cal&#96; by adding an offset to the
// years (&#96;year-shift&#96;). This is used for example to create the Ethiopian calendar
// from the Coptic calendar, by using:
// &#96;year-shift-earth-calendar( "EC", "Ethiopian", ~276, cal-coptic )&#96;
</span><span class="decl-fun" id="year_shift_earth_calendar"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#year_shift_earth_calendar">year-shift-earth-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>year<span class="dash">-</span>shift<span class="dash">-</span>earth<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">year<span class="dash">-</span>shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">,</span> <span class="tp tpp">month<span class="dash">-</span>prefix</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">show<span class="dash">-</span>era</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">long-name<span class="pc">long<span class="dash">-</span>name: <span class="tp">string</span></span></a><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
                                <a class="pp">year-shift<span class="pc">year<span class="dash">-</span>shift: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a>,
                                <a class="pp">month-prefix<span class="pc">month<span class="dash">-</span>prefix: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a>  <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">""</span>,
                                <a class="pp">show-era<span class="pc">show<span class="dash">-</span>era: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span></span></a>      <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a><span class="tp sp">)</span><span class="tp kw op">-></span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="kw">fn</span>(<a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>){ <span class="st">""</span> }
                             ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a>
{
  <span class="decl-fun" id="shift_days_to_date"><span class="kw">fun</span> <a class="pp">shift-days-to-date<span class="pc">shift<span class="dash">-</span>days<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>( <a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a> {
    <span class="kw">val</span> <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> <span class="kw">=</span> (<a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a><span class="kw op">.</span><a class="pp" href="#days_to_date">days-to-date<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>days<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span><span class="tp sp">)</span></span></a>)(<a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a>)
    <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>(year <span class="kw">=</span> <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#year">year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>year: <span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">year-shift<span class="pc">year<span class="dash">-</span>shift: <span class="tp">int</span></span></a>)
  </span>}
  <span class="decl-fun" id="shift_date_to_days"><span class="kw">fun</span> <a class="pp">shift-date-to-days<span class="pc">shift<span class="dash">-</span>date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
    (<a class="pp">cal<span class="pc">cal: <span class="tp">calendar</span></span></a><span class="kw op">.</span><a class="pp" href="#date_to_days">date-to-days<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">calendar</span> <span class="tp kw op">:</span> <span class="tp">calendar</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">)</span></span></a>)( <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>(year <span class="kw">=</span> <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#year">year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>year: <span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">year-shift<span class="pc">year<span class="dash">-</span>shift: <span class="tp">int</span></span></a>) )
  </span>}
  <a class="pp" href="#earth_calendar">earth-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>earth<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>date</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">date<span class="dash">-</span>to<span class="dash">-</span>days</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month<span class="dash">-</span>prefix</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">show<span class="dash">-</span>era</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>(
    <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a>, <a class="pp">long-name<span class="pc">long<span class="dash">-</span>name: <span class="tp">string</span></span></a>,
    <a class="pp">shift-days-to-date<span class="pc">shift<span class="dash">-</span>days<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>, <a class="pp">shift-date-to-days<span class="pc">shift<span class="dash">-</span>date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,
    <a class="pp">month-prefix<span class="pc">month<span class="dash">-</span>prefix: <span class="tp">string</span></span></a>, <a class="pp">show-era<span class="pc">show<span class="dash">-</span>era: <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>
  )
</span>}


<span class="comment">/&#42;----------------------------------------------------------------------------
  Generic solar calendars:
  Abstract over almost all calendars that work in terms of months and solar years.
----------------------------------------------------------------------------&#42;/</span>

<span class="comment">// An abstraction over solar calendars. Almost all calendars can be defined
// in terms of this function (and &#96;solar-ecalendar&#96;). Given functions to
// convert days to and from a year, and day-of-the-year to and from month
// and month day, this constructs a full calendar.\
// Also needs an &#96;epoch-shift&#96; that gives the number of days from the
// calendar epoch to the date &#96;&#96;2000-01-01&#96;&#96;. By default this is &#96;730119&#96;
// which corresponds to a &#96;&#96;0001-01-01&#96;&#96; ISO calendar epoch. The
// &#96;has-year-zero&#96; (=&#96;True&#96;) parameter is used when the calendar has a
// year zero. The &#96;month-prefix&#96; (=&#96;""&#96;) is used for displaying numeric
// months (and is &#96;"W"&#96; for &#96;cal-iso-week&#96; for example). The &#96;show-era&#96; function
// can be given to display an era for a given date. Finally the &#96;ts&#96; (=&#96;ts-ti&#96;)
// gives the time scale for the calendar.
</span><span class="decl-fun" id="solar_calendar"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#solar_calendar">solar-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>solar<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>before<span class="dash">-</span>year</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>yeardoy</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>before<span class="dash">-</span>month</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>month</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">doy</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">epoch<span class="dash">-</span>shift</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">has<span class="dash">-</span>year<span class="dash">-</span>zero</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">bool</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">month<span class="dash">-</span>prefix</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">show<span class="dash">-</span>era</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">long-name<span class="pc">long<span class="dash">-</span>name: <span class="tp">string</span></span></a><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
                    <a class="pp">days-before-year<span class="pc">days<span class="dash">-</span>before<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>,
                    <a class="pp">days-to-yeardoy<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>yeardoy: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a>  <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a>,
                    <a class="pp">days-before-month<span class="pc">days<span class="dash">-</span>before<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">,</span> <span class="tp tpp">month</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>,
                    <a class="pp">days-to-month<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">doy</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>    <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">,</span> <span class="tp tpp">doy</span><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> <span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>,
                    <a class="pp">epoch-shift<span class="pc">epoch<span class="dash">-</span>shift: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>   <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">730119</span>,
                    <a class="pp">has-year-zero<span class="pc">has<span class="dash">-</span>year<span class="dash">-</span>zero: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">bool</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>,
                    <a class="pp">month-prefix<span class="pc">month<span class="dash">-</span>prefix: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a>  <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">""</span>,
                    <a class="pp">show-era<span class="pc">show<span class="dash">-</span>era: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span></span></a>      <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a><span class="tp sp">)</span><span class="tp kw op">-></span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="kw">fn</span>(<a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>){ <span class="st">""</span> } ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a>
{
  <span class="decl-fun" id="date_to_days"><span class="kw">fun</span> <a class="pp">date-to-days<span class="pc">date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
    <span class="kw">val</span> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> <span class="kw">=</span> <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">has-year-zero<span class="pc">has<span class="dash">-</span>year<span class="dash">-</span>zero: <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#year">year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>year: <span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#is_pos_2">is-pos<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>pos<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#year">year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>year: <span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="kw">else</span> <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#year">year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>year: <span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#inc">inc<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>inc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
    <a class="pp">days-before-year<span class="pc">days<span class="dash">-</span>before<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> ) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">days-before-month<span class="pc">days<span class="dash">-</span>before<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>, <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#month">month<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>month: <span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> )
     <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#day">day<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>day: <span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#dec">dec<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>dec: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">epoch-shift<span class="pc">epoch<span class="dash">-</span>shift: <span class="tp">int</span></span></a>
  </span>}

  <span class="decl-fun" id="days_to_date"><span class="kw">fun</span> <a class="pp">days-to-date<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp tpp">days0</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>( <a class="pp">days0<span class="pc">days0: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a> {
    <span class="kw">val</span> <a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a>    <span class="kw">=</span> <a class="pp">days0<span class="pc">days0: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">epoch-shift<span class="pc">epoch<span class="dash">-</span>shift: <span class="tp">int</span></span></a>
    <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>,<a class="pp">doy<span class="pc">doy: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span> <a class="pp">days-to-yeardoy<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>yeardoy: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a>( <a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a> )
    <span class="kw">val</span> <a class="pp">month<span class="pc">month: <span class="tp">int</span></span></a>   <span class="kw">=</span> <a class="pp">days-to-month<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">doy</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>, <a class="pp">doy<span class="pc">doy: <span class="tp">int</span></span></a>)
    <span class="kw">val</span> <a class="pp">day<span class="pc">day: <span class="tp">int</span></span></a>     <span class="kw">=</span> (<a class="pp">doy<span class="pc">doy: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">days-before-month<span class="pc">days<span class="dash">-</span>before<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>, <a class="pp">month<span class="pc">month: <span class="tp">int</span></span></a>)) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span>
    <span class="kw">val</span> <a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a>    <span class="kw">=</span> <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">has-year-zero<span class="pc">has<span class="dash">-</span>year<span class="dash">-</span>zero: <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#is_pos_2">is-pos<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>pos<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> <span class="kw">else</span> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#dec">dec<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>dec: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#con_space_Date"><span class="co">Date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>Date: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">day</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>(<a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a>,<a class="pp">month<span class="pc">month: <span class="tp">int</span></span></a>,<a class="pp">day<span class="pc">day: <span class="tp">int</span></span></a>)
  </span>}

  <a class="pp" href="#earth_calendar">earth-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>earth<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>date</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span><span class="tp sp">,</span> <span class="tp tpp">date<span class="dash">-</span>to<span class="dash">-</span>days</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month<span class="dash">-</span>prefix</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">show<span class="dash">-</span>era</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>(
    <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a>, <a class="pp">long-name<span class="pc">long<span class="dash">-</span>name: <span class="tp">string</span></span></a>,
    <a class="pp">days-to-date<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>date: <span class="tp sp">(</span><span class="tp tpp">days0</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">date</span></span></a>, <a class="pp">date-to-days<span class="pc">date<span class="dash">-</span>to<span class="dash">-</span>days: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,
    <a class="pp">month-prefix<span class="pc">month<span class="dash">-</span>prefix: <span class="tp">string</span></span></a>, <a class="pp">show-era<span class="pc">show<span class="dash">-</span>era: <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>
  )
</span>}

<span class="comment">// An abstraction over solar calendars. Almost all calendars can be defined
// in terms of this function (and &#96;solar-calendar&#96;). Given functions to
// convert days to and from a year, and day-of-the-year to and from month
// and month day, this constructs a full calendar. In contrast to &#96;solar-calendar&#96;
// this function just needs an estimation function from days to a year -- for most
// calendars this is much more convenient. The estimation function returns a
// conservative (i.e. lowest) estimate for the year and a &#96;maybe&lt;int&gt;&#96; that
// is the &#96;safe-day&#96;: if the day of the year is lower or equal to that the estimate
// is surely correct. Otherwise the wrapper will calculate the start day for the next
// year until the correct year is found.\
// Also needs an &#96;epoch-shift&#96; that gives the number of days from the
// calendar epoch to the date &#96;&#96;2000-01-01&#96;&#96;. By default this is &#96;730119&#96;
// which corresponds to a &#96;&#96;0001-01-01&#96;&#96; ISO calendar epoch. The
// &#96;has-year-zero&#96; (=&#96;True&#96;) parameter is used when the calendar has a
// year zero. The &#96;month-prefix&#96; (=&#96;""&#96;) is used for displaying numeric
// months (and is &#96;"W"&#96; for &#96;cal-iso-week&#96; for example). The &#96;show-era&#96; function
// can be given to display an era for a given date. Finally the &#96;ts&#96; (=&#96;ts-utc&#96;)
// gives the time scale for the calendar.
</span><span class="decl-fun" id="solar_ecalendar"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#solar_ecalendar">solar-ecalendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>solar<span class="dash">-</span>ecalendar: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>before<span class="dash">-</span>year</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">estimate<span class="dash">-</span>year</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>before<span class="dash">-</span>month</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>month</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">doy</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">epoch<span class="dash">-</span>shift</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">has<span class="dash">-</span>year<span class="dash">-</span>zero</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">bool</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">month<span class="dash">-</span>prefix</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">show<span class="dash">-</span>era</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>(  <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">long-name<span class="pc">long<span class="dash">-</span>name: <span class="tp">string</span></span></a><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
                      <a class="pp">days-before-year<span class="pc">days<span class="dash">-</span>before<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>,
                      <a class="pp">estimate-year<span class="pc">estimate<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>    <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a>,
                      <a class="pp">days-before-month<span class="pc">days<span class="dash">-</span>before<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">,</span> <span class="tp tpp">month</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>,
                      <a class="pp">days-to-month<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">doy</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>    <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">,</span> <span class="tp tpp">doy</span><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> <span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>,
                      <a class="pp">epoch-shift<span class="pc">epoch<span class="dash">-</span>shift: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>   <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">730119</span>,
                      <a class="pp">has-year-zero<span class="pc">has<span class="dash">-</span>year<span class="dash">-</span>zero: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">bool</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>,
                      <a class="pp">month-prefix<span class="pc">month<span class="dash">-</span>prefix: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a>  <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">""</span>,
                      <a class="pp">show-era<span class="pc">show<span class="dash">-</span>era: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span></span></a>      <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a><span class="tp sp">)</span><span class="tp kw op">-></span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="kw">fn</span>(<a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a>){ <span class="st">""</span> } )  <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a>
{
  <span class="decl-fun" id="days_to_yeardoy"><span class="kw">fun</span> <a class="pp">days-to-yeardoy<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>yeardoy: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a>(<a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> {
    <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">approx<span class="pc">approx: <span class="tp">int</span></span></a>,<a class="pp">safe<span class="pc">safe: <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span> <a class="pp">estimate-year<span class="pc">estimate<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>(<a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a>)
    <span class="kw">val</span> <a class="pp">doy1<span class="pc">doy1: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">days-before-year<span class="pc">days<span class="dash">-</span>before<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">approx<span class="pc">approx: <span class="tp">int</span></span></a>)
    <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">doy1<span class="pc">doy1: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">safe<span class="pc">safe: <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#default">default<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>default: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<span class="number">0</span>)) <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">approx<span class="pc">approx: <span class="tp">int</span></span></a>,<a class="pp">doy1<span class="pc">doy1: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
    <span class="kw">val</span> <a class="pp">doy2<span class="pc">doy2: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">days-before-year<span class="pc">days<span class="dash">-</span>before<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">approx<span class="pc">approx: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#inc">inc<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>inc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>)
    <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">doy2<span class="pc">doy2: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_lt__1">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">0</span>) <span class="kw">then</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">approx<span class="pc">approx: <span class="tp">int</span></span></a>,<a class="pp">doy1<span class="pc">doy1: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">approx<span class="pc">approx: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#inc">inc<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>inc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">doy2<span class="pc">doy2: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
  </span>}

  <a class="pp" href="#solar_calendar">solar-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>solar<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>before<span class="dash">-</span>year</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>yeardoy</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>before<span class="dash">-</span>month</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>month</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">doy</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">epoch<span class="dash">-</span>shift</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">has<span class="dash">-</span>year<span class="dash">-</span>zero</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">bool</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">month<span class="dash">-</span>prefix</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">show<span class="dash">-</span>era</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>(<a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a>,<a class="pp">long-name<span class="pc">long<span class="dash">-</span>name: <span class="tp">string</span></span></a>,
    <a class="pp">days-before-year<span class="pc">days<span class="dash">-</span>before<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">days-to-yeardoy<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>yeardoy: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a>,
    <a class="pp">days-before-month<span class="pc">days<span class="dash">-</span>before<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">days-to-month<span class="pc">days<span class="dash">-</span>to<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">doy</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,
    <a class="pp">epoch-shift<span class="pc">epoch<span class="dash">-</span>shift: <span class="tp">int</span></span></a>, <a class="pp">has-year-zero<span class="pc">has<span class="dash">-</span>year<span class="dash">-</span>zero: <span class="tp">bool</span></span></a>, <a class="pp">month-prefix<span class="pc">month<span class="dash">-</span>prefix: <span class="tp">string</span></span></a>, <a class="pp">show-era<span class="pc">show<span class="dash">-</span>era: <span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>
  )
</span>}


<span class="comment">// ----------------------------------------------------
// ISO calendar:
// We define it here (instead of std/time/calendars) because it is the default calendar.
// ----------------------------------------------------
</span>

<span class="comment">// Create a standard ISO calendar using a particular time scale
// and calendar &#96;name&#96; (=&#96;ts.name&#96;).
</span><span class="decl-fun" id="iso_calendar"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#iso_calendar">iso-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tv">&#95;ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp">&#95;ts<span class="pc">&#95;ts: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a>, <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">long-name<span class="pc">long<span class="dash">-</span>name: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a> {
  <a class="pp" href="#solar_ecalendar">solar-ecalendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>solar<span class="dash">-</span>ecalendar: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>before<span class="dash">-</span>year</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">estimate<span class="dash">-</span>year</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>before<span class="dash">-</span>month</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>month</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">doy</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">epoch<span class="dash">-</span>shift</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">has<span class="dash">-</span>year<span class="dash">-</span>zero</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">bool</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">month<span class="dash">-</span>prefix</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">show<span class="dash">-</span>era</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>(
    <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a>, <a class="pp">long-name<span class="pc">long<span class="dash">-</span>name: <span class="tp">string</span></span></a>,
    <a class="pp" href="#iso_days_before_year">iso-days-before-year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>days<span class="dash">-</span>before<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp" href="#iso_estimate_year">iso-estimate-year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>estimate<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>,
    <a class="pp" href="#iso_days_before_month">iso-days-before-month<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>days<span class="dash">-</span>before<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp" href="#iso_doy_to_month">iso-doy-to-month<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>doy<span class="dash">-</span>to<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">doy</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
  )
</span>}

<span class="comment">// The standard [ISO 8601](https://en.wikipedia.org/wiki/ISO&#95;8601) calendar
// using TI time (&#96;ts-ti&#96;). This is a proleptic Gregorian
// calendar except that it uses the year 0 for 1 BCE, -1 for 2 BCE etc.
//
// This is the default calendar used in the library as it guarantees deterministic
// date calculations while still taking historical leap seconds into account.
</span><span class="decl-val" id="cal_iso"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#cal_iso">cal-iso<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>cal<span class="dash">-</span>iso: <span class="tp">calendar</span></span></a> <span class="kw">=</span> <a class="pp" href="#iso_calendar">iso-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tv">&#95;ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_utc-source.html#ts_ti">ts-ti<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>ts<span class="dash">-</span>ti: <span class="tp">timescale</span></span></a>, <span class="st">""</span>, <span class="st">"ISO"</span> </span>)

<span class="comment">// Create a standard [ISO 8601](https://en.wikipedia.org/wiki/ISO&#95;8601) calendar
// using UTC time (&#96;ts-utc-create&#96;) given a provide leap second table (&#96;:leaps-table&#96;).
// This is a proleptic Gregorian
// calendar except that it uses the year 0 for 1 BCE, -1 for 2 BCE etc.
//
// You can create an ISO 8601 UTC calendar using the latest IETF leap
// second data using [&#96;cal-utc-load&#96;](std&#95;time&#95;download.html#cal&#95;utc&#95;load).
</span><span class="decl-fun" id="cal_utc_create"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#cal_utc_create">cal-utc-create<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>cal<span class="dash">-</span>utc<span class="dash">-</span>create: <span class="tp sp">(</span><span class="tp tpp">leaps</span> <span class="tp kw op">:</span> <span class="tp">leaps<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp">leaps<span class="pc">leaps: <span class="tp">leaps<span class="dash">-</span>table</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_utc-source.html#type_space_leaps_table"><span class="tp">leaps-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>leaps<span class="dash">-</span>table: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">ts-utc<span class="pc">ts<span class="dash">-</span>utc: <span class="tp">timescale</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_utc-source.html#ts_utc_create">ts-utc-create<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>ts<span class="dash">-</span>utc<span class="dash">-</span>create: <span class="tp sp">(</span><span class="tp tpp">leaps</span> <span class="tp kw op">:</span> <span class="tp">leaps<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>(<a class="pp">leaps<span class="pc">leaps: <span class="tp">leaps<span class="dash">-</span>table</span></span></a>)
  <a class="pp" href="#iso_calendar">iso-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tv">&#95;ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp">ts-utc<span class="pc">ts<span class="dash">-</span>utc: <span class="tp">timescale</span></span></a>, <span class="st">""</span>, <span class="st">"ISO"</span> )
</span>}


<span class="comment">/&#42; The standard [ISO 8601](https://en.wikipedia.org/wiki/ISO&#95;8601) calendar
but using TI-SLS time (&#96;ts-ti-sls&#96;), i.e. TI with
[smoothed leap seconds](https://www.cl.cam.ac.uk/~mgk25/time/utc-sls/).

This calendar is equivalent to the ISO calendar except for the last 1000 seconds of a day where
a leap second occurs. On such day, the leap second time step (positive or negative)
is distributed over the last 1000 seconds of the day. On the full hour, ISO and ISO-SLS are equal again.

This is a recommended calendar to use for
time stamps or communication with other services since it avoids any potential trouble
with leap seconds while still being quite precise.

Other good properties include:

- All days have 86400 seconds, and the time 23:59:60 never appears
- The time never differs more than one second from UTC
- Time as always equal to UTC on the full and half hour
&#42;/</span>
<span class="decl-val" id="cal_iso_sls"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#cal_iso_sls">cal-iso-sls<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>cal<span class="dash">-</span>iso<span class="dash">-</span>sls: <span class="tp">calendar</span></span></a> <span class="kw">=</span> <a class="pp" href="#iso_calendar">iso-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tv">&#95;ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_utc-source.html#ts_ti_sls">ts-ti-sls<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>ts<span class="dash">-</span>ti<span class="dash">-</span>sls: <span class="tp">timescale</span></span></a>, <span class="st">"SLS"</span>, <span class="st">"ISO-SLS"</span> </span>)

<span class="comment">// Create a new ISO 8601 calendar based on UTC-SLS time, i.e. UTC with smoothed leap
// seconds.
</span><span class="decl-fun" id="cal_utc_sls_create"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#cal_utc_sls_create">cal-utc-sls-create<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>cal<span class="dash">-</span>utc<span class="dash">-</span>sls<span class="dash">-</span>create: <span class="tp sp">(</span><span class="tp tpp">leaps</span> <span class="tp kw op">:</span> <span class="tp">leaps<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp">leaps<span class="pc">leaps: <span class="tp">leaps<span class="dash">-</span>table</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_utc-source.html#type_space_leaps_table"><span class="tp">leaps-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>leaps<span class="dash">-</span>table: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_calendar"><span class="tp">calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>calendar: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">ts-utc-sls<span class="pc">ts<span class="dash">-</span>utc<span class="dash">-</span>sls: <span class="tp">timescale</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_utc-source.html#ts_utc_sls_create">ts-utc-sls-create<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>ts<span class="dash">-</span>utc<span class="dash">-</span>sls<span class="dash">-</span>create: <span class="tp sp">(</span><span class="tp tpp">leaps</span> <span class="tp kw op">:</span> <span class="tp">leaps<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>(<a class="pp">leaps<span class="pc">leaps: <span class="tp">leaps<span class="dash">-</span>table</span></span></a>)
  <a class="pp" href="#iso_calendar">iso-calendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>calendar: <span class="tp sp">(</span><span class="tp tv">&#95;ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>( <a class="pp">ts-utc-sls<span class="pc">ts<span class="dash">-</span>utc<span class="dash">-</span>sls: <span class="tp">timescale</span></span></a>, <span class="st">"SLS"</span>, <span class="st">"ISO-SLS"</span> )
</span>}


<span class="comment">// The (proleptic) [Gregorian calendar](https://en.wikipedia.org/wiki/Gregorian&#95;calendar).
// Just like the ISO calendar except that the year 0 does not exist, i.e. after 1 BCE (=&#96;~1&#96;)
// we have 1 CE (=&#96;1&#96;).
// The calendar short name is &#96;&#96;GC&#96;&#96;.
</span><span class="decl-val" id="cal_gregorian"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#cal_gregorian">cal-gregorian<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>cal<span class="dash">-</span>gregorian: <span class="tp">calendar</span></span></a> <span class="kw">=</span> <a class="pp" href="#solar_ecalendar">solar-ecalendar<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>solar<span class="dash">-</span>ecalendar: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">long<span class="dash">-</span>name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>before<span class="dash">-</span>year</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">estimate<span class="dash">-</span>year</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>before<span class="dash">-</span>month</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">days<span class="dash">-</span>to<span class="dash">-</span>month</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">doy</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">epoch<span class="dash">-</span>shift</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">has<span class="dash">-</span>year<span class="dash">-</span>zero</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">bool</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">month<span class="dash">-</span>prefix</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">show<span class="dash">-</span>era</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">calendar</span></span></a>(
  <span class="st">"GC"</span>, <span class="st">"Gregorian"</span>,
  <a class="pp" href="#iso_days_before_year">iso-days-before-year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>days<span class="dash">-</span>before<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp" href="#iso_estimate_year">iso-estimate-year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>estimate<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>,
  <a class="pp" href="#iso_days_before_month">iso-days-before-month<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>days<span class="dash">-</span>before<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp" href="#iso_doy_to_month">iso-doy-to-month<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>doy<span class="dash">-</span>to<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">doy</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,
  has<span class="dash">-</span>year<span class="dash">-</span>zero <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>,
  show<span class="dash">-</span>era <span class="kw">=</span> <span class="kw">fn</span>(<a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#type_space_date"><span class="tp">date</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>date: <span class="tp">V</span></span></a>){ <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">d<span class="pc">d: <span class="tp">date</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_date-source.html#year">year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>date<span class="fslash last">/</span></span>year: <span class="tp sp">(</span><span class="tp tpp">date</span> <span class="tp kw op">:</span> <span class="tp">date</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#is_neg_2">is-neg<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>neg<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <span class="st">"BCE"</span> <span class="kw">else</span> <span class="st">"CE"</span> }
</span>)

<span class="decl-fun" id="iso_days_before_month"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#iso_days_before_month">iso-days-before-month<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>days<span class="dash">-</span>before<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">month</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">month<span class="pc">month: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">adj<span class="pc">adj: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="#iso_adjust">iso-adjust<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>adjust: <span class="tp sp">(</span><span class="tp tpp">is<span class="dash">-</span>before<span class="dash">-</span>march</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">month<span class="pc">month: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><span class="number">2</span>, <a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a> )
  (<span class="number">367</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">month<span class="pc">month: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">362</span>)<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">12</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">adj<span class="pc">adj: <span class="tp">int</span></span></a>
</span>}

<span class="decl-fun" id="iso_doy_to_month"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#iso_doy_to_month">iso-doy-to-month<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>doy<span class="dash">-</span>to<span class="dash">-</span>month: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">doy</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">doy<span class="pc">doy: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">adj<span class="pc">adj: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="#iso_adjust">iso-adjust<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>adjust: <span class="tp sp">(</span><span class="tp tpp">is<span class="dash">-</span>before<span class="dash">-</span>march</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">doy<span class="pc">doy: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><span class="number">58</span>,  <a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a>)
  (<span class="number">12</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">doy<span class="pc">doy: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">adj<span class="pc">adj: <span class="tp">int</span></span></a>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">373</span>)<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">367</span>
</span>}

<span class="decl-fun" id="iso_adjust"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#iso_adjust">iso-adjust<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>adjust: <span class="tp sp">(</span><span class="tp tpp">is<span class="dash">-</span>before<span class="dash">-</span>march</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">is-before-march<span class="pc">is<span class="dash">-</span>before<span class="dash">-</span>march: <span class="tp">bool</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a>, <a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">is-before-march<span class="pc">is<span class="dash">-</span>before<span class="dash">-</span>march: <span class="tp">bool</span></span></a>) <span class="kw">then</span> <span class="number">0</span> <span class="kw">elif</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp" href="#iso_is_leap">iso-is-leap<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>is<span class="dash">-</span>leap: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>(<a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a>)) <span class="kw">then</span> <span class="number">1</span> <span class="kw">else</span> <span class="number">2</span>
</span>}

<span class="decl-fun" id="iso_is_leap"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#iso_is_leap">iso-is-leap<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>is<span class="dash">-</span>leap: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>( <a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) {
  (<a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">4</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">0</span>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#_amp__amp_">&amp;&amp;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&amp;&amp;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> (<a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">100</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_excl__eq__1">!=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(!=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">0</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">400</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">0</span>)
</span>}

<span class="decl-fun" id="iso_days_before_year"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#iso_days_before_year">iso-days-before-year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>days<span class="dash">-</span>before<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) {
  <span class="kw">val</span> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">year<span class="pc">year: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#dec">dec<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>dec: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
  <span class="kw">val</span> <a class="pp">leapdays<span class="pc">leapdays: <span class="tp">int</span></span></a> <span class="kw">=</span> (<a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">4</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">100</span>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">400</span>
  <span class="number">365</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">leapdays<span class="pc">leapdays: <span class="tp">int</span></span></a>
</span>}

<span class="decl-fun" id="iso_estimate_year"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_time_calendar.html#iso_estimate_year">iso-estimate-year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar<span class="fslash last">/</span></span>iso<span class="dash">-</span>estimate<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>( <a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">era<span class="pc">era: <span class="tp">int</span></span></a>,<a class="pp">yoe<span class="pc">yoe: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#divmod">divmod<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>divmod: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a>(<a class="pp">days<span class="pc">days: <span class="tp">int</span></span></a>,<span class="number">146097</span>)
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><span class="number">1</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">400</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">era<span class="pc">era: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> (<span class="number">100</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">yoe<span class="pc">yoe: <span class="tp">int</span></span></a>)<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">36525</span>, <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<span class="number">363</span>)<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
</span>}
</pre>

</body>
</html>
